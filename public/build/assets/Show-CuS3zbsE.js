import{G as _e,f as be,x as m,T as E,y as we,l as he,r as c,o as n,c as ke,w as r,g as e,t as a,d,e as j,u as x,a as o,F as M,h,B as Ce,b as u,N as De}from"./app-rjK1ng7o.js";import{d as A}from"./dayjs.min-CuH6jTGg.js";import{u as Ie,t as qe}from"./timezone-Pli5Y0gf.js";import{u as Se}from"./useBackButton-B9bUould.js";import{X as Re}from"./x-DY7ygrlY.js";const Ue={class:"space-y-6"},Ee={class:"bg-white rounded-lg shadow p-6"},Ae={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Fe={class:"font-semibold"},je={class:"font-semibold"},Me={class:"font-semibold"},Ne={class:"font-semibold"},Be={class:"font-semibold"},Oe={class:"font-semibold"},Ve={class:"font-semibold"},He={class:"font-semibold"},Le={class:"bg-white rounded-lg shadow p-6"},Te={class:"flex flex-wrap gap-4"},Pe=["onClick"],Ye=["href"],$e=["src"],ze={key:0,class:"text-center py-8 text-gray-500"},Qe={class:"bg-white rounded-lg shadow"},Ge={class:"overflow-x-auto"},Xe={class:"min-w-full divide-y divide-gray-200"},Je={class:"bg-white divide-y divide-gray-200"},Ke={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},We={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ze={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},et={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},tt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},st={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},at={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ot={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},rt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},it={key:0,class:"text-center py-8 text-gray-500"},lt={class:"bg-white rounded-lg shadow"},nt={class:"p-6 border-b border-gray-200"},dt={class:"flex justify-between items-center"},ct={class:"overflow-x-auto"},ut={class:"min-w-full divide-y divide-gray-200"},pt={class:"bg-white divide-y divide-gray-200"},mt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},xt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},gt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},yt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ft={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},vt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},_t={class:"px-6 py-4 whitespace-nowrap"},bt={class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800"},wt={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},ht={class:"flex space-x-2"},kt=["onClick"],Ct={key:0,class:"text-center py-8 text-gray-500"},Dt={class:"space-y-4"},It={key:0,class:"mt-4 max-h-64 overflow-y-auto"},qt=["src"],St={key:0},Rt={key:1},Ut={class:"space-y-3"},Bt={__name:"Show",props:{order:{type:Object,required:!0},orderedItems:{type:Object,required:!0},receiveDatesHistory:{type:Array,required:!0},images:{type:Object,required:!0}},setup(l){var O;A.extend(Ie),A.extend(qe),A.tz.setDefault("Asia/Manila");const g=_e(),N=be();Se(route("interco-receiving.index"));const f=l;m((O=f.order)==null?void 0:O.interco_status);const k=m(!1),de=()=>{k.value=!0};m(null);const ce=m(null);E({quantity_received:null,received_date:new Date().toISOString().slice(0,16),expiry_date:null,remarks:null});const v=E({image:null}),I=m(null),ue=i=>{const t=i.target.files[0];t&&(v.image=t,I.value=URL.createObjectURL(t))},pe=()=>{v.post(route("interco-receiving.attach-image",f.order.id),{onSuccess:()=>{g.add({severity:"success",summary:"Success",detail:"Image attached successfully.",life:3e3}),k.value=!1,v.reset(),I.value=null},onError:i=>{const t=Object.values(i)[0];g.add({severity:"error",summary:"Upload Error",detail:t||"Failed to attach image.",life:5e3})}})};m(!1),ce.value=f.orderedItems.length>0?f.orderedItems[0]:null,m(!1),m(!1);const _=m(!1),b=m(!1),q=m(null);we(b,i=>{i||(p.reset(),p.clearErrors(),_.value=!1,q.value=null)});const p=E({id:null,quantity_received:null,remarks:null});he(()=>{if(!q.value||!p.quantity_received)return 0;const i=q.value.store_order_item.quantity_commited||0;return(parseFloat(p.quantity_received)||0)-i});const me=i=>{const t=f.receiveDatesHistory,S=t.findIndex(R=>R.id===i),y=t[S];q.value=y,p.id=y.id,p.quantity_received=y.quantity_received,p.remarks=y.remarks,b.value=!0},xe=()=>{_.value=!0,p.post(route("interco-receiving.update-receiving-history"),{onSuccess:i=>{g.add({severity:"success",summary:"Success",detail:"Updated Successfully.",life:5e3}),_.value=!1,b.value=!1},onError:i=>{_.value=!1,g.add({severity:"error",summary:"Error",detail:i.message||"Failed to update receive details.",life:5e3})}})},B=E({id:null}),ge=()=>{N.require({message:"Are you sure you want to delete this image?",header:"Confirmation",icon:"pi pi-exclamation-triangle",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Remove",severity:"danger"},accept:()=>{B.post(route("destroy"),{onSuccess:()=>{g.add({severity:"success",summary:"Success",detail:"Image deleted successfully.",life:5e3}),_.value=!1},onError:i=>{_.value=!1,console.log(i),g.add({severity:"error",summary:"Error",detail:i.message||"Failed to delete image.",life:5e3})}})}})},ye=()=>{De.post(route("interco-receiving.confirm-receive",f.order.interco_number),{},{onSuccess:()=>{g.add({severity:"success",summary:"Success",detail:"Receive Confirmed.",life:3e3})},onError:i=>{g.add({severity:"error",summary:"Error",detail:i.message||"An error occurred.",life:5e3})}})},fe=()=>{N.require({message:"Are you sure you want to confirm all pending received items?",header:"Confirm Receiving",icon:"pi pi-exclamation-triangle",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Confirm",severity:"success"},accept:()=>{ye()}})};return(i,t)=>{const S=c("DialogTitle"),y=c("DialogDescription"),R=c("DialogHeader"),F=c("Label"),V=c("Input"),H=c("FormError"),L=c("InputContainer"),U=c("Button"),T=c("DialogFooter"),P=c("DialogContent"),Y=c("Dialog"),ve=c("Layout");return n(),ke(ve,{heading:"Interco Transfer Details"},{default:r(()=>{var $,z,Q,G,X,J,K,W,Z,ee,te,se,ae,oe,re,ie;return[e("div",Ue,[e("div",Ee,[t[13]||(t[13]=e("h1",{class:"text-xl font-bold mb-4"},"Interco Transfer Details",-1)),e("div",Ae,[e("div",null,[t[5]||(t[5]=e("label",{class:"text-xs text-gray-500"},"Sending Store:",-1)),e("p",Fe,a(l.order.from_store_name),1)]),e("div",null,[t[6]||(t[6]=e("label",{class:"text-xs text-gray-500"},"Receiving Store:",-1)),e("p",je,a(((z=($=l.order)==null?void 0:$.store_branch)==null?void 0:z.name)||"N/A"),1)]),e("div",null,[t[7]||(t[7]=e("label",{class:"text-xs text-gray-500"},"Interco Number:",-1)),e("p",Me,a((Q=l.order)==null?void 0:Q.interco_number),1)]),e("div",null,[t[8]||(t[8]=e("label",{class:"text-xs text-gray-500"},"Transfer Date:",-1)),e("p",Ne,a((G=l.order)==null?void 0:G.order_date),1)]),e("div",null,[t[9]||(t[9]=e("label",{class:"text-xs text-gray-500"},"Created By:",-1)),e("p",Be,a((J=(X=l.order)==null?void 0:X.encoder)==null?void 0:J.first_name)+" "+a((W=(K=l.order)==null?void 0:K.encoder)==null?void 0:W.last_name),1)]),e("div",null,[t[10]||(t[10]=e("label",{class:"text-xs text-gray-500"},"Status:",-1)),e("p",Oe,a((ee=(Z=l.order)==null?void 0:Z.interco_status)==null?void 0:ee.toUpperCase()),1)]),e("div",null,[t[11]||(t[11]=e("label",{class:"text-xs text-gray-500"},"Reason:",-1)),e("p",Ve,a(((te=l.order)==null?void 0:te.interco_reason)||"N/A"),1)]),e("div",null,[t[12]||(t[12]=e("label",{class:"text-xs text-gray-500"},"Remarks:",-1)),e("p",He,a(((se=l.order)==null?void 0:se.interco_remarks)||"N/A"),1)])])]),e("div",Le,[e("div",{class:"flex justify-between items-center mb-4"},[t[14]||(t[14]=e("h2",{class:"text-lg font-semibold"},"Image Attachments",-1)),e("button",{onClick:de,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors"}," Attach Image ")]),e("div",Te,[(n(!0),d(M,null,j(l.images,s=>(n(),d("div",{key:s.id,class:"relative"},[e("button",{onClick:w=>{x(B).id=s.id,ge()},class:"absolute -right-2 -top-2 text-white w-5 h-5 rounded-full bg-red-500 hover:bg-red-600"},[o(x(Re),{class:"w-5 h-5"})],8,Pe),e("a",{href:s.image_url,target:"_blank",rel:"noopener noreferrer"},[e("img",{src:s.image_url,class:"w-24 h-24 cursor-pointer hover:opacity-80 transition-opacity rounded-md object-cover"},null,8,$e)],8,Ye)]))),128))]),(ae=l.images)!=null&&ae.length?h("",!0):(n(),d("div",ze," No images attached. "))]),e("div",Qe,[t[16]||(t[16]=e("div",{class:"p-6 border-b border-gray-200"},[e("h2",{class:"text-lg font-semibold"},"Interco Items")],-1)),e("div",Ge,[e("table",Xe,[t[15]||(t[15]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Item Code"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Description"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"BaseUOM"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"UOM"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"SOH Stock"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Ordered"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Approved"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Commited"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Received")])],-1)),e("tbody",Je,[(n(!0),d(M,null,j(l.orderedItems,s=>{var w,C,D;return n(),d("tr",{key:s.id},[e("td",Ke,a((w=s.sap_masterfile)==null?void 0:w.ItemCode),1),e("td",We,a((C=s.sap_masterfile)==null?void 0:C.ItemDescription),1),e("td",Ze,a((D=s.sap_masterfile)==null?void 0:D.BaseUOM),1),e("td",et,a(s.uom),1),e("td",tt,a(s.soh_stock),1),e("td",st,a(s.quantity_ordered),1),e("td",at,a(s.quantity_approved),1),e("td",ot,a(s.quantity_commited),1),e("td",rt,a(s.quantity_received),1)])}),128))])]),(oe=l.orderedItems)!=null&&oe.length?h("",!0):(n(),d("div",it," No items found. "))])]),e("div",lt,[e("div",nt,[e("div",dt,[t[17]||(t[17]=e("h2",{class:"text-lg font-semibold"},"Receiving History",-1)),((re=l.order)==null?void 0:re.interco_status)!=="received"?(n(),d("button",{key:0,onClick:fe,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors"}," Confirm Receive ")):h("",!0)])]),e("div",ct,[e("table",ut,[t[18]||(t[18]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Id"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Item"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Item Code"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"UOM"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Quantity Received"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Received At"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",pt,[(n(!0),d(M,null,j(l.receiveDatesHistory,s=>{var w,C,D,le,ne;return n(),d("tr",{key:s.id},[e("td",mt,a(s.id),1),e("td",xt,a((C=(w=s.store_order_item)==null?void 0:w.sap_masterfile)==null?void 0:C.ItemDescription),1),e("td",gt,a((le=(D=s.store_order_item)==null?void 0:D.sap_masterfile)==null?void 0:le.ItemCode),1),e("td",yt,a((ne=s.store_order_item)==null?void 0:ne.uom),1),e("td",ft,a(s.quantity_received),1),e("td",vt,a(x(A)(s.received_date).tz("Asia/Manila").format("MMMM D, YYYY h:mm A")),1),e("td",_t,[e("span",bt,a(s.status),1)]),e("td",wt,[e("div",ht,[s.status==="pending"?(n(),d("button",{key:0,onClick:Et=>me(s.id),class:"text-yellow-600 hover:text-yellow-900"},[o(x(Ce),{class:"w-4 h-4"})],8,kt)):h("",!0)])])])}),128))])]),(ie=l.receiveDatesHistory)!=null&&ie.length?h("",!0):(n(),d("div",Ct," No receiving history found. "))])])]),o(Y,{open:k.value,"onUpdate:open":t[1]||(t[1]=s=>k.value=s)},{default:r(()=>[o(P,{class:"sm:max-w-[600px]"},{default:r(()=>[o(R,null,{default:r(()=>[o(S,null,{default:r(()=>t[19]||(t[19]=[u("Attach Image")])),_:1}),o(y,null,{default:r(()=>t[20]||(t[20]=[u(" Select an image file to upload for this order. ")])),_:1})]),_:1}),e("div",Dt,[o(L,null,{default:r(()=>[o(F,{class:"text-xs"},{default:r(()=>t[21]||(t[21]=[u("Image File")])),_:1}),o(V,{type:"file",onChange:ue,accept:"image/png, image/jpeg, image/jpg",class:"file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),o(H,null,{default:r(()=>[u(a(x(v).errors.image),1)]),_:1})]),_:1}),I.value?(n(),d("div",It,[o(F,{class:"text-xs"},{default:r(()=>t[22]||(t[22]=[u("Preview")])),_:1}),e("img",{src:I.value,class:"mt-2 max-w-full h-auto rounded-md border object-contain"},null,8,qt)])):h("",!0)]),o(T,null,{default:r(()=>[o(U,{variant:"ghost",onClick:t[0]||(t[0]=s=>k.value=!1)},{default:r(()=>t[23]||(t[23]=[u("Cancel")])),_:1}),o(U,{onClick:pe,disabled:x(v).processing},{default:r(()=>[x(v).processing?(n(),d("span",St,"Uploading...")):(n(),d("span",Rt,"Upload"))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),o(Y,{open:b.value,"onUpdate:open":t[4]||(t[4]=s=>b.value=s)},{default:r(()=>[o(P,{class:"sm:max-w-[600px]"},{default:r(()=>[o(R,null,{default:r(()=>[o(S,null,{default:r(()=>t[24]||(t[24]=[u("Edit Receive Details")])),_:1}),o(y,null,{default:r(()=>t[25]||(t[25]=[u("Update the receive information below.")])),_:1})]),_:1}),e("div",Ut,[o(L,null,{default:r(()=>[o(F,{class:"text-xs"},{default:r(()=>t[26]||(t[26]=[u("Quantity Received")])),_:1}),o(V,{modelValue:x(p).quantity_received,"onUpdate:modelValue":t[2]||(t[2]=s=>x(p).quantity_received=s),type:"number"},null,8,["modelValue"]),o(H,null,{default:r(()=>[u(a(x(p).errors.quantity_received),1)]),_:1})]),_:1})]),o(T,null,{default:r(()=>[o(U,{variant:"ghost",onClick:t[3]||(t[3]=s=>b.value=!1)},{default:r(()=>t[27]||(t[27]=[u("Cancel")])),_:1}),o(U,{onClick:xe},{default:r(()=>t[28]||(t[28]=[u("Update")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"])]}),_:1})}}};export{Bt as default};
