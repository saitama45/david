import{x,Q as g,V as E,aB as Q,y as T,N as y,l as Y,r as s,o as h,c as G,w as o,a as t,u as f,_ as C,i as D,aj as I,C as J,d as V,g as n,b as r,h as W,e as X,t as v,F as Z}from"./app-Bw_fMWAP.js";import{l as ee}from"./lodash-Cj3gZpb5.js";const te={class:"relative z-10 w-full max-w-md mx-4 bg-white rounded-lg shadow-xl border border-gray-200 p-6 transform transition-all"},oe={class:"flex items-center justify-between mb-4"},le={class:"space-y-4"},ae={class:"flex justify-end"},re={class:"space-y-4"},ne={class:"space-y-2"},se={class:"space-y-2"},ie={__name:"Index",props:{transactions:{type:Object,required:!0},branches:{type:Object,required:!0},order_date:{type:String,required:!1}},setup(i){let c=x(g().props.filters.search),u=x(g().props.filters.from),d=x(g().props.filters.to);const _=g().props.filters.branchId,b=x(!1),N=()=>{b.value=!0},k=()=>{b.value=!1},F=a=>{a.key==="Escape"&&b.value&&k()},L=a=>{a.target===a.currentTarget&&k()};E(()=>{document.addEventListener("keydown",F)}),Q(()=>{document.removeEventListener("keydown",F)}),T(u,a=>{y.get(route("store-transactions.index"),{search:c.value,from:a,to:d.value,branchId:_,order_date:i.order_date},{preserveState:!0,preserveScroll:!0})}),T(d,a=>{y.get(route("store-transactions.index"),{search:c.value,from:u.value,to:a,branchId:_,order_date:i.order_date},{preserveState:!0,preserveScroll:!0})}),T(c,ee.throttle(function(a){y.get(route("store-transactions.index"),{search:a,from:u.value,to:d.value,branchId:_,order_date:i.order_date},{preserveState:!0,replace:!0})},500));const j=()=>{u.value=i.order_date??new Date().toISOString().slice(0,10),d.value=new Date().toISOString().slice(0,10),c.value=null,y.get(route("store-transactions.index"),{search:c.value,from:u.value,to:d.value,branchId:_,order_date:i.order_date},{preserveState:!0,preserveScroll:!0,replace:!0})},O=Y(()=>route("store-transactions.export",{search:c.value,branchId:_,from:u.value,to:d.value,order_date:i.order_date})),R=a=>{if(!a)return"N/a";try{const e=new Date(a),S=String(e.getMonth()+1).padStart(2,"0"),w=String(e.getDate()).padStart(2,"0"),B=e.getFullYear();return`${S}/${w}/${B}`}catch(e){return console.error("Error formatting date:",a,e),a}};return E(()=>{console.log("StoreTransaction/Index.vue onMounted:"),console.log("  usePage().props.filters:",g().props.filters),console.log("  from.value (after init):",u.value),console.log("  to.value (after init):",d.value),console.log("  branchId (from props.filters):",_),console.log("  transactions prop:",i.transactions),console.log("  order_date prop:",i.order_date)}),(a,e)=>{const S=s("SearchBar"),w=s("DivFlexCenter"),B=s("TableHeader"),m=s("TH"),H=s("TableHead"),p=s("TD"),M=s("ShowButton"),P=s("EditButton"),U=s("TableBody"),q=s("Table"),z=s("Pagination"),$=s("TableContainer"),A=s("BackButton"),K=s("Layout");return h(),G(K,{heading:"Store Transactions",hasExcelDownload:!0,exportRoute:O.value},{default:o(()=>[t($,null,{default:o(()=>[t(B,null,{default:o(()=>[t(S,null,{default:o(()=>[t(f(C),{class:"pl-10",placeholder:"Search by Receipt No.",modelValue:f(c),"onUpdate:modelValue":e[0]||(e[0]=l=>D(c)?c.value=l:c=l)},null,8,["modelValue"])]),_:1}),t(w,{class:"gap-5"},{default:o(()=>[t(f(I),{variant:"outline",onClick:N},{default:o(()=>[t(f(J))]),_:1})]),_:1}),b.value?(h(),V("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center",onClick:L},[e[8]||(e[8]=n("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm"},null,-1)),n("div",te,[n("div",oe,[e[4]||(e[4]=n("div",null,[n("h2",{class:"text-lg font-semibold text-gray-900"},"Filter Transactions"),n("p",{class:"text-sm text-gray-600 mt-1"},"Set date range to filter store transactions.")],-1)),t(f(I),{variant:"ghost",size:"sm",onClick:k,class:"h-8 w-8 p-0 hover:bg-gray-100"},{default:o(()=>e[3]||(e[3]=[n("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),_:1})]),n("div",le,[n("div",ae,[t(f(I),{onClick:j,variant:"link",class:"text-red-500 text-xs hover:text-red-600 p-0 h-auto"},{default:o(()=>e[5]||(e[5]=[r(" Reset Filter ")])),_:1})]),n("div",re,[n("div",ne,[e[6]||(e[6]=n("label",{class:"text-sm font-medium text-gray-900"},"From",-1)),t(f(C),{type:"date",modelValue:f(u),"onUpdate:modelValue":e[1]||(e[1]=l=>D(u)?u.value=l:u=l),class:"w-full"},null,8,["modelValue"])]),n("div",se,[e[7]||(e[7]=n("label",{class:"text-sm font-medium text-gray-900"},"To",-1)),t(f(C),{type:"date",modelValue:f(d),"onUpdate:modelValue":e[2]||(e[2]=l=>D(d)?d.value=l:d=l),class:"w-full"},null,8,["modelValue"])])])])])])):W("",!0)]),_:1}),t(q,null,{default:o(()=>[t(H,null,{default:o(()=>[t(m,null,{default:o(()=>e[9]||(e[9]=[r("Id")])),_:1}),t(m,null,{default:o(()=>e[10]||(e[10]=[r("Branch Code")])),_:1}),t(m,null,{default:o(()=>e[11]||(e[11]=[r("Store Branch")])),_:1}),t(m,null,{default:o(()=>e[12]||(e[12]=[r("Receipt No.")])),_:1}),t(m,null,{default:o(()=>e[13]||(e[13]=[r("Item Count")])),_:1}),t(m,null,{default:o(()=>e[14]||(e[14]=[r("Overall Net Total")])),_:1}),t(m,null,{default:o(()=>e[15]||(e[15]=[r("POS Sales Date")])),_:1}),t(m,null,{default:o(()=>e[16]||(e[16]=[r("Actions")])),_:1})]),_:1}),t(U,null,{default:o(()=>[(h(!0),V(Z,null,X(i.transactions.data,l=>(h(),V("tr",{key:l.id},[t(p,null,{default:o(()=>[r(v(l.id),1)]),_:2},1024),t(p,null,{default:o(()=>[r(v(l.branch_code),1)]),_:2},1024),t(p,null,{default:o(()=>[r(v(l.store_branch),1)]),_:2},1024),t(p,null,{default:o(()=>[r(v(l.receipt_number),1)]),_:2},1024),t(p,null,{default:o(()=>[r(v(l.item_count),1)]),_:2},1024),t(p,null,{default:o(()=>[r(v(l.net_total),1)]),_:2},1024),t(p,null,{default:o(()=>[r(v(R(l.order_date)),1)]),_:2},1024),t(p,{class:"flex items-center"},{default:o(()=>[t(M,{isLink:!0,href:a.route("store-transactions.show",l.id)},null,8,["href"]),t(P,{isLink:!0,href:a.route("store-transactions.edit",l.id)},null,8,["href"])]),_:2},1024)]))),128))]),_:1})]),_:1}),t(z,{data:i.transactions},null,8,["data"])]),_:1}),t(A)]),_:1},8,["exportRoute"])}}};export{ie as default};
