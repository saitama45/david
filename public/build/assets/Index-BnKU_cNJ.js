import{x as M,y as W,N as U,r as b,o as l,d as v,a,u as m,Z as X,w as n,g as c,n as $,t as g,b as r,c as o,h as u,k as S,F as _,e as T,E as K}from"./app-p8ycGfai.js";import{l as ee}from"./lodash-Z9yJD-f9.js";import{A as D,a as N}from"./arrow-up-BtHBsYPW.js";const te={class:"flex items-center gap-x-2 mb-6"},le={key:0},ae={colspan:8,class:"text-center py-4"},ne={key:1,class:"flex flex-wrap gap-1"},oe={key:0},re={key:1,class:"flex flex-wrap gap-1"},se={key:2},ue={class:"flex gap-2 items-start"},ve={__name:"Index",props:{schedules:{type:Object,required:!0},filters:{type:Object,default:()=>({})},tab:{type:String,required:!0},counts:{type:Object,required:!0}},setup(C){const x=C,p=M(x.tab),d=M(x.filters.sort||"id"),s=M(x.filters.direction||"desc"),f=M({year:x.filters.year||null,month:x.filters.month||null,calculated_date:x.filters.calculated_date||null,status:x.filters.status||null,creator_name:x.filters.creator_name||null,branch_name:x.filters.branch_name||null}),z=i=>{p.value=i,U.get(route("month-end-count-approvals.index"),{tab:i},{preserveScroll:!0,replace:!0})},A=i=>{d.value===i?s.value=s.value==="asc"?"desc":"asc":(d.value=i,s.value="asc")};W([f,d,s],ee.throttle(()=>{U.get(route("month-end-count-approvals.index"),{...f.value,sort:d.value,direction:s.value,tab:p.value},{preserveState:!0,replace:!0})},300),{deep:!0});const L=i=>{const e=new Date;return e.setMonth(i-1),e.toLocaleString("en-US",{month:"long"})},I=i=>{if(!i)return"N/A";const e=new Date(i);if(isNaN(e.getTime()))return i;const w=e.getTimezoneOffset()*6e4,V=new Date(e.getTime()+w);return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}).format(V)},j=[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}],E=(i,e)=>{U.get(route("month-end-count-approvals.show",{schedule_id:i,branch_id:e}))},H={pending:"bg-yellow-500 text-white",uploaded:"bg-yellow-500 text-white",pending_level1_approval:"bg-purple-500 text-white",level1_approved:"bg-blue-500 text-white",level2_approved:"bg-green-500 text-white",rejected:"bg-red-500 text-white",expired:"bg-red-500 text-white"},q=i=>H[i]||"bg-gray-500 text-white";return(i,e)=>{const w=b("TH"),V=b("Input"),J=b("Select"),P=b("TableHead"),k=b("TD"),F=b("Badge"),O=b("Button"),Y=b("TableBody"),Z=b("Table"),G=b("Pagination"),Q=b("TableContainer"),R=b("Layout");return l(),v(_,null,[a(m(X),{title:"Month End Count Approvals"}),a(R,{heading:"Month End Count Approvals"},{default:n(()=>[c("div",te,[c("button",{onClick:e[0]||(e[0]=t=>z("for_approval")),class:$(["flex items-center gap-x-3 rounded-md px-4 py-2 text-sm font-semibold transition",p.value==="for_approval"?"bg-indigo-600 text-white shadow-sm":"bg-white text-gray-700 hover:bg-gray-50 border"])},[e[19]||(e[19]=c("span",null,"For Approval",-1)),c("span",{class:$(["px-2 py-0.5 rounded-full text-xs",p.value==="for_approval"?"bg-white/25":"bg-gray-200"])},g(C.counts.for_approval),3)],2),c("button",{onClick:e[1]||(e[1]=t=>z("approved")),class:$(["flex items-center gap-x-3 rounded-md px-4 py-2 text-sm font-semibold transition",p.value==="approved"?"bg-indigo-600 text-white shadow-sm":"bg-white text-gray-700 hover:bg-gray-50 border"])},[e[20]||(e[20]=c("span",null,"Approved",-1)),c("span",{class:$(["px-2 py-0.5 rounded-full text-xs",p.value==="approved"?"bg-white/25":"bg-gray-200"])},g(C.counts.approved),3)],2)]),a(Q,null,{default:n(()=>[a(Z,null,{default:n(()=>[a(P,null,{default:n(()=>[a(w,null,{default:n(()=>e[21]||(e[21]=[r("ID")])),_:1}),a(w,null,{default:n(()=>[c("div",{class:"flex items-center cursor-pointer",onClick:e[2]||(e[2]=t=>A("year"))},[e[22]||(e[22]=r("Year ")),d.value==="year"&&s.value==="asc"?(l(),o(m(D),{key:0,class:"h-4 w-4 ml-1"})):u("",!0),d.value==="year"&&s.value==="desc"?(l(),o(m(N),{key:1,class:"h-4 w-4 ml-1"})):u("",!0)]),a(V,{type:"text",modelValue:f.value.year,"onUpdate:modelValue":e[3]||(e[3]=t=>f.value.year=t),placeholder:"Filter...",class:"mt-1 w-full text-sm",onKeydown:e[4]||(e[4]=S(()=>{},["stop"]))},null,8,["modelValue"])]),_:1}),a(w,null,{default:n(()=>[c("div",{class:"flex items-center cursor-pointer",onClick:e[5]||(e[5]=t=>A("month"))},[e[23]||(e[23]=r("Month ")),d.value==="month"&&s.value==="asc"?(l(),o(m(D),{key:0,class:"h-4 w-4 ml-1"})):u("",!0),d.value==="month"&&s.value==="desc"?(l(),o(m(N),{key:1,class:"h-4 w-4 ml-1"})):u("",!0)]),a(J,{modelValue:f.value.month,"onUpdate:modelValue":e[6]||(e[6]=t=>f.value.month=t),options:j,optionLabel:"label",optionValue:"value",placeholder:"Select Month",class:"mt-1 w-full text-sm",showClear:""},null,8,["modelValue"])]),_:1}),a(w,null,{default:n(()=>[c("div",{class:"flex items-center cursor-pointer",onClick:e[7]||(e[7]=t=>A("calculated_date"))},[e[24]||(e[24]=r("MEC Schedule Date ")),d.value==="calculated_date"&&s.value==="asc"?(l(),o(m(D),{key:0,class:"h-4 w-4 ml-1"})):u("",!0),d.value==="calculated_date"&&s.value==="desc"?(l(),o(m(N),{key:1,class:"h-4 w-4 ml-1"})):u("",!0)]),a(V,{type:"date",modelValue:f.value.calculated_date,"onUpdate:modelValue":e[8]||(e[8]=t=>f.value.calculated_date=t),class:"mt-1 w-full text-sm",onKeydown:e[9]||(e[9]=S(()=>{},["stop"]))},null,8,["modelValue"])]),_:1}),p.value==="approved"?(l(),o(w,{key:0},{default:n(()=>[c("div",{class:"flex items-center cursor-pointer",onClick:e[10]||(e[10]=t=>A("status"))},[e[25]||(e[25]=r("Status ")),d.value==="status"&&s.value==="asc"?(l(),o(m(D),{key:0,class:"h-4 w-4 ml-1"})):u("",!0),d.value==="status"&&s.value==="desc"?(l(),o(m(N),{key:1,class:"h-4 w-4 ml-1"})):u("",!0)]),a(V,{type:"text",modelValue:f.value.status,"onUpdate:modelValue":e[11]||(e[11]=t=>f.value.status=t),placeholder:"Filter...",class:"mt-1 w-full text-sm",onKeydown:e[12]||(e[12]=S(()=>{},["stop"]))},null,8,["modelValue"])]),_:1})):(l(),o(w,{key:1},{default:n(()=>e[26]||(e[26]=[r(" Status ")])),_:1})),a(w,null,{default:n(()=>[c("div",{class:"flex items-center cursor-pointer",onClick:e[13]||(e[13]=t=>A("creator_name"))},[e[27]||(e[27]=r("Created By ")),d.value==="creator_name"&&s.value==="asc"?(l(),o(m(D),{key:0,class:"h-4 w-4 ml-1"})):u("",!0),d.value==="creator_name"&&s.value==="desc"?(l(),o(m(N),{key:1,class:"h-4 w-4 ml-1"})):u("",!0)]),a(V,{type:"text",modelValue:f.value.creator_name,"onUpdate:modelValue":e[14]||(e[14]=t=>f.value.creator_name=t),placeholder:"Filter...",class:"mt-1 w-full text-sm",onKeydown:e[15]||(e[15]=S(()=>{},["stop"]))},null,8,["modelValue"])]),_:1}),a(w,null,{default:n(()=>[c("div",{class:"flex items-center cursor-pointer",onClick:e[16]||(e[16]=t=>A("branch_name"))},[r(g(p.value==="for_approval"?"Branches Awaiting Approval":"Branch Details")+" ",1),d.value==="branch_name"&&s.value==="asc"?(l(),o(m(D),{key:0,class:"h-4 w-4 ml-1"})):u("",!0),d.value==="branch_name"&&s.value==="desc"?(l(),o(m(N),{key:1,class:"h-4 w-4 ml-1"})):u("",!0)]),a(V,{type:"text",modelValue:f.value.branch_name,"onUpdate:modelValue":e[17]||(e[17]=t=>f.value.branch_name=t),placeholder:"Filter...",class:"mt-1 w-full text-sm",onKeydown:e[18]||(e[18]=S(()=>{},["stop"]))},null,8,["modelValue"])]),_:1}),a(w,null,{default:n(()=>e[28]||(e[28]=[r("Actions")])),_:1})]),_:1}),a(Y,null,{default:n(()=>[C.schedules.data.length?u("",!0):(l(),v("tr",le,[c("td",ae,g(p.value==="for_approval"?"No schedules awaiting approval.":"No schedules found."),1)])),(l(!0),v(_,null,T(C.schedules.data,t=>(l(),v("tr",{key:t.id},[a(k,null,{default:n(()=>[r(g(t.id),1)]),_:2},1024),a(k,null,{default:n(()=>[r(g(t.year),1)]),_:2},1024),a(k,null,{default:n(()=>[r(g(L(t.month)),1)]),_:2},1024),a(k,null,{default:n(()=>[r(g(I(t.calculated_date)),1)]),_:2},1024),a(k,null,{default:n(()=>[p.value==="for_approval"?(l(),o(F,{key:0,class:"capitalize bg-purple-500 text-white"},{default:n(()=>e[29]||(e[29]=[r(" Pending Level 1 Approval ")])),_:1})):p.value==="approved"?(l(),v("div",ne,[(l(!0),v(_,null,T(t.branch_data,y=>(l(),v(_,null,[(l(!0),v(_,null,T(y.statuses,h=>(l(),o(F,{key:h,class:$(["capitalize",q(h)])},{default:n(()=>[r(g(h.replace(/_/g," ")),1)]),_:2},1032,["class"]))),128))],64))),256))])):u("",!0)]),_:2},1024),a(k,null,{default:n(()=>[r(g(t.creator?`${t.creator.first_name} ${t.creator.last_name}`:"N/A"),1)]),_:2},1024),a(k,null,{default:n(()=>{var y,h;return[p.value==="for_approval"&&((y=t.branches_awaiting_approval)!=null&&y.length)?(l(),v("div",oe,[(l(!0),v(_,null,T(t.branches_awaiting_approval,B=>(l(),o(F,{key:B.id,class:"bg-gray-200 text-gray-800 mr-1 mb-1"},{default:n(()=>[r(g(B.name),1)]),_:2},1024))),128))])):p.value==="approved"&&((h=t.branch_data)!=null&&h.length)?(l(),v("div",re,[(l(!0),v(_,null,T(t.branch_data,B=>(l(),o(F,{key:B.id,class:"bg-gray-200 text-gray-800"},{default:n(()=>[r(g(B.name),1)]),_:2},1024))),128))])):(l(),v("span",se,"N/A"))]}),_:2},1024),a(k,null,{default:n(()=>[c("div",ue,[p.value==="for_approval"?(l(!0),v(_,{key:0},T(t.branches_awaiting_approval,y=>(l(),o(O,{key:y.id,onClick:h=>E(t.id,y.id),variant:"outline",size:"icon",title:`View ${y.name}`},{default:n(()=>[a(m(K),{class:"h-4 w-4"})]),_:2},1032,["onClick","title"]))),128)):u("",!0),p.value==="approved"?(l(!0),v(_,{key:1},T(t.branch_data,y=>(l(),o(O,{key:y.id,onClick:h=>E(t.id,y.id),variant:"outline",size:"icon",title:`View ${y.name}`},{default:n(()=>[a(m(K),{class:"h-4 w-4"})]),_:2},1032,["onClick","title"]))),128)):u("",!0)])]),_:2},1024)]))),128))]),_:1})]),_:1}),C.schedules.data.length>0?(l(),o(G,{key:0,data:C.schedules},null,8,["data"])):u("",!0)]),_:1})]),_:1})],64)}}};export{ve as default};
