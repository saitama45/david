import{u as ce}from"./useSearch-DbS36i7w.js";import{G as me,f as _e,Q as ge,x as C,y as ve,N as $,l as be,T as Se,V as ke,r as s,o as p,c as _,w as l,a as e,u,d as h,g as i,t as r,h as k,i as ye,b as n,e as H,F as E}from"./app-Drfr7wPO.js";import{u as Ce}from"./useAuth-CGUY0YG2.js";import{u as Pe}from"./useReferenceDelete-Lc4jVcC1.js";import"./lodash-IPPPM5x9.js";const we={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},Te={class:"block sm:inline whitespace-pre-line"},Me={class:"space-y-5"},he={class:"flex flex-col space-y-1"},Ie={class:"flex flex-col space-y-1"},De={class:"text-xs"},Oe=["href"],Ae={__name:"Index",props:{items:{type:Object,required:!0}},setup(I){const P=me();_e();const d=ge(),V=()=>{$.get(route("POSMasterfile.create"))};let g=C(d.props.filter||"all");const{search:w}=ce("POSMasterfile.index"),D=a=>{g.value=a};ve(g,function(a){$.get(route("POSMasterfile.index"),{filter:a},{preserveState:!0,replace:!0})});const{hasAccess:y}=Ce(),{deleteModel:x}=Pe(),U=be(()=>route("POSMasterfile.export",{search:w.value,filter:g.value})),T=C(!1),M=C([]),v=C(""),F=a=>{if(!a||a.length===0)return"";let t=`The following items were skipped during import due to validation issues:

`;return a.forEach(m=>{t+=`- POS Code: ${m.pos_code||"N/A"}, Description: ${m.pos_description||"N/A"}, Reason: ${m.reason}
`}),t},O=Se({products_file:null}),W=()=>{b.value=!0,O.post(route("POSMasterfile.import"),{onSuccess:()=>{b.value=!1,T.value=!1,console.log("page.props.flash.skippedItems on success:",d.props.flash.skippedItems),d.props.flash&&d.props.flash.skippedItems&&d.props.flash.skippedItems.length>0?(M.value=d.props.flash.skippedItems,v.value=F(M.value),P.add({severity:"warn",summary:"Import Completed with Warnings",detail:"Some products were skipped during import. See persistent message for details.",life:5e3})):(v.value="",P.add({severity:"success",summary:"Success",detail:"Products Updated Successfully.",life:3e3}))},onError:a=>{b.value=!1,P.add({severity:"error",summary:"Error",detail:"An error occurred while trying to update products. Please make sure that you are using the correct format.",life:3e3})},onFinish:()=>{b.value=!1}})},X=()=>{T.value=!0},b=C(!1);return ke(()=>{console.log("page.props.flash.skippedItems on mounted:",d.props.flash.skippedItems),d.props.flash&&d.props.flash.skippedItems&&d.props.flash.skippedItems.length>0&&(M.value=d.props.flash.skippedItems,v.value=F(M.value),P.add({severity:"warn",summary:"Import Completed with Warnings",detail:"Some products were skipped during the last import. See persistent message for details.",life:5e3}))}),(a,t)=>{const m=s("FilterTabButton"),Y=s("FilterTab"),B=s("Input"),j=s("SearchBar"),L=s("Button"),q=s("TableHeader"),f=s("TH"),z=s("TableHead"),c=s("TD"),N=s("ShowButton"),A=s("EditButton"),R=s("DeleteButton"),G=s("TableBody"),Q=s("Table"),J=s("MobileTableHeading"),S=s("LabelXS"),K=s("MobileTableRow"),Z=s("MobileTableContainer"),ee=s("Pagination"),te=s("TableContainer"),le=s("DialogTitle"),oe=s("DialogDescription"),se=s("DialogHeader"),ne=s("FormError"),ae=s("Label"),re=s("Loading"),ue=s("DialogFooter"),ie=s("DialogContent"),de=s("Dialog"),pe=s("Layout");return p(),_(pe,{heading:"POSMasterfile List",hasButton:u(y)("create new POSMasterfile items"),buttonName:"Create New Item",handleClick:V,hasExcelDownload:!0,exportRoute:U.value},{default:l(()=>[e(Y,null,{default:l(()=>[e(m,{label:"All",filter:"all",currentFilter:u(g),onClick:t[0]||(t[0]=o=>D("all"))},null,8,["currentFilter"]),e(m,{label:"Active",filter:"is_active",currentFilter:u(g),onClick:t[1]||(t[1]=o=>D("is_active"))},null,8,["currentFilter"]),e(m,{label:"InActive",filter:"inactive",currentFilter:u(g),onClick:t[2]||(t[2]=o=>D("inactive"))},null,8,["currentFilter"])]),_:1}),v.value?(p(),h("div",we,[t[8]||(t[8]=i("strong",{class:"font-bold"},"Import Warnings:",-1)),i("span",Te,r(v.value),1),i("span",{class:"absolute top-0 bottom-0 right-0 px-4 py-3 cursor-pointer",onClick:t[3]||(t[3]=o=>v.value="")},t[7]||(t[7]=[i("svg",{class:"fill-current h-6 w-6 text-red-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[i("title",null,"Close"),i("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})],-1)]))])):k("",!0),e(te,null,{default:l(()=>[e(q,null,{default:l(()=>[e(j,null,{default:l(()=>[e(B,{class:"pl-10",modelValue:u(w),"onUpdate:modelValue":t[4]||(t[4]=o=>ye(w)?w.value=o:null),placeholder:"Search..."},null,8,["modelValue"])]),_:1}),e(L,{onClick:X},{default:l(()=>t[9]||(t[9]=[n("Update List")])),_:1})]),_:1}),e(Q,null,{default:l(()=>[e(z,null,{default:l(()=>[e(f,null,{default:l(()=>t[10]||(t[10]=[n("Id")])),_:1}),e(f,null,{default:l(()=>t[11]||(t[11]=[n("POS Code")])),_:1}),e(f,null,{default:l(()=>t[12]||(t[12]=[n("POS Desc")])),_:1}),e(f,null,{default:l(()=>t[13]||(t[13]=[n("Category")])),_:1}),e(f,null,{default:l(()=>t[14]||(t[14]=[n("SubCategory")])),_:1}),e(f,null,{default:l(()=>t[15]||(t[15]=[n("SRP")])),_:1}),e(f,null,{default:l(()=>t[16]||(t[16]=[n("Active")])),_:1}),e(f,null,{default:l(()=>t[17]||(t[17]=[n("Action")])),_:1})]),_:1}),e(G,null,{default:l(()=>[(p(!0),h(E,null,H(I.items.data,o=>(p(),h("tr",{key:o.id},[e(c,null,{default:l(()=>[n(r(o.id),1)]),_:2},1024),e(c,null,{default:l(()=>[n(r(o.POSCode),1)]),_:2},1024),e(c,null,{default:l(()=>[n(r(o.POSDescription),1)]),_:2},1024),e(c,null,{default:l(()=>[n(r(o.Category),1)]),_:2},1024),e(c,null,{default:l(()=>[n(r(o.SubCategory),1)]),_:2},1024),e(c,null,{default:l(()=>[n(r(o.SRP),1)]),_:2},1024),e(c,null,{default:l(()=>[n(r(Number(o.is_active)?"Yes":"No"),1)]),_:2},1024),e(c,{class:"flex items-center gap-2"},{default:l(()=>[u(y)("view item")?(p(),_(N,{key:0,isLink:!0,href:a.route("POSMasterfile.show",o.id)},null,8,["href"])):k("",!0),u(y)("edit items")?(p(),_(A,{key:1,isLink:!0,href:a.route("POSMasterfile.edit",o.id)},null,8,["href"])):k("",!0),e(R,{onClick:fe=>u(x)(a.route("POSMasterfile.destroy",o.id),"SAP Masterfile Item")},null,8,["onClick"])]),_:2},1024)]))),128))]),_:1})]),_:1}),e(Z,null,{default:l(()=>[(p(!0),h(E,null,H(I.items.data,o=>(p(),_(K,{key:o.id},{default:l(()=>[e(J,{title:`${o.POSDescription} (${o.POSCode})`},{default:l(()=>[u(y)("view item")?(p(),_(N,{key:0,isLink:!0,href:a.route("POSMasterfile.show",o.id)},null,8,["href"])):k("",!0),u(y)("edit items")?(p(),_(A,{key:1,isLink:!0,href:a.route("POSMasterfile.edit",o.id)},null,8,["href"])):k("",!0),e(R,{onClick:fe=>u(x)(a.route("POSMasterfile.destroy",o.id),"POSMasterfile Item")},null,8,["onClick"])]),_:2},1032,["title"]),e(S,null,{default:l(()=>[n("POS Code: "+r(o.POSCode),1)]),_:2},1024),e(S,null,{default:l(()=>[n("POS Desc: "+r(o.POSDescription),1)]),_:2},1024),e(S,null,{default:l(()=>[n("Category: "+r(o.Category),1)]),_:2},1024),e(S,null,{default:l(()=>[n("SubCategory: "+r(o.SubCategory),1)]),_:2},1024),e(S,null,{default:l(()=>[n("SRP: "+r(o.SRP),1)]),_:2},1024),e(S,null,{default:l(()=>[n("Active: "+r(Number(o.is_active)?"Yes":"No"),1)]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(ee,{data:I.items},null,8,["data"])]),_:1}),e(de,{open:T.value,"onUpdate:open":t[6]||(t[6]=o=>T.value=o)},{default:l(()=>[e(ie,{class:"sm:max-w-[600px]"},{default:l(()=>[e(se,null,{default:l(()=>[e(le,null,{default:l(()=>t[18]||(t[18]=[n("Import Products")])),_:1}),e(oe,null,{default:l(()=>t[19]||(t[19]=[n(" Import the excel file of the products. ")])),_:1})]),_:1}),i("div",Me,[i("div",he,[e(B,{type:"file",onInput:t[5]||(t[5]=o=>u(O).products_file=o.target.files[0])}),e(ne,null,{default:l(()=>[n(r(u(O).errors.products_file),1)]),_:1})]),i("div",Ie,[e(ae,{class:"text-xs"},{default:l(()=>t[20]||(t[20]=[n("Accepted Products File Format")])),_:1}),i("ul",null,[i("li",De,[i("a",{class:"text-blue-500 underline",href:a.route("excel.POSMasterfile-template")},"Click to download",8,Oe)])])])]),e(ue,null,{default:l(()=>[e(L,{disabled:b.value,onClick:W,type:"submit",class:"gap-2"},{default:l(()=>[t[21]||(t[21]=n(" Proceed ")),i("span",null,[b.value?(p(),_(re,{key:0})):k("",!0)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1},8,["hasButton","exportRoute"])}}};export{Ae as default};
