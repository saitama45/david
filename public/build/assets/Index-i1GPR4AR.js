import{u as ce}from"./useSearch-CHd_X8p0.js";import{G as me,f as _e,Q as ge,x as k,y as be,N as R,l as ve,T as Se,V as Pe,r as s,o as c,c as g,w as l,a as e,u,d as O,g as i,t as a,h as P,i as ye,b as n,e as $,F as H}from"./app-rjK1ng7o.js";import{u as ke}from"./useAuth-DN4uYPJg.js";import{u as Ce}from"./useReferenceDelete-DQBdt7a9.js";import"./lodash-DqVvdaAw.js";const Te={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},we={class:"block sm:inline whitespace-pre-line"},De={class:"space-y-5"},Oe={class:"flex flex-col space-y-1"},Me={class:"flex flex-col space-y-1"},Ie={class:"text-xs"},xe=["href"],Ae={__name:"Index",props:{items:{type:Object,required:!0}},setup(M){const C=me();_e();const d=ge(),E=()=>{R.get(route("POSMasterfile.create"))};let b=k(d.props.filter||"all");const{search:T}=ce("POSMasterfile.index"),I=r=>{b.value=r};be(b,function(r){R.get(route("POSMasterfile.index"),{filter:r},{preserveState:!0,replace:!0})});const{hasAccess:y}=ke(),{deleteModel:F}=Ce(),U=ve(()=>route("POSMasterfile.export",{search:T.value,filter:b.value})),w=k(!1),D=k([]),v=k(""),h=r=>{if(!r||r.length===0)return"";let t=`The following items were skipped during import due to validation issues:

`;return r.forEach(_=>{t+=`- POS Code: ${_.pos_code||"N/A"}, Description: ${_.pos_description||"N/A"}, Reason: ${_.reason}
`}),t},x=Se({products_file:null}),W=()=>{S.value=!0,x.post(route("POSMasterfile.import"),{onSuccess:()=>{S.value=!1,w.value=!1,console.log("page.props.flash.skippedItems on success:",d.props.flash.skippedItems),d.props.flash&&d.props.flash.skippedItems&&d.props.flash.skippedItems.length>0?(D.value=d.props.flash.skippedItems,v.value=h(D.value),C.add({severity:"warn",summary:"Import Completed with Warnings",detail:"Some products were skipped during import. See persistent message for details.",life:5e3})):(v.value="",C.add({severity:"success",summary:"Success",detail:"Products Updated Successfully.",life:3e3}))},onError:r=>{S.value=!1,C.add({severity:"error",summary:"Error",detail:"An error occurred while trying to update products. Please make sure that you are using the correct format.",life:3e3})},onFinish:()=>{S.value=!1}})},X=()=>{w.value=!0},S=k(!1);return Pe(()=>{console.log("page.props.flash.skippedItems on mounted:",d.props.flash.skippedItems),d.props.flash&&d.props.flash.skippedItems&&d.props.flash.skippedItems.length>0&&(D.value=d.props.flash.skippedItems,v.value=h(D.value),C.add({severity:"warn",summary:"Import Completed with Warnings",detail:"Some products were skipped during the last import. See persistent message for details.",life:5e3}))}),(r,t)=>{const _=s("FilterTabButton"),Y=s("FilterTab"),B=s("Input"),j=s("SearchBar"),L=s("Button"),q=s("TableHeader"),p=s("TH"),z=s("TableHead"),f=s("TD"),N=s("ShowButton"),A=s("EditButton"),V=s("DeleteButton"),G=s("TableBody"),Q=s("Table"),J=s("MobileTableHeading"),m=s("LabelXS"),K=s("MobileTableRow"),Z=s("MobileTableContainer"),ee=s("Pagination"),te=s("TableContainer"),le=s("DialogTitle"),oe=s("DialogDescription"),ne=s("DialogHeader"),se=s("FormError"),ae=s("Label"),re=s("Loading"),ue=s("DialogFooter"),ie=s("DialogContent"),de=s("Dialog"),pe=s("Layout");return c(),g(pe,{heading:"POSMasterfile List",hasButton:u(y)("create new POSMasterfile items"),buttonName:"Create New Item",handleClick:E,hasExcelDownload:!0,exportRoute:U.value},{default:l(()=>[e(Y,null,{default:l(()=>[e(_,{label:"All",filter:"all",currentFilter:u(b),onClick:t[0]||(t[0]=o=>I("all"))},null,8,["currentFilter"]),e(_,{label:"Active",filter:"is_active",currentFilter:u(b),onClick:t[1]||(t[1]=o=>I("is_active"))},null,8,["currentFilter"]),e(_,{label:"InActive",filter:"inactive",currentFilter:u(b),onClick:t[2]||(t[2]=o=>I("inactive"))},null,8,["currentFilter"])]),_:1}),v.value?(c(),O("div",Te,[t[8]||(t[8]=i("strong",{class:"font-bold"},"Import Warnings:",-1)),i("span",we,a(v.value),1),i("span",{class:"absolute top-0 bottom-0 right-0 px-4 py-3 cursor-pointer",onClick:t[3]||(t[3]=o=>v.value="")},t[7]||(t[7]=[i("svg",{class:"fill-current h-6 w-6 text-red-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[i("title",null,"Close"),i("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})],-1)]))])):P("",!0),e(te,null,{default:l(()=>[e(q,null,{default:l(()=>[e(j,null,{default:l(()=>[e(B,{class:"pl-10",modelValue:u(T),"onUpdate:modelValue":t[4]||(t[4]=o=>ye(T)?T.value=o:null),placeholder:"Search..."},null,8,["modelValue"])]),_:1}),e(L,{onClick:X},{default:l(()=>t[9]||(t[9]=[n("Update List")])),_:1})]),_:1}),e(Q,null,{default:l(()=>[e(z,null,{default:l(()=>[e(p,null,{default:l(()=>t[10]||(t[10]=[n("Id")])),_:1}),e(p,null,{default:l(()=>t[11]||(t[11]=[n("POS Code")])),_:1}),e(p,null,{default:l(()=>t[12]||(t[12]=[n("POS Desc")])),_:1}),e(p,null,{default:l(()=>t[13]||(t[13]=[n("POS Name")])),_:1}),e(p,null,{default:l(()=>t[14]||(t[14]=[n("Category")])),_:1}),e(p,null,{default:l(()=>t[15]||(t[15]=[n("SubCategory")])),_:1}),e(p,null,{default:l(()=>t[16]||(t[16]=[n("SRP")])),_:1}),e(p,null,{default:l(()=>t[17]||(t[17]=[n("Delivery Price")])),_:1}),e(p,null,{default:l(()=>t[18]||(t[18]=[n("Table Vibe Price")])),_:1}),e(p,null,{default:l(()=>t[19]||(t[19]=[n("Active")])),_:1}),e(p,null,{default:l(()=>t[20]||(t[20]=[n("Action")])),_:1})]),_:1}),e(G,null,{default:l(()=>[(c(!0),O(H,null,$(M.items.data,o=>(c(),O("tr",{key:o.id},[e(f,null,{default:l(()=>[n(a(o.id),1)]),_:2},1024),e(f,null,{default:l(()=>[n(a(o.POSCode),1)]),_:2},1024),e(f,null,{default:l(()=>[n(a(o.POSDescription),1)]),_:2},1024),e(f,null,{default:l(()=>[n(a(o.POSName),1)]),_:2},1024),e(f,null,{default:l(()=>[n(a(o.Category),1)]),_:2},1024),e(f,null,{default:l(()=>[n(a(o.SubCategory),1)]),_:2},1024),e(f,null,{default:l(()=>[n(a(o.SRP),1)]),_:2},1024),e(f,null,{default:l(()=>[n(a(o.DeliveryPrice),1)]),_:2},1024),e(f,null,{default:l(()=>[n(a(o.TableVibePrice),1)]),_:2},1024),e(f,null,{default:l(()=>[n(a(Number(o.is_active)?"Yes":"No"),1)]),_:2},1024),e(f,{class:"flex items-center gap-2"},{default:l(()=>[u(y)("view item")?(c(),g(N,{key:0,isLink:!0,href:r.route("POSMasterfile.show",o.id)},null,8,["href"])):P("",!0),u(y)("edit items")?(c(),g(A,{key:1,isLink:!0,href:r.route("POSMasterfile.edit",o.id)},null,8,["href"])):P("",!0),e(V,{onClick:fe=>u(F)(r.route("POSMasterfile.destroy",o.id),"SAP Masterfile Item")},null,8,["onClick"])]),_:2},1024)]))),128))]),_:1})]),_:1}),e(Z,null,{default:l(()=>[(c(!0),O(H,null,$(M.items.data,o=>(c(),g(K,{key:o.id},{default:l(()=>[e(J,{title:`${o.POSDescription} (${o.POSCode})`},{default:l(()=>[u(y)("view item")?(c(),g(N,{key:0,isLink:!0,href:r.route("POSMasterfile.show",o.id)},null,8,["href"])):P("",!0),u(y)("edit items")?(c(),g(A,{key:1,isLink:!0,href:r.route("POSMasterfile.edit",o.id)},null,8,["href"])):P("",!0),e(V,{onClick:fe=>u(F)(r.route("POSMasterfile.destroy",o.id),"POSMasterfile Item")},null,8,["onClick"])]),_:2},1032,["title"]),e(m,null,{default:l(()=>[n("POS Code: "+a(o.POSCode),1)]),_:2},1024),e(m,null,{default:l(()=>[n("POS Desc: "+a(o.POSDescription),1)]),_:2},1024),e(m,null,{default:l(()=>[n("POS Name: "+a(o.POSName),1)]),_:2},1024),e(m,null,{default:l(()=>[n("Category: "+a(o.Category),1)]),_:2},1024),e(m,null,{default:l(()=>[n("SubCategory: "+a(o.SubCategory),1)]),_:2},1024),e(m,null,{default:l(()=>[n("SRP: "+a(o.SRP),1)]),_:2},1024),e(m,null,{default:l(()=>[n("Delivery Price: "+a(o.DeliveryPrice),1)]),_:2},1024),e(m,null,{default:l(()=>[n("Table Vibe Price: "+a(o.TableVibePrice),1)]),_:2},1024),e(m,null,{default:l(()=>[n("Active: "+a(Number(o.is_active)?"Yes":"No"),1)]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(ee,{data:M.items},null,8,["data"])]),_:1}),e(de,{open:w.value,"onUpdate:open":t[6]||(t[6]=o=>w.value=o)},{default:l(()=>[e(ie,{class:"sm:max-w-[600px]"},{default:l(()=>[e(ne,null,{default:l(()=>[e(le,null,{default:l(()=>t[21]||(t[21]=[n("Import Products")])),_:1}),e(oe,null,{default:l(()=>t[22]||(t[22]=[n(" Import the excel file of the products. ")])),_:1})]),_:1}),i("div",De,[i("div",Oe,[e(B,{type:"file",onInput:t[5]||(t[5]=o=>u(x).products_file=o.target.files[0])}),e(se,null,{default:l(()=>[n(a(u(x).errors.products_file),1)]),_:1})]),i("div",Me,[e(ae,{class:"text-xs"},{default:l(()=>t[23]||(t[23]=[n("Accepted Products File Format")])),_:1}),i("ul",null,[i("li",Ie,[i("a",{class:"text-blue-500 underline",href:r.route("excel.POSMasterfile-template")},"Click to download",8,xe)])])])]),e(ue,null,{default:l(()=>[e(L,{disabled:S.value,onClick:W,type:"submit",class:"gap-2"},{default:l(()=>[t[24]||(t[24]=n(" Proceed ")),i("span",null,[S.value?(c(),g(re,{key:0})):P("",!0)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1},8,["hasButton","exportRoute"])}}};export{Ae as default};
