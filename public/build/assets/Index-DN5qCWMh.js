import{x as T,Q as V,N as $,y as E,l as q,T as Te,r as o,o as m,c as B,w as l,a as t,b as r,u as a,aB as ye,t as d,g as S,j as we,i as P,aC as ge,aD as ke,aE as Ve,aF as Ee,aG as Be,aH as Se,aI as Ie,aJ as $e,d as y,e as A,aK as Pe,F as H,n as Ne,h as N}from"./app-DPA7xop8.js";import{u as Oe}from"./useSelectOptions-DqOryH05.js";import{l as Re}from"./lodash-But43GHr.js";import{u as Ue}from"./useAuth-C8QnpB8L.js";const Me={class:"flex justify-center mt-3"},je={class:"flex justify-end"},Ae=["onClick"],He=["onClick"],qe={__name:"Index",props:{orders:{type:Object},branches:{type:Object}},setup(w){const G=w,{options:J}=Oe(G.branches);let i=T((V().props.filters.filterQuery||"pending").toString());const h=s=>{$.get(`/dts-orders/show/${s}`)},L=s=>{$.get(`/dts-orders/edit/${s}`)};let p=T(V().props.filters.from??null),_=T(V().props.filters.to??null),c=T(V().props.filters.branchId),b=T(V().props.filters.search);const g=Re.throttle(()=>{$.get(route("dts-orders.index"),{search:b.value||null,filterQuery:i.value==="all"?void 0:i.value,from:p.value||null,to:_.value||null,branchId:c.value||null},{preserveState:!0,replace:!0})},500);E(p,g),E(_,g),E(c,g),E(b,g),E(i,g);const X=s=>{if(!s)return"bg-gray-400 text-white";switch(s.toUpperCase()){case"APPROVED":case"RECEIVED":return"bg-green-500 text-white";case"PENDING":case"COMMITED":return"bg-yellow-500 text-white";case"REJECTED":return"bg-red-400 text-white";default:return"bg-yellow-500 text-white"}},K=()=>{p.value=null,_.value=null,c.value=null,b.value=null,i.value="all"},D=s=>{i.value=s,s==="all"&&(b.value=null,p.value=null,_.value=null,c.value=null)},{hasAccess:k}=Ue(),W=q(()=>route("dts-orders.export",{search:b.value,branchId:c.value,filterQuery:i.value,from:p.value,to:_.value})),u=Te({branch:null,start_date:null,end_date:null}),I=T(!1),Y=()=>{I.value=!0},Z=q(()=>route("pdf-export.dts-orders",{branch:u.branch,start_date:u.start_date,end_date:u.end_date})),ee=()=>{if(u.clearErrors(),u.branch||(u.errors.branch="Branch is required"),u.start_date||(u.errors.start_date="Start date is required"),u.end_date||(u.errors.end_date="End date is required"),u.start_date&&u.end_date){const s=new Date(u.start_date);new Date(u.end_date)<s&&(u.errors.end_date="End date cannot be earlier than start date")}Object.keys(u.errors).length>0||(window.open(Z.value,"_blank"),I.value=!1)},O=s=>{if(!s)return"N/A";try{const e=new Date(s);if(isNaN(e.getTime()))return console.warn("Invalid date string for formatting:",s),s;const C={year:"numeric",month:"short",day:"numeric"};return new Intl.DateTimeFormat("en-US",C).format(e)}catch(e){return console.error("Error formatting date:",s,e),s}},te=()=>{$.get(route("dts-orders.create"))};return(s,e)=>{const C=o("LabelXS"),R=o("FormError"),U=o("InputContainer"),z=o("DatePicker"),M=o("Button"),le=o("DivFlexCol"),F=o("FilterTabButton"),ne=o("FilterTab"),j=o("Input"),ae=o("SearchBar"),oe=o("Filter"),re=o("SelectShad"),Q=o("DivFlexCenter"),ue=o("TableHeader"),v=o("TH"),se=o("TableHead"),x=o("TD"),de=o("Badge"),ie=o("Eye"),fe=o("Pencil"),me=o("TableBody"),pe=o("Table"),_e=o("ShowButton"),ce=o("EditButton"),be=o("MobileTableHeading"),ve=o("MobileTableRow"),xe=o("MobileTableContainer"),Ce=o("Pagination"),De=o("TableContainer"),Fe=o("Layout");return m(),B(Fe,{heading:"DTS Orders",hasButton:a(k)("create dts orders"),buttonName:"Create DTS Order",handleClick:te,hasExcelDownload:!0,exportRoute:W.value},{default:l(()=>[t(a(we),{visible:I.value,"onUpdate:visible":e[3]||(e[3]=n=>I.value=n),modal:"",header:"Export to PDF",style:{width:"25rem"}},{default:l(()=>[t(le,null,{default:l(()=>[t(U,null,{default:l(()=>[t(C,null,{default:l(()=>e[14]||(e[14]=[r("Branch")])),_:1}),t(a(ye),{modelValue:a(u).branch,"onUpdate:modelValue":e[0]||(e[0]=n=>a(u).branch=n),filter:"",class:"w-full",placeholder:"Select a branch",options:a(J),optionLabel:"label",optionValue:"value"},null,8,["modelValue","options"]),t(R,null,{default:l(()=>[r(d(a(u).errors.branch),1)]),_:1})]),_:1}),t(U,null,{default:l(()=>[t(C,null,{default:l(()=>e[15]||(e[15]=[r("Start Date")])),_:1}),t(z,{showIcon:"",modelValue:a(u).start_date,"onUpdate:modelValue":e[1]||(e[1]=n=>a(u).start_date=n)},null,8,["modelValue"]),t(R,null,{default:l(()=>[r(d(a(u).errors.start_date),1)]),_:1})]),_:1}),t(U,null,{default:l(()=>[t(C,null,{default:l(()=>e[16]||(e[16]=[r("End Date")])),_:1}),t(z,{showIcon:"",modelValue:a(u).end_date,"onUpdate:modelValue":e[2]||(e[2]=n=>a(u).end_date=n)},null,8,["modelValue"]),t(R,null,{default:l(()=>[r(d(a(u).errors.end_date),1)]),_:1})]),_:1}),S("div",Me,[t(M,{onClick:ee,class:"w-full"},{default:l(()=>e[17]||(e[17]=[r("Export")])),_:1})])]),_:1})]),_:1},8,["visible"]),t(ne,null,{default:l(()=>[t(F,{label:"All",filter:"all",currentFilter:a(i),onClick:e[4]||(e[4]=n=>D("all"))},null,8,["currentFilter"]),t(F,{label:"Pending",filter:"pending",currentFilter:a(i),onClick:e[5]||(e[5]=n=>D("pending"))},null,8,["currentFilter"]),t(F,{label:"Approved",filter:"approved",currentFilter:a(i),onClick:e[6]||(e[6]=n=>D("approved"))},null,8,["currentFilter"]),t(F,{label:"Commited",filter:"committed",currentFilter:a(i),onClick:e[7]||(e[7]=n=>D("committed"))},null,8,["currentFilter"]),t(F,{label:"Received",filter:"received",currentFilter:a(i),onClick:e[8]||(e[8]=n=>D("received"))},null,8,["currentFilter"]),t(F,{label:"Rejected",filter:"rejected",currentFilter:a(i),onClick:e[9]||(e[9]=n=>D("rejected"))},null,8,["currentFilter"])]),_:1}),t(De,null,{default:l(()=>[t(ue,null,{default:l(()=>[t(ae,null,{default:l(()=>[t(j,{modelValue:a(b),"onUpdate:modelValue":e[10]||(e[10]=n=>P(b)?b.value=n:b=n),id:"search",type:"text",placeholder:"Search for order number",class:"pl-10 sm:max-w-full max-w-64"},null,8,["modelValue"])]),_:1}),t(Q,{class:"gap-5"},{default:l(()=>[t(M,{onClick:Y},{default:l(()=>e[18]||(e[18]=[r("Export To PDF")])),_:1}),t(a(ge),null,{default:l(()=>[t(a(ke),null,{default:l(()=>[t(oe)]),_:1}),t(a(Ve),null,{default:l(()=>[S("div",je,[t(M,{onClick:K,variant:"link",class:"text-end text-red-500 text-xs"},{default:l(()=>e[19]||(e[19]=[r(" Reset Filter ")])),_:1})]),e[21]||(e[21]=S("label",{class:"text-xs"},"From",-1)),t(j,{type:"date",modelValue:a(p),"onUpdate:modelValue":e[11]||(e[11]=n=>P(p)?p.value=n:p=n)},null,8,["modelValue"]),e[22]||(e[22]=S("label",{class:"text-xs"},"To",-1)),t(j,{type:"date",modelValue:a(_),"onUpdate:modelValue":e[12]||(e[12]=n=>P(_)?_.value=n:_=n)},null,8,["modelValue"]),e[23]||(e[23]=S("label",{class:"text-xs"},"Store",-1)),t(re,{modelValue:a(c),"onUpdate:modelValue":e[13]||(e[13]=n=>P(c)?c.value=n:c=n)},{default:l(()=>[t(a(Ee),null,{default:l(()=>[t(a(Be),{placeholder:"Select a store"})]),_:1}),t(a(Se),null,{default:l(()=>[t(a(Ie),null,{default:l(()=>[t(a($e),null,{default:l(()=>e[20]||(e[20]=[r("Stores")])),_:1}),(m(!0),y(H,null,A(w.branches,(n,f)=>(m(),B(a(Pe),{value:f},{default:l(()=>[r(d(n),1)]),_:2},1032,["value"]))),256))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(pe,null,{default:l(()=>[t(se,null,{default:l(()=>[t(v,null,{default:l(()=>e[24]||(e[24]=[r("Id")])),_:1}),t(v,null,{default:l(()=>e[25]||(e[25]=[r("Supplier")])),_:1}),t(v,null,{default:l(()=>e[26]||(e[26]=[r("Store")])),_:1}),t(v,null,{default:l(()=>e[27]||(e[27]=[r("Order #")])),_:1}),t(v,null,{default:l(()=>e[28]||(e[28]=[r("Delivery Date")])),_:1}),t(v,null,{default:l(()=>e[29]||(e[29]=[r("Order Placed Date")])),_:1}),t(v,null,{default:l(()=>e[30]||(e[30]=[r("Order Status")])),_:1}),t(v,null,{default:l(()=>e[31]||(e[31]=[r("Actions")])),_:1})]),_:1}),t(me,null,{default:l(()=>[(m(!0),y(H,null,A(w.orders.data,n=>(m(),y("tr",{key:n.id},[t(x,null,{default:l(()=>[r(d(n.id),1)]),_:2},1024),t(x,null,{default:l(()=>{var f;return[r(d(((f=n.supplier)==null?void 0:f.name)??"N/A"),1)]}),_:2},1024),t(x,null,{default:l(()=>{var f;return[r(d(((f=n.store_branch)==null?void 0:f.name)??"N/A"),1)]}),_:2},1024),t(x,null,{default:l(()=>[r(d(n.order_number),1)]),_:2},1024),t(x,null,{default:l(()=>[r(d(O(n.order_date)),1)]),_:2},1024),t(x,null,{default:l(()=>[r(d(O(n.created_at)),1)]),_:2},1024),t(x,null,{default:l(()=>[t(de,{class:Ne([X(n.order_status),"font-bold"])},{default:l(()=>[r(d(n.order_status.toUpperCase()),1)]),_:2},1032,["class"])]),_:2},1024),t(x,null,{default:l(()=>[t(Q,{class:"gap-3"},{default:l(()=>[a(k)("view store order")?(m(),y("button",{key:0,onClick:f=>h(n.order_number)},[t(ie,{class:"size-5"})],8,Ae)):N("",!0),n.order_status==="pending"&&a(k)("edit store orders")?(m(),y("button",{key:1,class:"text-blue-500",onClick:f=>L(n.order_number)},[t(fe,{class:"size-5"})],8,He)):N("",!0)]),_:2},1024)]),_:2},1024)]))),128))]),_:1})]),_:1}),t(xe,null,{default:l(()=>[(m(!0),y(H,null,A(w.orders.data,n=>(m(),B(ve,null,{default:l(()=>[t(be,{title:n.order_number},{default:l(()=>[a(k)("view store order")?(m(),B(_e,{key:0,class:"size-5",onClick:f=>h(n.order_number)},null,8,["onClick"])):N("",!0),n.order_status==="pending"&&a(k)("edit store orders")?(m(),B(ce,{key:1,class:"size-5",onClick:f=>L(n.order_number)},null,8,["onClick"])):N("",!0)]),_:2},1032,["title"]),t(C,null,{default:l(()=>[r(" Status: "+d(n.order_status.toUpperCase()),1)]),_:2},1024),t(C,null,{default:l(()=>[r(" Delivery Date: "+d(O(n.order_date)),1)]),_:2},1024)]),_:2},1024))),256))]),_:1}),t(Ce,{data:w.orders},null,8,["data"])]),_:1})]),_:1},8,["hasButton","exportRoute"])}}};export{qe as default};
