import{G as me,f as be,x as D,Q as h,y as H,N as P,l as S,T as ge,r as a,o as f,c as b,w as t,a as e,u as _,bB as ve,d as k,g as p,t as u,h as m,i as ye,b as n,e as R,F as U}from"./app-p8ycGfai.js";import{u as ke}from"./useSearch-rBw-Wc-C.js";import{u as Se}from"./useAuth-CsB0rIGq.js";import{u as Ce}from"./useReferenceDelete-BVAnhMD8.js";import"./lodash-Z9yJD-f9.js";const Ie={key:0,class:"mb-6"},Te={key:0,class:"bg-green-100 border-l-4 border-green-500 text-green-700 p-4 mb-4",role:"alert"},xe={class:"font-bold"},Be={key:1,class:"mt-4 p-4 bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700"},Fe=["href"],De={class:"space-y-5"},we={class:"flex flex-col space-y-1"},Le={class:"flex flex-col space-y-1"},Ae={class:"text-xs"},Ne=["href"],Pe={__name:"Index",props:{items:{type:Object,required:!0},assignedSupplierCodes:{type:Array,default:()=>[]}},setup(T){const w=me();be();let g=D(h().props.filter||"all");const{search:v}=ke("SupplierItems.index"),x=s=>{g.value=s,P.get(route("SupplierItems.index"),{filter:s,search:v.value},{preserveState:!0,replace:!0})};H(g,function(s){P.get(route("SupplierItems.index"),{filter:s,search:v.value},{preserveState:!0,replace:!0})});const{hasAccess:C}=Se(),{deleteModel:L}=Ce(),z=S(()=>route("SupplierItems.export",{search:v.value,filter:g.value})),I=D(!1),B=ge({products_file:null}),q=()=>{y.value=!0,B.post(route("SupplierItems.import"),{onSuccess:()=>{y.value=!1,I.value=!1},onError:s=>{y.value=!1,console.error("Import Error:",s),w.add({severity:"error",summary:"Import Error",detail:s.products_file||"An error occurred while trying to update supplier items. Please make sure that you are using the correct format.",life:5e3})},onFinish:()=>{y.value=!1}})},O=()=>I.value=!0,y=D(!1),K=S(()=>h().props.flash),c=S(()=>K.value.import_summary||null),X=S(()=>c.value&&c.value.skipped_details_present),Y=S(()=>route("SupplierItems.downloadSkippedImportLog"));return H(c,s=>{if(s){let l=`Processed: ${s.processed_count}. `;s.skipped_empty_keys_count>0&&(l+=`Skipped (Empty Keys): ${s.skipped_empty_keys_count}. `),s.skipped_sap_validation_count>0&&(l+=`Skipped (Validation): ${s.skipped_sap_validation_count}. `),s.skipped_unauthorized_count>0&&(l+=`Skipped (Unauthorized): ${s.skipped_unauthorized_count}. `),w.add({severity:s.skipped_details_present?"warn":"success",summary:s.skipped_details_present?"Import with Skips":"Import Successful",detail:l,life:8e3})}},{immediate:!0}),(s,l)=>{const F=a("FilterTabButton"),j=a("FilterTab"),A=a("Input"),G=a("SearchBar"),N=a("Button"),Q=a("TableHeader"),r=a("TH"),V=a("TableHead"),i=a("TD"),M=a("ShowButton"),E=a("EditButton"),$=a("DeleteButton"),J=a("TableBody"),W=a("Table"),Z=a("MobileTableHeading"),d=a("LabelXS"),ee=a("MobileTableRow"),te=a("MobileTableContainer"),le=a("Pagination"),oe=a("TableContainer"),ne=a("DialogTitle"),ue=a("DialogDescription"),ae=a("DialogHeader"),se=a("FormError"),re=a("Label"),ie=a("Loading"),de=a("DialogFooter"),pe=a("DialogContent"),fe=a("Dialog"),_e=a("Layout");return f(),b(_e,{heading:"Supplier Items List",hasButton:!1,buttonName:"Create New Item",handleClick:null,hasExcelDownload:!0,exportRoute:z.value},{default:t(()=>[e(_(ve)),c.value?(f(),k("div",Ie,[c.value.success_message?(f(),k("div",Te,[p("p",xe,u(c.value.success_message),1),p("p",null,"Processed: "+u(c.value.processed_count),1),p("p",null,"Skipped (Empty Keys): "+u(c.value.skipped_empty_keys_count),1),p("p",null,"Skipped (Validation): "+u(c.value.skipped_sap_validation_count),1),p("p",null,"Skipped (Unauthorized): "+u(c.value.skipped_unauthorized_count),1)])):m("",!0),X.value?(f(),k("div",Be,[l[6]||(l[6]=p("p",null,"Some rows were skipped during the import due to validation errors or unauthorized supplier codes.",-1)),p("a",{href:Y.value,class:"font-bold underline cursor-pointer hover:text-yellow-900"}," Click here to download a log file with details ",8,Fe)])):m("",!0)])):m("",!0),e(j,null,{default:t(()=>[e(F,{label:"All",filter:"all",currentFilter:_(g),onClick:l[0]||(l[0]=o=>x("all"))},null,8,["currentFilter"]),e(F,{label:"Active",filter:"is_active",currentFilter:_(g),onClick:l[1]||(l[1]=o=>x("is_active"))},null,8,["currentFilter"]),e(F,{label:"InActive",filter:"inactive",currentFilter:_(g),onClick:l[2]||(l[2]=o=>x("inactive"))},null,8,["currentFilter"])]),_:1}),e(oe,null,{default:t(()=>[e(Q,null,{default:t(()=>[e(G,null,{default:t(()=>[e(A,{class:"pl-10",modelValue:_(v),"onUpdate:modelValue":l[3]||(l[3]=o=>ye(v)?v.value=o:null),placeholder:"Search..."},null,8,["modelValue"])]),_:1}),e(N,{onClick:O},{default:t(()=>l[7]||(l[7]=[n("Update List")])),_:1})]),_:1}),e(W,null,{default:t(()=>[e(V,null,{default:t(()=>[e(r,null,{default:t(()=>l[8]||(l[8]=[n("Category")])),_:1}),e(r,null,{default:t(()=>l[9]||(l[9]=[n("Category 2")])),_:1}),e(r,null,{default:t(()=>l[10]||(l[10]=[n("Area")])),_:1}),e(r,null,{default:t(()=>l[11]||(l[11]=[n("Brand")])),_:1}),e(r,null,{default:t(()=>l[12]||(l[12]=[n("Classification")])),_:1}),e(r,null,{default:t(()=>l[13]||(l[13]=[n("Item Code")])),_:1}),e(r,null,{default:t(()=>l[14]||(l[14]=[n("Item Name")])),_:1}),e(r,null,{default:t(()=>l[15]||(l[15]=[n("Packaging Config")])),_:1}),e(r,null,{default:t(()=>l[16]||(l[16]=[n("BaseUOM")])),_:1}),e(r,null,{default:t(()=>l[17]||(l[17]=[n("Unit")])),_:1}),e(r,null,{default:t(()=>l[18]||(l[18]=[n("Cost")])),_:1}),e(r,null,{default:t(()=>l[19]||(l[19]=[n("Actual Cost")])),_:1}),e(r,null,{default:t(()=>l[20]||(l[20]=[n("SRP")])),_:1}),e(r,null,{default:t(()=>l[21]||(l[21]=[n("Supplier Code")])),_:1}),e(r,null,{default:t(()=>l[22]||(l[22]=[n("Active")])),_:1}),e(r,null,{default:t(()=>l[23]||(l[23]=[n("Action")])),_:1})]),_:1}),e(J,null,{default:t(()=>[(f(!0),k(U,null,R(T.items.data,o=>(f(),k("tr",{key:o.id},[e(i,null,{default:t(()=>[n(u(o.category),1)]),_:2},1024),e(i,null,{default:t(()=>[n(u(o.category_2),1)]),_:2},1024),e(i,null,{default:t(()=>[n(u(o.area),1)]),_:2},1024),e(i,null,{default:t(()=>[n(u(o.brand),1)]),_:2},1024),e(i,null,{default:t(()=>[n(u(o.classification),1)]),_:2},1024),e(i,null,{default:t(()=>[n(u(o.ItemCode),1)]),_:2},1024),e(i,null,{default:t(()=>[n(u(o.item_name),1)]),_:2},1024),e(i,null,{default:t(()=>[n(u(o.packaging_config),1)]),_:2},1024),e(i,null,{default:t(()=>[n(u(o.base_uom_display),1)]),_:2},1024),e(i,null,{default:t(()=>[n(u(o.uom),1)]),_:2},1024),e(i,null,{default:t(()=>[n(u(o.cost),1)]),_:2},1024),e(i,{class:"font-bold text-blue-600"},{default:t(()=>[n(u(o.base_qty?(o.base_qty*o.cost).toFixed(2):"N/A"),1)]),_:2},1024),e(i,null,{default:t(()=>[n(u(o.srp),1)]),_:2},1024),e(i,null,{default:t(()=>[n(u(o.SupplierCode),1)]),_:2},1024),e(i,null,{default:t(()=>[n(u(Number(o.is_active)?"Yes":"No"),1)]),_:2},1024),e(i,{class:"flex items-center gap-2"},{default:t(()=>[_(C)("view item")?(f(),b(M,{key:0,isLink:!0,href:s.route("SupplierItems.show",o.id)},null,8,["href"])):m("",!0),_(C)("edit items")?(f(),b(E,{key:1,isLink:!0,href:s.route("SupplierItems.edit",o.id)},null,8,["href"])):m("",!0),e($,{onClick:ce=>_(L)(s.route("SupplierItems.destroy",o.id),"Supplier Item")},null,8,["onClick"])]),_:2},1024)]))),128))]),_:1})]),_:1}),e(te,null,{default:t(()=>[(f(!0),k(U,null,R(T.items.data,o=>(f(),b(ee,{key:o.id},{default:t(()=>[e(Z,{title:`${o.item_name} (${o.ItemCode})`},{default:t(()=>[_(C)("view item")?(f(),b(M,{key:0,isLink:!0,href:s.route("SupplierItems.show",o.id)},null,8,["href"])):m("",!0),_(C)("edit items")?(f(),b(E,{key:1,isLink:!0,href:s.route("SupplierItems.edit",o.id)},null,8,["href"])):m("",!0),e($,{onClick:ce=>_(L)(s.route("SupplierItems.destroy",o.id),"Supplier Item")},null,8,["onClick"])]),_:2},1032,["title"]),e(d,null,{default:t(()=>[n("Item Code: "+u(o.ItemCode),1)]),_:2},1024),e(d,null,{default:t(()=>[n("Item Name: "+u(o.item_name),1)]),_:2},1024),e(d,null,{default:t(()=>[n("Supplier Code: "+u(o.SupplierCode),1)]),_:2},1024),e(d,null,{default:t(()=>[n("Category: "+u(o.category),1)]),_:2},1024),e(d,null,{default:t(()=>[n("Category 2: "+u(o.category_2),1)]),_:2},1024),e(d,null,{default:t(()=>[n("Area: "+u(o.area),1)]),_:2},1024),e(d,null,{default:t(()=>[n("Brand: "+u(o.brand),1)]),_:2},1024),e(d,null,{default:t(()=>[n("Classification: "+u(o.classification),1)]),_:2},1024),e(d,null,{default:t(()=>[n("Packaging Config: "+u(o.packaging_config),1)]),_:2},1024),e(d,null,{default:t(()=>[n("BaseUOM: "+u(o.base_uom_display),1)]),_:2},1024),e(d,null,{default:t(()=>[n("UOM: "+u(o.uom),1)]),_:2},1024),e(d,null,{default:t(()=>[n("Cost: "+u(o.cost),1)]),_:2},1024),e(d,{class:"font-bold text-blue-600"},{default:t(()=>[n("Actual Cost: "+u(o.base_qty?(o.base_qty*o.cost).toFixed(2):"N/A"),1)]),_:2},1024),e(d,null,{default:t(()=>[n("SRP: "+u(o.srp),1)]),_:2},1024),e(d,null,{default:t(()=>[n("Active: "+u(Number(o.is_active)?"Yes":"No"),1)]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(le,{data:T.items},null,8,["data"])]),_:1}),e(fe,{open:I.value,"onUpdate:open":l[5]||(l[5]=o=>I.value=o)},{default:t(()=>[e(pe,{class:"sm:max-w-[600px]"},{default:t(()=>[e(ae,null,{default:t(()=>[e(ne,null,{default:t(()=>l[24]||(l[24]=[n("Import Supplier Items")])),_:1}),e(ue,null,{default:t(()=>l[25]||(l[25]=[n(" Import the Excel file of the supplier items. ")])),_:1})]),_:1}),p("div",De,[p("div",we,[e(A,{type:"file",onInput:l[4]||(l[4]=o=>_(B).products_file=o.target.files[0])}),e(se,null,{default:t(()=>[n(u(_(B).errors.products_file),1)]),_:1})]),p("div",Le,[e(re,{class:"text-xs"},{default:t(()=>l[26]||(l[26]=[n("Accepted Supplier Items File Format")])),_:1}),p("ul",null,[p("li",Ae,[p("a",{class:"text-blue-500 underline",href:s.route("excel.SupplierItems-template")+"?v="+new Date().getTime()},"Click to download template",8,Ne)])])])]),e(de,null,{default:t(()=>[e(N,{disabled:y.value,onClick:q,type:"submit",class:"gap-2"},{default:t(()=>[l[27]||(l[27]=n(" Proceed ")),p("span",null,[y.value?(f(),b(ie,{key:0})):m("",!0)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1},8,["exportRoute"])}}};export{Pe as default};
