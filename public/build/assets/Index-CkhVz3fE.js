import{x as $,y as Q,N as M,r as c,o as l,d as f,a,u as v,Z as R,w as n,g as i,n as N,t as g,b as s,c as o,h as p,k as B,F as h,e as S,E as W}from"./app-DZB5krWT.js";import{l as X}from"./lodash-gd7BEsaJ.js";import{A,a as D}from"./arrow-up-1_eznSVm.js";const ee={class:"flex items-center gap-x-2 mb-6"},te={key:0},le={colspan:8,class:"text-center py-4"},ae={key:1,class:"flex flex-wrap gap-1"},ne={key:0,class:"flex flex-wrap gap-1"},oe={key:1},re={class:"flex gap-2 items-start"},ie={__name:"Index",props:{schedules:{type:Object,required:!0},filters:{type:Object,default:()=>({})},tab:{type:String,required:!0},counts:{type:Object,required:!0}},setup(k){const x=k,y=$(x.tab),u=$(x.filters.sort||"id"),r=$(x.filters.direction||"desc"),m=$({year:x.filters.year||null,month:x.filters.month||null,calculated_date:x.filters.calculated_date||null,status:x.filters.status||null,creator_name:x.filters.creator_name||null,branch_name:x.filters.branch_name||null}),U=d=>{y.value=d,M.get(route("month-end-count-approvals-level2.index"),{tab:d},{preserveScroll:!0,replace:!0})},T=d=>{u.value===d?r.value=r.value==="asc"?"desc":"asc":(u.value=d,r.value="asc")};Q([m,u,r],X.throttle(()=>{M.get(route("month-end-count-approvals-level2.index"),{...m.value,sort:u.value,direction:r.value,tab:y.value},{preserveState:!0,replace:!0})},300),{deep:!0});const L=d=>{const e=new Date;return e.setMonth(d-1),e.toLocaleString("en-US",{month:"long"})},E=d=>{if(!d)return"N/A";const e=new Date(d);if(isNaN(e.getTime()))return d;const b=e.getTimezoneOffset()*6e4,V=new Date(e.getTime()+b);return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}).format(V)},O=[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}],z=(d,e)=>{M.get(route("month-end-count-approvals-level2.show",{schedule_id:d,branch_id:e}))},K={level1_approved:"bg-blue-500 text-white",level2_approved:"bg-green-500 text-white",expired:"bg-red-500 text-white"},I=d=>K[d]||"bg-gray-500 text-white";return(d,e)=>{const b=c("TH"),V=c("Input"),H=c("Select"),j=c("TableHead"),w=c("TD"),F=c("Badge"),q=c("Button"),J=c("TableBody"),P=c("Table"),Y=c("Pagination"),Z=c("TableContainer"),G=c("Layout");return l(),f(h,null,[a(v(R),{title:"MEC Approval - 2nd Level"}),a(G,{heading:"MEC Approval - 2nd Level"},{default:n(()=>[i("div",ee,[i("button",{onClick:e[0]||(e[0]=t=>U("for_approval")),class:N(["flex items-center gap-x-3 rounded-md px-4 py-2 text-sm font-semibold transition",y.value==="for_approval"?"bg-indigo-600 text-white shadow-sm":"bg-white text-gray-700 hover:bg-gray-50 border"])},[e[19]||(e[19]=i("span",null,"For Approval",-1)),i("span",{class:N(["px-2 py-0.5 rounded-full text-xs",y.value==="for_approval"?"bg-white/25":"bg-gray-200"])},g(k.counts.for_approval),3)],2),i("button",{onClick:e[1]||(e[1]=t=>U("approved")),class:N(["flex items-center gap-x-3 rounded-md px-4 py-2 text-sm font-semibold transition",y.value==="approved"?"bg-indigo-600 text-white shadow-sm":"bg-white text-gray-700 hover:bg-gray-50 border"])},[e[20]||(e[20]=i("span",null,"Approved",-1)),i("span",{class:N(["px-2 py-0.5 rounded-full text-xs",y.value==="approved"?"bg-white/25":"bg-gray-200"])},g(k.counts.approved),3)],2)]),a(Z,null,{default:n(()=>[a(P,null,{default:n(()=>[a(j,null,{default:n(()=>[a(b,null,{default:n(()=>e[21]||(e[21]=[s("ID")])),_:1}),a(b,null,{default:n(()=>[i("div",{class:"flex items-center cursor-pointer",onClick:e[2]||(e[2]=t=>T("year"))},[e[22]||(e[22]=s("Year ")),u.value==="year"&&r.value==="asc"?(l(),o(v(A),{key:0,class:"h-4 w-4 ml-1"})):p("",!0),u.value==="year"&&r.value==="desc"?(l(),o(v(D),{key:1,class:"h-4 w-4 ml-1"})):p("",!0)]),a(V,{type:"text",modelValue:m.value.year,"onUpdate:modelValue":e[3]||(e[3]=t=>m.value.year=t),placeholder:"Filter...",class:"mt-1 w-full text-sm",onKeydown:e[4]||(e[4]=B(()=>{},["stop"]))},null,8,["modelValue"])]),_:1}),a(b,null,{default:n(()=>[i("div",{class:"flex items-center cursor-pointer",onClick:e[5]||(e[5]=t=>T("month"))},[e[23]||(e[23]=s("Month ")),u.value==="month"&&r.value==="asc"?(l(),o(v(A),{key:0,class:"h-4 w-4 ml-1"})):p("",!0),u.value==="month"&&r.value==="desc"?(l(),o(v(D),{key:1,class:"h-4 w-4 ml-1"})):p("",!0)]),a(H,{modelValue:m.value.month,"onUpdate:modelValue":e[6]||(e[6]=t=>m.value.month=t),options:O,optionLabel:"label",optionValue:"value",placeholder:"Select Month",class:"mt-1 w-full text-sm",showClear:""},null,8,["modelValue"])]),_:1}),a(b,null,{default:n(()=>[i("div",{class:"flex items-center cursor-pointer",onClick:e[7]||(e[7]=t=>T("calculated_date"))},[e[24]||(e[24]=s("MEC Schedule Date ")),u.value==="calculated_date"&&r.value==="asc"?(l(),o(v(A),{key:0,class:"h-4 w-4 ml-1"})):p("",!0),u.value==="calculated_date"&&r.value==="desc"?(l(),o(v(D),{key:1,class:"h-4 w-4 ml-1"})):p("",!0)]),a(V,{type:"date",modelValue:m.value.calculated_date,"onUpdate:modelValue":e[8]||(e[8]=t=>m.value.calculated_date=t),class:"mt-1 w-full text-sm",onKeydown:e[9]||(e[9]=B(()=>{},["stop"]))},null,8,["modelValue"])]),_:1}),y.value==="approved"?(l(),o(b,{key:0},{default:n(()=>[i("div",{class:"flex items-center cursor-pointer",onClick:e[10]||(e[10]=t=>T("status"))},[e[25]||(e[25]=s("Status ")),u.value==="status"&&r.value==="asc"?(l(),o(v(A),{key:0,class:"h-4 w-4 ml-1"})):p("",!0),u.value==="status"&&r.value==="desc"?(l(),o(v(D),{key:1,class:"h-4 w-4 ml-1"})):p("",!0)]),a(V,{type:"text",modelValue:m.value.status,"onUpdate:modelValue":e[11]||(e[11]=t=>m.value.status=t),placeholder:"Filter...",class:"mt-1 w-full text-sm",onKeydown:e[12]||(e[12]=B(()=>{},["stop"]))},null,8,["modelValue"])]),_:1})):(l(),o(b,{key:1},{default:n(()=>e[26]||(e[26]=[s(" Status ")])),_:1})),a(b,null,{default:n(()=>[i("div",{class:"flex items-center cursor-pointer",onClick:e[13]||(e[13]=t=>T("creator_name"))},[e[27]||(e[27]=s("Created By ")),u.value==="creator_name"&&r.value==="asc"?(l(),o(v(A),{key:0,class:"h-4 w-4 ml-1"})):p("",!0),u.value==="creator_name"&&r.value==="desc"?(l(),o(v(D),{key:1,class:"h-4 w-4 ml-1"})):p("",!0)]),a(V,{type:"text",modelValue:m.value.creator_name,"onUpdate:modelValue":e[14]||(e[14]=t=>m.value.creator_name=t),placeholder:"Filter...",class:"mt-1 w-full text-sm",onKeydown:e[15]||(e[15]=B(()=>{},["stop"]))},null,8,["modelValue"])]),_:1}),a(b,null,{default:n(()=>[i("div",{class:"flex items-center cursor-pointer",onClick:e[16]||(e[16]=t=>T("branch_name"))},[s(g(y.value==="for_approval"?"Branches Awaiting Approval":"Branch Details")+" ",1),u.value==="branch_name"&&r.value==="asc"?(l(),o(v(A),{key:0,class:"h-4 w-4 ml-1"})):p("",!0),u.value==="branch_name"&&r.value==="desc"?(l(),o(v(D),{key:1,class:"h-4 w-4 ml-1"})):p("",!0)]),a(V,{type:"text",modelValue:m.value.branch_name,"onUpdate:modelValue":e[17]||(e[17]=t=>m.value.branch_name=t),placeholder:"Filter...",class:"mt-1 w-full text-sm",onKeydown:e[18]||(e[18]=B(()=>{},["stop"]))},null,8,["modelValue"])]),_:1}),a(b,null,{default:n(()=>e[28]||(e[28]=[s("Actions")])),_:1})]),_:1}),a(J,null,{default:n(()=>[k.schedules.data.length?p("",!0):(l(),f("tr",te,[i("td",le,g(y.value==="for_approval"?"No schedules awaiting approval.":"No schedules found."),1)])),(l(!0),f(h,null,S(k.schedules.data,t=>(l(),f("tr",{key:t.id},[a(w,null,{default:n(()=>[s(g(t.id),1)]),_:2},1024),a(w,null,{default:n(()=>[s(g(t.year),1)]),_:2},1024),a(w,null,{default:n(()=>[s(g(L(t.month)),1)]),_:2},1024),a(w,null,{default:n(()=>[s(g(E(t.calculated_date)),1)]),_:2},1024),a(w,null,{default:n(()=>[y.value==="for_approval"?(l(),o(F,{key:0,class:"capitalize bg-blue-500 text-white"},{default:n(()=>e[29]||(e[29]=[s(" Level 1 Approved ")])),_:1})):y.value==="approved"?(l(),f("div",ae,[(l(!0),f(h,null,S(t.branch_data,_=>(l(),f(h,null,[(l(!0),f(h,null,S(_.statuses,C=>(l(),o(F,{key:C,class:N(["capitalize",I(C)])},{default:n(()=>[s(g(C.replace(/_/g," ")),1)]),_:2},1032,["class"]))),128))],64))),256))])):p("",!0)]),_:2},1024),a(w,null,{default:n(()=>[s(g(t.creator?`${t.creator.first_name} ${t.creator.last_name}`:"N/A"),1)]),_:2},1024),a(w,null,{default:n(()=>{var _;return[(_=t.branch_data)!=null&&_.length?(l(),f("div",ne,[(l(!0),f(h,null,S(t.branch_data,C=>(l(),o(F,{key:C.id,class:"bg-gray-200 text-gray-800"},{default:n(()=>[s(g(C.name),1)]),_:2},1024))),128))])):(l(),f("span",oe,"N/A"))]}),_:2},1024),a(w,null,{default:n(()=>[i("div",re,[(l(!0),f(h,null,S(t.branch_data,_=>(l(),o(q,{key:_.id,onClick:C=>z(t.id,_.id),variant:"outline",size:"icon",title:`View ${_.name}`},{default:n(()=>[a(v(W),{class:"h-4 w-4"})]),_:2},1032,["onClick","title"]))),128))])]),_:2},1024)]))),128))]),_:1})]),_:1}),k.schedules.data.length>0?(l(),o(Y,{key:0,data:k.schedules},null,8,["data"])):p("",!0)]),_:1})]),_:1})],64)}}};export{ie as default};
