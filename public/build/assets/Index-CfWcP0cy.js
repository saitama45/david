import{G as fe,f as ce,x as F,Q as z,y as D,N as R,l as C,T as _e,r as u,o as f,c as b,w as t,a as e,u as c,b5 as me,d as v,g as r,t as s,h as m,i as be,b as n,e as H,F as j}from"./app-rjK1ng7o.js";import{u as ve}from"./useSearch-CHd_X8p0.js";import{u as ke}from"./useAuth-DN4uYPJg.js";import{u as ye}from"./useReferenceDelete-DQBdt7a9.js";import"./lodash-DqVvdaAw.js";const ge={key:0,class:"mb-6"},Se={key:0,class:"bg-green-100 border-l-4 border-green-500 text-green-700 p-4 mb-4",role:"alert"},Ce={class:"font-bold"},xe={key:1,class:"mt-4 p-4 bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700"},Ie=["href"],we={class:"relative z-10 w-full max-w-md mx-4 bg-white rounded-lg shadow-xl border border-gray-200 p-6 transform transition-all"},Te={class:"flex items-center justify-between mb-4"},Be={class:"space-y-5"},Le={class:"flex flex-col space-y-1"},he={class:"flex flex-col space-y-1"},Fe={class:"text-xs"},Ae=["href"],Me={class:"flex justify-end mt-4"},ze={__name:"Index",props:{items:{type:Object,required:!0},assignedSupplierCodes:{type:Array,default:()=>[]}},setup(I){const A=fe();ce();let k=F(z().props.filter||"all");const{search:y}=ve("SupplierItems.index"),w=a=>{k.value=a,R.get(route("SupplierItems.index"),{filter:a,search:y.value},{preserveState:!0,replace:!0})};D(k,function(a){R.get(route("SupplierItems.index"),{filter:a,search:y.value},{preserveState:!0,replace:!0})});const{hasAccess:x}=ke(),{deleteModel:M}=ye(),q=C(()=>route("SupplierItems.export",{search:y.value,filter:k.value})),S=F(!1),O=()=>{S.value=!0},T=()=>{S.value=!1},E=a=>{a.key==="Escape"&&S.value&&T()},K=a=>{a.target===a.currentTarget&&T()};onMounted(()=>{document.addEventListener("keydown",E)}),onUnmounted(()=>{document.removeEventListener("keydown",E)});const B=_e({products_file:null}),X=()=>{g.value=!0,B.post(route("SupplierItems.import"),{onSuccess:()=>{g.value=!1,S.value=!1},onError:a=>{g.value=!1,console.error("Import Error:",a),A.add({severity:"error",summary:"Import Error",detail:a.products_file||"An error occurred while trying to update supplier items. Please make sure that you are using the correct format.",life:5e3})},onFinish:()=>{g.value=!1}})},g=F(!1),Y=C(()=>z().props.flash),_=C(()=>Y.value.import_summary||null),G=C(()=>_.value&&_.value.skipped_details_present),Q=C(()=>route("SupplierItems.downloadSkippedImportLog"));return D(_,a=>{if(a){let l=`Processed: ${a.processed_count}. `;a.skipped_empty_keys_count>0&&(l+=`Skipped (Empty Keys): ${a.skipped_empty_keys_count}. `),a.skipped_sap_validation_count>0&&(l+=`Skipped (Validation): ${a.skipped_sap_validation_count}. `),a.skipped_unauthorized_count>0&&(l+=`Skipped (Unauthorized): ${a.skipped_unauthorized_count}. `),A.add({severity:a.skipped_details_present?"warn":"success",summary:a.skipped_details_present?"Import with Skips":"Import Successful",detail:l,life:8e3})}},{immediate:!0}),(a,l)=>{const L=u("FilterTabButton"),J=u("FilterTab"),N=u("Input"),V=u("SearchBar"),h=u("Button"),W=u("TableHeader"),i=u("TH"),Z=u("TableHead"),d=u("TD"),U=u("ShowButton"),$=u("EditButton"),P=u("DeleteButton"),ee=u("TableBody"),te=u("Table"),le=u("MobileTableHeading"),p=u("LabelXS"),oe=u("MobileTableRow"),ne=u("MobileTableContainer"),se=u("Pagination"),ae=u("TableContainer"),ue=u("FormError"),re=u("Label"),ie=u("Loading"),de=u("Layout");return f(),b(de,{heading:"Supplier Items List",hasButton:!1,buttonName:"Create New Item",handleClick:null,hasExcelDownload:!0,exportRoute:q.value},{default:t(()=>[e(c(me)),_.value?(f(),v("div",ge,[_.value.success_message?(f(),v("div",Se,[r("p",Ce,s(_.value.success_message),1),r("p",null,"Processed: "+s(_.value.processed_count),1),r("p",null,"Skipped (Empty Keys): "+s(_.value.skipped_empty_keys_count),1),r("p",null,"Skipped (Validation): "+s(_.value.skipped_sap_validation_count),1),r("p",null,"Skipped (Unauthorized): "+s(_.value.skipped_unauthorized_count),1)])):m("",!0),G.value?(f(),v("div",xe,[l[5]||(l[5]=r("p",null,"Some rows were skipped during the import due to validation errors or unauthorized supplier codes.",-1)),r("a",{href:Q.value,class:"font-bold underline cursor-pointer hover:text-yellow-900"}," Click here to download a log file with details ",8,Ie)])):m("",!0)])):m("",!0),e(J,null,{default:t(()=>[e(L,{label:"All",filter:"all",currentFilter:c(k),onClick:l[0]||(l[0]=o=>w("all"))},null,8,["currentFilter"]),e(L,{label:"Active",filter:"is_active",currentFilter:c(k),onClick:l[1]||(l[1]=o=>w("is_active"))},null,8,["currentFilter"]),e(L,{label:"InActive",filter:"inactive",currentFilter:c(k),onClick:l[2]||(l[2]=o=>w("inactive"))},null,8,["currentFilter"])]),_:1}),e(ae,null,{default:t(()=>[e(W,null,{default:t(()=>[e(V,null,{default:t(()=>[e(N,{class:"pl-10",modelValue:c(y),"onUpdate:modelValue":l[3]||(l[3]=o=>be(y)?y.value=o:null),placeholder:"Search..."},null,8,["modelValue"])]),_:1}),e(h,{onClick:O},{default:t(()=>l[6]||(l[6]=[n("Update List")])),_:1})]),_:1}),e(te,null,{default:t(()=>[e(Z,null,{default:t(()=>[e(i,null,{default:t(()=>l[7]||(l[7]=[n("Category")])),_:1}),e(i,null,{default:t(()=>l[8]||(l[8]=[n("Category 2")])),_:1}),e(i,null,{default:t(()=>l[9]||(l[9]=[n("Area")])),_:1}),e(i,null,{default:t(()=>l[10]||(l[10]=[n("Brand")])),_:1}),e(i,null,{default:t(()=>l[11]||(l[11]=[n("Classification")])),_:1}),e(i,null,{default:t(()=>l[12]||(l[12]=[n("Item Code")])),_:1}),e(i,null,{default:t(()=>l[13]||(l[13]=[n("Item Name")])),_:1}),e(i,null,{default:t(()=>l[14]||(l[14]=[n("Packaging Config")])),_:1}),e(i,null,{default:t(()=>l[15]||(l[15]=[n("BaseUOM")])),_:1}),e(i,null,{default:t(()=>l[16]||(l[16]=[n("Unit")])),_:1}),e(i,null,{default:t(()=>l[17]||(l[17]=[n("Cost")])),_:1}),e(i,null,{default:t(()=>l[18]||(l[18]=[n("Actual Cost")])),_:1}),e(i,null,{default:t(()=>l[19]||(l[19]=[n("SRP")])),_:1}),e(i,null,{default:t(()=>l[20]||(l[20]=[n("Supplier Code")])),_:1}),e(i,null,{default:t(()=>l[21]||(l[21]=[n("Active")])),_:1}),e(i,null,{default:t(()=>l[22]||(l[22]=[n("Action")])),_:1})]),_:1}),e(ee,null,{default:t(()=>[(f(!0),v(j,null,H(I.items.data,o=>(f(),v("tr",{key:o.id},[e(d,null,{default:t(()=>[n(s(o.category),1)]),_:2},1024),e(d,null,{default:t(()=>[n(s(o.category_2),1)]),_:2},1024),e(d,null,{default:t(()=>[n(s(o.area),1)]),_:2},1024),e(d,null,{default:t(()=>[n(s(o.brand),1)]),_:2},1024),e(d,null,{default:t(()=>[n(s(o.classification),1)]),_:2},1024),e(d,null,{default:t(()=>[n(s(o.ItemCode),1)]),_:2},1024),e(d,null,{default:t(()=>[n(s(o.item_name),1)]),_:2},1024),e(d,null,{default:t(()=>[n(s(o.packaging_config),1)]),_:2},1024),e(d,null,{default:t(()=>[n(s(o.base_uom_display),1)]),_:2},1024),e(d,null,{default:t(()=>[n(s(o.uom),1)]),_:2},1024),e(d,null,{default:t(()=>[n(s(o.cost),1)]),_:2},1024),e(d,{class:"font-bold text-blue-600"},{default:t(()=>[n(s(o.base_qty?(o.base_qty*o.cost).toFixed(2):"N/A"),1)]),_:2},1024),e(d,null,{default:t(()=>[n(s(o.srp),1)]),_:2},1024),e(d,null,{default:t(()=>[n(s(o.SupplierCode),1)]),_:2},1024),e(d,null,{default:t(()=>[n(s(Number(o.is_active)?"Yes":"No"),1)]),_:2},1024),e(d,{class:"flex items-center gap-2"},{default:t(()=>[c(x)("view item")?(f(),b(U,{key:0,isLink:!0,href:a.route("SupplierItems.show",o.id)},null,8,["href"])):m("",!0),c(x)("edit items")?(f(),b($,{key:1,isLink:!0,href:a.route("SupplierItems.edit",o.id)},null,8,["href"])):m("",!0),e(P,{onClick:pe=>c(M)(a.route("SupplierItems.destroy",o.id),"Supplier Item")},null,8,["onClick"])]),_:2},1024)]))),128))]),_:1})]),_:1}),e(ne,null,{default:t(()=>[(f(!0),v(j,null,H(I.items.data,o=>(f(),b(oe,{key:o.id},{default:t(()=>[e(le,{title:`${o.item_name} (${o.ItemCode})`},{default:t(()=>[c(x)("view item")?(f(),b(U,{key:0,isLink:!0,href:a.route("SupplierItems.show",o.id)},null,8,["href"])):m("",!0),c(x)("edit items")?(f(),b($,{key:1,isLink:!0,href:a.route("SupplierItems.edit",o.id)},null,8,["href"])):m("",!0),e(P,{onClick:pe=>c(M)(a.route("SupplierItems.destroy",o.id),"Supplier Item")},null,8,["onClick"])]),_:2},1032,["title"]),e(p,null,{default:t(()=>[n("Item Code: "+s(o.ItemCode),1)]),_:2},1024),e(p,null,{default:t(()=>[n("Item Name: "+s(o.item_name),1)]),_:2},1024),e(p,null,{default:t(()=>[n("Supplier Code: "+s(o.SupplierCode),1)]),_:2},1024),e(p,null,{default:t(()=>[n("Category: "+s(o.category),1)]),_:2},1024),e(p,null,{default:t(()=>[n("Category 2: "+s(o.category_2),1)]),_:2},1024),e(p,null,{default:t(()=>[n("Area: "+s(o.area),1)]),_:2},1024),e(p,null,{default:t(()=>[n("Brand: "+s(o.brand),1)]),_:2},1024),e(p,null,{default:t(()=>[n("Classification: "+s(o.classification),1)]),_:2},1024),e(p,null,{default:t(()=>[n("Packaging Config: "+s(o.packaging_config),1)]),_:2},1024),e(p,null,{default:t(()=>[n("BaseUOM: "+s(o.base_uom_display),1)]),_:2},1024),e(p,null,{default:t(()=>[n("UOM: "+s(o.uom),1)]),_:2},1024),e(p,null,{default:t(()=>[n("Cost: "+s(o.cost),1)]),_:2},1024),e(p,{class:"font-bold text-blue-600"},{default:t(()=>[n("Actual Cost: "+s(o.base_qty?(o.base_qty*o.cost).toFixed(2):"N/A"),1)]),_:2},1024),e(p,null,{default:t(()=>[n("SRP: "+s(o.srp),1)]),_:2},1024),e(p,null,{default:t(()=>[n("Active: "+s(Number(o.is_active)?"Yes":"No"),1)]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(se,{data:I.items},null,8,["data"])]),_:1}),S.value?(f(),v("div",{key:1,class:"fixed inset-0 z-50 flex items-center justify-center",onClick:K},[l[27]||(l[27]=r("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm"},null,-1)),r("div",we,[r("div",Te,[l[24]||(l[24]=r("div",null,[r("h2",{class:"text-lg font-semibold text-gray-900"},"Import Supplier Items"),r("p",{class:"text-sm text-gray-600 mt-1"},"Import the Excel file of the supplier items.")],-1)),e(h,{variant:"ghost",size:"sm",onClick:T,class:"h-8 w-8 p-0 hover:bg-gray-100"},{default:t(()=>l[23]||(l[23]=[r("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),_:1})]),r("div",Be,[r("div",Le,[e(N,{type:"file",onInput:l[4]||(l[4]=o=>c(B).products_file=o.target.files[0])}),e(ue,null,{default:t(()=>[n(s(c(B).errors.products_file),1)]),_:1})]),r("div",he,[e(re,{class:"text-xs"},{default:t(()=>l[25]||(l[25]=[n("Accepted Supplier Items File Format")])),_:1}),r("ul",null,[r("li",Fe,[r("a",{class:"text-blue-500 underline",href:a.route("excel.SupplierItems-template")+"?v="+new Date().getTime()},"Click to download template",8,Ae)])])])]),r("div",Me,[e(h,{disabled:g.value,onClick:X,type:"submit",class:"gap-2"},{default:t(()=>[l[26]||(l[26]=n(" Proceed ")),r("span",null,[g.value?(f(),b(ie,{key:0})):m("",!0)])]),_:1},8,["disabled"])])])])):m("",!0)]),_:1},8,["exportRoute"])}}};export{ze as default};
