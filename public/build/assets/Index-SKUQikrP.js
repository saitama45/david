import{G as ne,f as oe,x as y,l as ae,N as D,r as a,o as r,c,by as ue,u as m,w as e,a as t,b as n,g as N,d as B,e as H,t as u,h as v,F as M}from"./app-p8ycGfai.js";import{l as se}from"./lodash-Z9yJD-f9.js";import{u as de}from"./useAuth-CsB0rIGq.js";import{u as re}from"./useReferenceDelete-BVAnhMD8.js";const ie={class:"flex items-center justify-between w-full"},me={key:0},be={__name:"Index",props:{templates:{type:Object,required:!0},filters:{type:Object,required:!0}},setup(g){const{hasAccess:_}=de(),T=ne();oe();let V=y(g.filters.search);const C=y(V.value),k=y(!1),f=y(!1),p=y(null),$=ae(()=>route("month-end-count-templates.export",{search:C.value}));watch(C,se.throttle(function(i){D.get(route("month-end-count-templates.index"),{search:i},{preserveState:!0,replace:!0})},500));const P=()=>{k.value=!0},S=()=>{k.value=!1,p.value=null},U=i=>{p.value=i.target.files[0]},j=()=>{if(!p.value){T.add({severity:"error",summary:"Error",detail:"Please select a file to import.",life:3e3});return}const i=new FormData;i.append("file",p.value),f.value=!0,D.post(route("month-end-count-templates.import"),i,{onSuccess:()=>{T.add({severity:"success",summary:"Success",detail:"Templates imported successfully.",life:3e3}),S(),f.value=!1},onError:l=>{T.add({severity:"error",summary:"Import Error",detail:l.file||"Failed to import file.",life:3e3}),f.value=!1},onFinish:()=>{f.value=!1}})},{deleteModel:I}=re(),R=()=>{D.get("/month-end-count-templates/create")};return(i,l)=>{const w=a("Button"),O=a("Input"),q=a("SearchBar"),X=a("TableHeader"),s=a("TH"),G=a("TableHead"),d=a("TD"),A=a("ShowButton"),F=a("EditButton"),E=a("DeleteButton"),L=a("DivFlexCenter"),z=a("TableBody"),J=a("Table"),K=a("MobileTableHeading"),b=a("LabelXS"),h=a("DivFlexCol"),Q=a("Pagination"),W=a("TableContainer"),Y=a("SpanBold"),Z=a("FormError"),ee=a("InputContainer"),te=a("PrimeDialog"),le=a("Layout");return r(),c(le,{heading:"Month End Count Templates",hasButton:m(_)("create month end count templates"),buttonName:"Create New Template",handleClick:R,hasExcelDownload:!0,exportRoute:$.value},ue({default:e(()=>[t(W,null,{default:e(()=>[t(X,null,{default:e(()=>[N("div",ie,[t(q,null,{default:e(()=>[t(O,{modelValue:C.value,"onUpdate:modelValue":l[0]||(l[0]=o=>C.value=o),class:"pl-10",placeholder:"Search templates..."},null,8,["modelValue"])]),_:1})])]),_:1}),t(J,{class:"sm:table hidden"},{default:e(()=>[t(G,null,{default:e(()=>[t(s,null,{default:e(()=>l[3]||(l[3]=[n("Id")])),_:1}),t(s,null,{default:e(()=>l[4]||(l[4]=[n("Item Code")])),_:1}),t(s,null,{default:e(()=>l[5]||(l[5]=[n("Item Name")])),_:1}),t(s,null,{default:e(()=>l[6]||(l[6]=[n("Area")])),_:1}),t(s,null,{default:e(()=>l[7]||(l[7]=[n("Category 2")])),_:1}),t(s,null,{default:e(()=>l[8]||(l[8]=[n("Category")])),_:1}),t(s,null,{default:e(()=>l[9]||(l[9]=[n("Brand")])),_:1}),t(s,null,{default:e(()=>l[10]||(l[10]=[n("Packaging Config")])),_:1}),t(s,null,{default:e(()=>l[11]||(l[11]=[n("Config")])),_:1}),t(s,null,{default:e(()=>l[12]||(l[12]=[n("UOM")])),_:1}),t(s,null,{default:e(()=>l[13]||(l[13]=[n("Created By")])),_:1}),t(s,null,{default:e(()=>l[14]||(l[14]=[n("Created At")])),_:1}),t(s,null,{default:e(()=>l[15]||(l[15]=[n("Actions")])),_:1})]),_:1}),t(z,null,{default:e(()=>[(r(!0),B(M,null,H(g.templates.data,o=>(r(),B("tr",null,[t(d,null,{default:e(()=>[n(u(o.id),1)]),_:2},1024),t(d,null,{default:e(()=>[n(u(o.item_code),1)]),_:2},1024),t(d,null,{default:e(()=>[n(u(o.item_name),1)]),_:2},1024),t(d,null,{default:e(()=>[n(u(o.area||"N/A"),1)]),_:2},1024),t(d,null,{default:e(()=>[n(u(o.category_2||"N/A"),1)]),_:2},1024),t(d,null,{default:e(()=>[n(u(o.category||"N/A"),1)]),_:2},1024),t(d,null,{default:e(()=>[n(u(o.brand||"N/A"),1)]),_:2},1024),t(d,null,{default:e(()=>[n(u(o.packaging_config||"N/A"),1)]),_:2},1024),t(d,null,{default:e(()=>[n(u(o.config||"N/A"),1)]),_:2},1024),t(d,null,{default:e(()=>[n(u(o.uom||"N/A"),1)]),_:2},1024),t(d,null,{default:e(()=>{var x;return[n(u(((x=o.created_by)==null?void 0:x.name)||"N/A"),1)]}),_:2},1024),t(d,null,{default:e(()=>[n(u(new Date(o.created_at).toLocaleDateString()),1)]),_:2},1024),t(d,null,{default:e(()=>[t(L,{class:"sm:gap-3"},{default:e(()=>[m(_)("view month end count templates")?(r(),c(A,{key:0,isLink:!0,href:`/month-end-count-templates/show/${o.id}`},null,8,["href"])):v("",!0),m(_)("edit month end count templates")?(r(),c(F,{key:1,isLink:!0,href:`/month-end-count-templates/edit/${o.id}`},null,8,["href"])):v("",!0),t(E,{onClick:x=>m(I)(i.route("month-end-count-templates.destroy",o.id),"template")},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]))),256))]),_:1})]),_:1}),t(h,{class:"sm:hidden gap-3"},{default:e(()=>[(r(!0),B(M,null,H(g.templates.data,o=>(r(),c(h,{class:"rounded-lg border min-h-20 p-3"},{default:e(()=>[t(K,{title:o.item_name||`Template #${o.id}`},{default:e(()=>[m(_)("view month end count templates")?(r(),c(A,{key:0,isLink:!0,href:`/month-end-count-templates/show/${o.id}`},null,8,["href"])):v("",!0),m(_)("edit month end count templates")?(r(),c(F,{key:1,isLink:!0,href:`/month-end-count-templates/edit/${o.id}`},null,8,["href"])):v("",!0),t(E,{onClick:x=>m(I)(i.route("month-end-count-templates.destroy",o.id),"template")},null,8,["onClick"])]),_:2},1032,["title"]),t(b,null,{default:e(()=>[n("Item Code: "+u(o.item_code),1)]),_:2},1024),t(b,null,{default:e(()=>[n("Category: "+u(o.category||"N/A"),1)]),_:2},1024),t(b,null,{default:e(()=>[n("Brand: "+u(o.brand||"N/A"),1)]),_:2},1024),t(b,null,{default:e(()=>[n("Created: "+u(new Date(o.created_at).toLocaleDateString()),1)]),_:2},1024)]),_:2},1024))),256))]),_:1}),t(Q,{data:g.templates},null,8,["data"])]),_:1}),t(te,{visible:k.value,"onUpdate:visible":l[1]||(l[1]=o=>k.value=o),modal:"",style:{width:"30rem"}},{header:e(()=>[t(h,null,{default:e(()=>[t(Y,null,{default:e(()=>l[16]||(l[16]=[n("Import Templates")])),_:1}),t(b,null,{default:e(()=>l[17]||(l[17]=[n("Upload Excel file to import templates")])),_:1})]),_:1})]),default:e(()=>[t(h,null,{default:e(()=>[t(ee,null,{default:e(()=>[N("input",{type:"file",onChange:U,accept:".xlsx,.csv,.txt",class:"w-full p-2 border border-gray-300 rounded-md"},null,32),p.value?(r(),c(Z,{key:0},{default:e(()=>[n(" Selected: "+u(p.value.name),1)]),_:1})):v("",!0)]),_:1}),t(L,{class:"justify-end mt-5 gap-3"},{default:e(()=>[t(w,{onClick:S,variant:"outline",disabled:f.value},{default:e(()=>l[18]||(l[18]=[n(" Cancel ")])),_:1},8,["disabled"]),t(w,{onClick:j,disabled:f.value||!p.value},{default:e(()=>[f.value?(r(),B("span",me,l[19]||(l[19]=[N("div",{class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},null,-1)]))):v("",!0),l[20]||(l[20]=n(" Import "))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["visible"])]),_:2},[m(_)("import month end count templates")?{name:"header-actions",fn:e(()=>[t(w,{onClick:P,class:"sm:text-normal text-xs"},{default:e(()=>l[2]||(l[2]=[n(" Upload ")])),_:1})]),key:"0"}:void 0]),1032,["hasButton","exportRoute"])}}};export{be as default};
