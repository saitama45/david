import{G as K,f as Q,T as W,l as O,r as u,o as _,c as Y,w as r,a as s,b as n,g as f,u as t,t as d,d as x,e as h,F}from"./app-DPA7xop8.js";import{u as y}from"./useSelectOptions-DqOryH05.js";import{s as Z}from"./index-ClVVHXJT.js";import{s as N}from"./index-by5EjQLg.js";const ee={class:"grid sm:grid-cols-2 grid-cols-1 sm:gap-5 gap-3"},le={class:"flex items-center space-x-2 mb-2"},se={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},re={class:"text-xs text-gray-600"},te={class:"flex items-center space-x-2 mb-2"},oe={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},ae={class:"text-xs text-gray-600"},me={__name:"Create",props:{roles:{type:Object,required:!0},branches:{type:Object,required:!0},suppliers:{type:Object,required:!0},user:{type:Object,required:!1}},setup(P){var B,E,w,U;const V=K(),L=Q(),T=()=>{l.clearErrors();let a=!0;if(l.first_name||(l.setError("first_name","First name is required."),a=!1),l.last_name||(l.setError("last_name","Last name is required."),a=!1),l.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l.email)||(l.setError("email","Invalid email format."),a=!1):(l.setError("email","Email is required."),a=!1),l.password?l.password.length<8&&(l.setError("password","Password must be at least 8 characters."),a=!1):(l.setError("password","Password is required."),a=!1),(!l.phone_number||l.phone_number.replace(/[^0-9]/g,"").length!==11)&&(l.setError("phone_number","Phone number is required and must be 11 digits (e.g., 09xx xxx xxxx)."),a=!1),(!l.roles||l.roles.length===0)&&(l.setError("roles","At least one role must be assigned."),a=!1),!a){V.add({severity:"error",summary:"Validation Error",detail:"Please correct the highlighted fields.",life:3e3});return}L.require({message:"Are you sure you want to create this user?",header:"Confirmation",icon:"pi pi-exclamation-triangle",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Create",severity:"success"},accept:()=>{l.post(route("users.store"),{preserveScroll:!0,onSuccess:()=>{V.add({severity:"success",summary:"Success",detail:"New User Successfully Created",life:3e3})},onError:e=>{console.log(e),V.add({severity:"error",summary:"Error",detail:"Failed to create user. Please check the form.",life:3e3})}})}})},g=P;console.log("User props in Create.vue (Edit context):",g.user),console.log("Assigned Suppliers from user props:",(B=g.user)==null?void 0:B.suppliers);const j=()=>{router.get(route("users.index"))},{options:I}=y(g.roles),{options:C}=y(g.branches),{options:b}=y(g.suppliers),l=W({first_name:null,middle_name:null,last_name:null,phone_number:null,email:null,password:null,roles:((E=g.user)==null?void 0:E.roles.map(a=>a.id.toString()))??[],remarks:null,assignedBranches:((w=g.user)==null?void 0:w.store_branches.map(a=>a.id.toString()))??[],assignedSuppliers:((U=g.user)==null?void 0:U.suppliers.map(a=>a.id.toString()))??[]}),S=O({get:()=>{const a=C.value.length;return l.assignedBranches.length===a&&a>0},set:a=>{a?l.assignedBranches=C.value.map(e=>e.value):l.assignedBranches=[]}}),k=O({get:()=>{const a=b.value.length;return l.assignedSuppliers.length===a&&a>0},set:a=>{a?l.assignedSuppliers=b.value.map(e=>e.value):l.assignedSuppliers=[]}});return(a,e)=>{const D=u("CardTitle"),M=u("CardDescription"),R=u("CardHeader"),i=u("LabelXS"),c=u("Input"),m=u("FormError"),p=u("InputContainer"),H=u("MultiSelect"),X=u("Textarea"),A=u("Checkbox"),$=u("CardContent"),q=u("Button"),G=u("CardFooter"),z=u("Card"),J=u("Layout");return _(),Y(J,{heading:"Create New User"},{default:r(()=>[s(z,null,{default:r(()=>[s(R,null,{default:r(()=>[s(D,null,{default:r(()=>e[12]||(e[12]=[n("User Details")])),_:1}),s(M,null,{default:r(()=>e[13]||(e[13]=[n("Input all the important fields")])),_:1})]),_:1}),s($,null,{default:r(()=>[f("section",ee,[s(p,null,{default:r(()=>[s(i,null,{default:r(()=>e[14]||(e[14]=[n("First Name")])),_:1}),s(c,{modelValue:t(l).first_name,"onUpdate:modelValue":e[0]||(e[0]=o=>t(l).first_name=o)},null,8,["modelValue"]),s(m,null,{default:r(()=>[n(d(t(l).errors.first_name),1)]),_:1})]),_:1}),s(p,null,{default:r(()=>[s(i,null,{default:r(()=>e[15]||(e[15]=[n("Middle Name")])),_:1}),s(c,{modelValue:t(l).middle_name,"onUpdate:modelValue":e[1]||(e[1]=o=>t(l).middle_name=o)},null,8,["modelValue"]),s(m,null,{default:r(()=>[n(d(t(l).errors.middle_name),1)]),_:1})]),_:1}),s(p,null,{default:r(()=>[s(i,null,{default:r(()=>e[16]||(e[16]=[n("Last Name")])),_:1}),s(c,{modelValue:t(l).last_name,"onUpdate:modelValue":e[2]||(e[2]=o=>t(l).last_name=o)},null,8,["modelValue"]),s(m,null,{default:r(()=>[n(d(t(l).errors.last_name),1)]),_:1})]),_:1}),s(p,null,{default:r(()=>[s(i,null,{default:r(()=>e[17]||(e[17]=[n("Phone Number")])),_:1}),s(t(Z),{modelValue:t(l).phone_number,"onUpdate:modelValue":e[3]||(e[3]=o=>t(l).phone_number=o),mask:"9999 999 9999",placeholder:"09xx xxx xxxx"},null,8,["modelValue"]),s(m,null,{default:r(()=>[n(d(t(l).errors.phone_number),1)]),_:1})]),_:1}),s(p,null,{default:r(()=>[s(i,null,{default:r(()=>e[18]||(e[18]=[n("Email")])),_:1}),s(c,{modelValue:t(l).email,"onUpdate:modelValue":e[4]||(e[4]=o=>t(l).email=o),type:"email"},null,8,["modelValue"]),s(m,null,{default:r(()=>[n(d(t(l).errors.email),1)]),_:1})]),_:1}),s(p,null,{default:r(()=>[s(i,null,{default:r(()=>e[19]||(e[19]=[n("Password")])),_:1}),s(c,{modelValue:t(l).password,"onUpdate:modelValue":e[5]||(e[5]=o=>t(l).password=o),type:"password"},null,8,["modelValue"]),s(m,null,{default:r(()=>[n(d(t(l).errors.password),1)]),_:1})]),_:1}),s(p,null,{default:r(()=>[s(i,null,{default:r(()=>e[20]||(e[20]=[n("Roles")])),_:1}),s(H,{filter:"",placeholder:"Assign Roles",modelValue:t(l).roles,"onUpdate:modelValue":e[6]||(e[6]=o=>t(l).roles=o),options:t(I),optionLabel:"label",optionValue:"value"},null,8,["modelValue","options"]),s(m,null,{default:r(()=>[n(d(t(l).errors.roles),1)]),_:1})]),_:1}),s(p,null,{default:r(()=>[s(i,null,{default:r(()=>e[21]||(e[21]=[n("Remarks")])),_:1}),s(X,{modelValue:t(l).remarks,"onUpdate:modelValue":e[7]||(e[7]=o=>t(l).remarks=o)},null,8,["modelValue"]),s(m,null,{default:r(()=>[n(d(t(l).errors.remarks),1)]),_:1})]),_:1}),s(p,{class:"sm:col-span-2"},{default:r(()=>[f("div",le,[s(t(N),{modelValue:S.value,"onUpdate:modelValue":e[8]||(e[8]=o=>S.value=o),id:"checkAllBranches"},null,8,["modelValue"]),e[22]||(e[22]=f("label",{for:"checkAllBranches",class:"text-sm font-medium text-gray-700"},"Check All Branches",-1))]),s(i,null,{default:r(()=>e[23]||(e[23]=[n(" Assign Branches ")])),_:1}),f("div",se,[(_(!0),x(F,null,h(t(C),o=>(_(),x("div",{key:o.value,class:"flex items-center space-x-2"},[s(A,{modelValue:t(l).assignedBranches,"onUpdate:modelValue":e[9]||(e[9]=v=>t(l).assignedBranches=v),value:o.value,name:"assignedBranches[]"},null,8,["modelValue","value"]),f("label",re,d(o.label),1)]))),128))]),s(m,null,{default:r(()=>[n(d(t(l).errors.assignedBranches),1)]),_:1})]),_:1}),s(p,{class:"sm:col-span-2"},{default:r(()=>[f("div",te,[s(t(N),{modelValue:k.value,"onUpdate:modelValue":e[10]||(e[10]=o=>k.value=o),id:"checkAllSuppliers"},null,8,["modelValue"]),e[24]||(e[24]=f("label",{for:"checkAllSuppliers",class:"text-sm font-medium text-gray-700"},"Check All Suppliers",-1))]),s(i,null,{default:r(()=>e[25]||(e[25]=[n(" Assign Suppliers ")])),_:1}),f("div",oe,[(_(!0),x(F,null,h(t(b),o=>(_(),x("div",{key:o.value,class:"flex items-center space-x-2"},[s(A,{modelValue:t(l).assignedSuppliers,"onUpdate:modelValue":e[11]||(e[11]=v=>t(l).assignedSuppliers=v),value:o.value,name:"assignedSuppliers[]"},null,8,["modelValue","value"]),f("label",ae,d(o.label),1)]))),128))]),s(m,null,{default:r(()=>[n(d(t(l).errors.assignedSuppliers),1)]),_:1})]),_:1})])]),_:1}),s(G,{class:"justify-end gap-3"},{default:r(()=>[s(q,{onClick:j,variant:"outline"},{default:r(()=>e[26]||(e[26]=[n("Cancel")])),_:1}),s(q,{onClick:T,disabled:t(l).processing},{default:r(()=>e[27]||(e[27]=[n("Create")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})}}};export{me as default};
