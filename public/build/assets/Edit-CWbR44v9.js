import{f as ie,T as N,r as o,o as b,c as j,w as n,a as t,b as u,u as d,t as m,d as k,e as w,g as x,F as $}from"./app-Bw_fMWAP.js";import{u as Q}from"./useSelectOptions-BcktnHf_.js";import{u as re}from"./useToast-CgNL_wIh.js";const de=["onClick"],se=["onClick"],me=["onClick"],ce=["onClick"],ye={__name:"Edit",props:{menu:{type:Object,required:!0},ingredients:{type:Object,required:!0},categories:{type:Object,required:!0},products:{type:Object,required:!0}},setup(s){const V=ie(),{toast:C}=re(),I=ref(!1),l=N({name:s.menu.name,product_id:s.menu.product_id,name:s.menu.name,price:s.menu.price,category_id:s.menu.category_id+"",remarks:s.menu.remarks,ingredients:[]}),{options:A}=Q(s.products);Q(s.categories),s.ingredients.forEach(r=>{const e={id:r.id,inventory_code:r.inventory_code,name:r.name,quantity:r.quantity,uom:r.uom};l.ingredients.push(e)});const i=N({id:"",inventory_code:"",name:"",quantity:"",uom:""}),B=r=>{const e=l.ingredients.findIndex(c=>c.id===r);l.ingredients[e].quantity<1?l.ingredients[e].quantity=Number((l.ingredients[e].quantity+.1).toFixed(1)):l.ingredients[e].quantity+=1},M=r=>{const e=l.ingredients.findIndex(c=>c.id===r);if(l.ingredients[e].quantity<1?l.ingredients[e].quantity=Number((l.ingredients[e].quantity-.1).toFixed(1)):l.ingredients[e].quantity-=1,l.ingredients[e].quantity<.1){l.ingredients=l.ingredients.filter(c=>c.id!==r);return}};watch(()=>i.id,r=>{r&&(I.value=!0,axios.get(route("product.show",r)).then(e=>e.data).then(e=>{i.name=e.name,i.inventory_code=e.inventory_code,i.uom=e.unit_of_measurement}).catch(e=>console.log(e)).finally(()=>I.value=!1))});const D=r=>{V.require({message:"Are you sure you want to remove this from the ingredients list?",header:"Confirmation",icon:"pi pi-exclamation-triangle",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Remove",severity:"danger"},accept:()=>{l.ingredients=l.ingredients.filter(e=>e.id!==r),C.add({severity:"success",summary:"Confirmed",detail:"Item Removed",life:3e3})}})},R=()=>{if(i.clearErrors(),!i.id){i.setError("id","Product field is required");return}if(Number(i.quantity)<0){i.setError("quantity","Quantity must be at least 0");return}const r=l.ingredients.findIndex(e=>e.id===i.id);r!==-1?l.ingredients[r].quantity+=Number(i.quantity):l.ingredients.push({...i}),i.reset()},z=()=>{if(l.ingredients.length<1){C.add({severity:"error",summary:"Error",detail:"Please select at least one ingredient before proceeding.",life:5e3});return}V.require({message:"Are you sure you want to update this menu?",header:"Confirmation",icon:"pi pi-exclamation-triangle",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Update",severity:"success"},accept:()=>{l.put(route("menu-list.update",s.menu.id),{onSuccess:()=>{C.add({severity:"success",summary:"Success",detail:"Menu updated successfully",life:3e3})},onError:r=>{C.add({severity:"error",summary:"Error",detail:"An error occured while trying to create the menu.",life:3e3}),console.log(r)}})}})};return(r,e)=>{const c=o("CardTitle"),F=o("CardDescription"),P=o("CardHeader"),f=o("Label"),v=o("Input"),q=o("FormError"),p=o("InputContainer"),X=o("Textarea"),E=o("CardContent"),T=o("Card"),G=o("Select"),O=o("Button"),J=o("CardFooter"),K=o("DivFlexCol"),W=o("SpanBold"),Y=o("TableHeader"),_=o("TH"),Z=o("TableHead"),y=o("TD"),U=o("Minus"),H=o("Plus"),S=o("DeleteButton"),h=o("TableBody"),ee=o("Table"),te=o("MobileTableHeading"),L=o("LabelXS"),ne=o("MobileTableRow"),le=o("MobileTableContainer"),oe=o("DivFlexCenter"),ue=o("TableContainer"),ae=o("Layout");return b(),j(ae,{heading:"Edit BOM"},{default:n(()=>[t(T,{class:"grid sm:grid-cols-3 gap-5 p-5"},{default:n(()=>[t(K,{class:"gap-5"},{default:n(()=>[t(T,null,{default:n(()=>[t(P,null,{default:n(()=>[t(c,null,{default:n(()=>e[6]||(e[6]=[u("BOM Details")])),_:1}),t(F,null,{default:n(()=>e[7]||(e[7]=[u("Please input all the required fields.")])),_:1})]),_:1}),t(E,{class:"grid sm:grid-cols-2 gap-5"},{default:n(()=>[t(p,null,{default:n(()=>[t(f,null,{default:n(()=>e[8]||(e[8]=[u("Product ID")])),_:1}),t(v,{modelValue:d(l).product_id,"onUpdate:modelValue":e[0]||(e[0]=a=>d(l).product_id=a)},null,8,["modelValue"]),t(q,null,{default:n(()=>[u(m(d(l).errors.product_id),1)]),_:1})]),_:1}),t(p,null,{default:n(()=>[t(f,null,{default:n(()=>e[9]||(e[9]=[u("Name")])),_:1}),t(v,{modelValue:d(l).name,"onUpdate:modelValue":e[1]||(e[1]=a=>d(l).name=a)},null,8,["modelValue"]),t(q,null,{default:n(()=>[u(m(d(l).errors.name),1)]),_:1})]),_:1}),t(p,null,{default:n(()=>[t(f,null,{default:n(()=>e[10]||(e[10]=[u("Remarks")])),_:1}),t(X,{modelValue:d(l).remarks,"onUpdate:modelValue":e[2]||(e[2]=a=>d(l).remarks=a)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(T,null,{default:n(()=>[t(P,null,{default:n(()=>[t(c,null,{default:n(()=>e[11]||(e[11]=[u("Ingredients")])),_:1}),t(F,null,{default:n(()=>e[12]||(e[12]=[u("Please input all the required fields.")])),_:1})]),_:1}),t(E,{class:"space-y-5"},{default:n(()=>[t(p,null,{default:n(()=>[t(f,null,{default:n(()=>e[13]||(e[13]=[u("Product")])),_:1}),t(G,{filter:"",options:d(A),modelValue:d(i).id,"onUpdate:modelValue":e[3]||(e[3]=a=>d(i).id=a),optionLabel:"label",optionValue:"value"},null,8,["options","modelValue"]),t(q,null,{default:n(()=>[u(m(d(i).errors.id),1)]),_:1})]),_:1}),t(p,null,{default:n(()=>[t(f,null,{default:n(()=>e[14]||(e[14]=[u("Product UOM")])),_:1}),t(v,{modelValue:d(i).uom,"onUpdate:modelValue":e[4]||(e[4]=a=>d(i).uom=a),disabled:!0},null,8,["modelValue"])]),_:1}),t(p,null,{default:n(()=>[t(f,null,{default:n(()=>e[15]||(e[15]=[u("Quantity")])),_:1}),t(v,{type:"number",modelValue:d(i).quantity,"onUpdate:modelValue":e[5]||(e[5]=a=>d(i).quantity=a)},null,8,["modelValue"]),t(q,null,{default:n(()=>[u(m(d(i).errors.quantity),1)]),_:1})]),_:1})]),_:1}),t(J,{class:"justify-end"},{default:n(()=>[t(O,{onClick:R},{default:n(()=>e[16]||(e[16]=[u("Add")])),_:1})]),_:1})]),_:1})]),_:1}),t(ue,{class:"sm:col-span-2"},{default:n(()=>[t(Y,null,{default:n(()=>[t(W,null,{default:n(()=>e[17]||(e[17]=[u("Ingredients")])),_:1})]),_:1}),t(ee,null,{default:n(()=>[t(Z,null,{default:n(()=>[t(_,null,{default:n(()=>e[18]||(e[18]=[u("Inventory Code")])),_:1}),t(_,null,{default:n(()=>e[19]||(e[19]=[u("Name")])),_:1}),t(_,null,{default:n(()=>e[20]||(e[20]=[u("Quantity")])),_:1}),t(_,null,{default:n(()=>e[21]||(e[21]=[u("UOM")])),_:1}),t(_,null,{default:n(()=>e[22]||(e[22]=[u("Actions")])),_:1})]),_:1}),t(h,null,{default:n(()=>[(b(!0),k($,null,w(d(l).ingredients,a=>(b(),k("tr",null,[t(y,null,{default:n(()=>[u(m(a.inventory_code),1)]),_:2},1024),t(y,null,{default:n(()=>[u(m(a.name),1)]),_:2},1024),t(y,null,{default:n(()=>[u(m(a.quantity),1)]),_:2},1024),t(y,null,{default:n(()=>[u(m(a.uom),1)]),_:2},1024),t(y,{class:"flex gap-3"},{default:n(()=>[x("button",{class:"text-red-500",onClick:g=>M(a.id)},[t(U)],8,de),x("button",{class:"text-green-500",onClick:g=>B(a.id)},[t(H)],8,se),t(S,{onClick:g=>D(a.id),variant:"outline",class:"text-red-500"},null,8,["onClick"])]),_:2},1024)]))),256))]),_:1})]),_:1}),t(le,null,{default:n(()=>[(b(!0),k($,null,w(d(l).ingredients,a=>(b(),j(ne,null,{default:n(()=>[t(te,{title:`${a.name} (${a.inventory_code})`},{default:n(()=>[x("button",{class:"text-red-500 size-5",onClick:g=>M(a.id)},[t(U)],8,me),x("button",{class:"text-green-500 size-5",onClick:g=>B(a.id)},[t(H)],8,ce),t(S,{onClick:g=>D(a.id),variant:"outline",class:"text-red-500"},null,8,["onClick"])]),_:2},1032,["title"]),t(L,null,{default:n(()=>[u("UOM: "+m(a.unit),1)]),_:2},1024),t(L,null,{default:n(()=>[u("Quantity: "+m(a.quantity),1)]),_:2},1024)]),_:2},1024))),256))]),_:1}),t(oe,{class:"justify-end"},{default:n(()=>[t(O,{onClick:z},{default:n(()=>e[23]||(e[23]=[u("Update")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}};export{ye as default};
