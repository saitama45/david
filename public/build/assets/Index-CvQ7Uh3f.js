import{Q as D,N as x,T as ye,r as n,o as m,c as T,w as t,a as e,b as r,u,t as d,g as h,i as k,j as Ve,d as S,e as O,F as N,n as De,h as E}from"./app-DPA7xop8.js";import{u as Te}from"./useSelectOptions-DqOryH05.js";import{l as he}from"./lodash-But43GHr.js";import{u as ke}from"./useAuth-C8QnpB8L.js";const Ee={class:"flex justify-center mt-3"},Be={class:"flex justify-end"},Ie=["onClick"],Pe=["onClick"],Ue={__name:"Index",props:{orders:{type:Object},branches:{type:Object}},setup(C){const A=()=>{x.get("/additional-orders/create")},j=C,{options:R}=Te(j.branches);console.log(R);let g=ref((D().props.filters.filterQuery||"pending").toString());const U=s=>{x.get(`/store-orders/show/${s}`)},M=s=>{x.get(`/store-orders/edit/${s}`)};let c=ref(D().props.from??null),p=ref(D().props.to??null),_=ref(D().props.filters.branchId),f=ref(D().props.filters.search);watch(c,s=>{x.get(route("store-orders.index"),{search:f.value,filterQuery:g.value,from:s,to:p.value,branchId:_.value},{preserveState:!0,preserveScroll:!0})}),watch(p,s=>{x.get(route("store-orders.index"),{search:f.value,filterQuery:g.value,from:c.value,to:s,branchId:_.value},{preserveState:!0,preserveScroll:!0})}),watch(_,s=>{x.get(route("store-orders.index"),{search:f.value,filterQuery:g.value,from:c.value,to:p.value,branchId:s},{preserveState:!0,preserveScroll:!0})}),watch(f,he.throttle(function(s){x.get(route("store-orders.index"),{search:s,filterQuery:g.value,from:c.value,to:p.value,branchId:_.value},{preserveState:!0,replace:!0})},500));const z=s=>{switch(s.toUpperCase()){case"APPROVED":return"bg-green-500 text-white";case"RECEIVED":return"bg-green-500 text-white";case"PENDING":return"bg-yellow-500 text-white";case"COMMITED":return"bg-blue-500 text-white";case"REJECTED":return"bg-red-400 text-white";default:return"bg-yellow-500 text-white"}},q=()=>{c.value=null,p.value=null,_.value=null,f.value=null};watch(g,function(s){x.get(route("store-orders.index"),{search:f.value,filterQuery:s,from:c.value,to:p.value,branchId:_.value},{preserveState:!0,replace:!0})});const{hasAccess:w}=ke(),G=computed(()=>route("store-orders.export",{search:f.value,branchId:_.value,filterQuery:g.value,from:c.value,to:p.value})),a=ye({branch:null,start_date:null,end_date:null}),y=ref(!1),X=()=>{y.value=!0},$=computed(()=>route("pdf-export.store-orders",{branch:a.branch,start_date:a.start_date,end_date:a.end_date})),J=()=>{if(a.clearErrors(),a.branch||(a.errors.branch="Branch is required"),a.start_date||(a.errors.start_date="Start date is required"),a.end_date||(a.errors.end_date="End date is required"),a.start_date&&a.end_date){const s=new Date(a.start_date);new Date(a.end_date)<s&&(a.errors.end_date="End date cannot be earlier than start date")}Object.keys(a.errors).length>0||(window.open($.value,"_blank"),y.visible=!1)};return(s,l)=>{const V=n("LabelXS"),Q=n("Select"),B=n("FormError"),I=n("InputContainer"),H=n("DatePicker"),P=n("Button"),K=n("DivFlexCol"),F=n("Input"),W=n("SearchBar"),Y=n("Filter"),Z=n("PopoverTrigger"),ee=n("SelectValue"),te=n("SelectTrigger"),le=n("SelectLabel"),oe=n("SelectItem"),ne=n("SelectGroup"),re=n("SelectContent"),ae=n("PopoverContent"),ue=n("Popover"),L=n("DivFlexCenter"),se=n("TableHeader"),b=n("TH"),de=n("TableHead"),v=n("TD"),ie=n("Badge"),ce=n("Eye"),pe=n("Pencil"),_e=n("TableBody"),fe=n("Table"),me=n("ShowButton"),be=n("EditButton"),ve=n("MobileTableHeading"),xe=n("MobileTableRow"),ge=n("MobileTableContainer"),Se=n("Pagination"),Ce=n("TableContainer"),we=n("Layout");return m(),T(we,{heading:"Additional Store Orders",hasButton:u(w)("create store orders"),buttonName:"Create New Order",handleClick:A,hasExcelDownload:!0,exportRoute:u(G)},{default:t(()=>[e(u(Ve),{visible:u(y),"onUpdate:visible":l[3]||(l[3]=o=>k(y)?y.value=o:null),modal:"",header:"Export to PDF",style:{width:"25rem"}},{default:t(()=>[e(K,null,{default:t(()=>[e(I,null,{default:t(()=>[e(V,null,{default:t(()=>l[8]||(l[8]=[r("Branch")])),_:1}),e(Q,{modelValue:u(a).branch,"onUpdate:modelValue":l[0]||(l[0]=o=>u(a).branch=o),filter:"",class:"w-full",placeholder:"Select a branch",options:u(R),optionLabel:"label",optionValue:"value"},null,8,["modelValue","options"]),e(B,null,{default:t(()=>[r(d(u(a).errors.branch),1)]),_:1})]),_:1}),e(I,null,{default:t(()=>[e(V,null,{default:t(()=>l[9]||(l[9]=[r("Start Date")])),_:1}),e(H,{showIcon:"",modelValue:u(a).start_date,"onUpdate:modelValue":l[1]||(l[1]=o=>u(a).start_date=o)},null,8,["modelValue"]),e(B,null,{default:t(()=>[r(d(u(a).errors.start_date),1)]),_:1})]),_:1}),e(I,null,{default:t(()=>[e(V,null,{default:t(()=>l[10]||(l[10]=[r("End Date")])),_:1}),e(H,{showIcon:"",modelValue:u(a).end_date,"onUpdate:modelValue":l[2]||(l[2]=o=>u(a).end_date=o)},null,8,["modelValue"]),e(B,null,{default:t(()=>[r(d(u(a).errors.end_date),1)]),_:1})]),_:1}),h("div",Ee,[e(P,{onClick:J,class:"w-full"},{default:t(()=>l[11]||(l[11]=[r("Export")])),_:1})])]),_:1})]),_:1},8,["visible"]),e(Ce,null,{default:t(()=>[e(se,null,{default:t(()=>[e(W,null,{default:t(()=>[e(F,{modelValue:u(f),"onUpdate:modelValue":l[4]||(l[4]=o=>k(f)?f.value=o:f=o),id:"search",type:"text",placeholder:"Search for order number",class:"pl-10 sm:max-w-full max-w-64"},null,8,["modelValue"])]),_:1}),e(L,{class:"gap-5"},{default:t(()=>[e(P,{onClick:X},{default:t(()=>l[12]||(l[12]=[r("Export To PDF")])),_:1}),e(ue,null,{default:t(()=>[e(Z,null,{default:t(()=>[e(Y)]),_:1}),e(ae,null,{default:t(()=>[h("div",Be,[e(P,{onClick:q,variant:"link",class:"text-end text-red-500 text-xs"},{default:t(()=>l[13]||(l[13]=[r(" Reset Filter ")])),_:1})]),l[15]||(l[15]=h("label",{class:"text-xs"},"From",-1)),e(F,{type:"date",modelValue:u(c),"onUpdate:modelValue":l[5]||(l[5]=o=>k(c)?c.value=o:c=o)},null,8,["modelValue"]),l[16]||(l[16]=h("label",{class:"text-xs"},"To",-1)),e(F,{type:"date",modelValue:u(p),"onUpdate:modelValue":l[6]||(l[6]=o=>k(p)?p.value=o:p=o)},null,8,["modelValue"]),l[17]||(l[17]=h("label",{class:"text-xs"},"Store",-1)),e(Q,{modelValue:u(_),"onUpdate:modelValue":l[7]||(l[7]=o=>k(_)?_.value=o:_=o)},{default:t(()=>[e(te,null,{default:t(()=>[e(ee,{placeholder:"Select a store"})]),_:1}),e(re,null,{default:t(()=>[e(ne,null,{default:t(()=>[e(le,null,{default:t(()=>l[14]||(l[14]=[r("Stores")])),_:1}),(m(!0),S(N,null,O(C.branches,(o,i)=>(m(),T(oe,{key:i,value:i},{default:t(()=>[r(d(o),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(fe,null,{default:t(()=>[e(de,null,{default:t(()=>[e(b,null,{default:t(()=>l[18]||(l[18]=[r("Id")])),_:1}),e(b,null,{default:t(()=>l[19]||(l[19]=[r("Supplier")])),_:1}),e(b,null,{default:t(()=>l[20]||(l[20]=[r("Store")])),_:1}),e(b,null,{default:t(()=>l[21]||(l[21]=[r("Order #")])),_:1}),e(b,null,{default:t(()=>l[22]||(l[22]=[r("Order Date")])),_:1}),e(b,null,{default:t(()=>l[23]||(l[23]=[r("Order Placed Date")])),_:1}),e(b,null,{default:t(()=>l[24]||(l[24]=[r("Order Status")])),_:1}),e(b,null,{default:t(()=>l[25]||(l[25]=[r("Actions")])),_:1})]),_:1}),e(_e,null,{default:t(()=>[(m(!0),S(N,null,O(C.orders.data,o=>(m(),S("tr",{key:o.id},[e(v,null,{default:t(()=>[r(d(o.id),1)]),_:2},1024),e(v,null,{default:t(()=>{var i;return[r(d(((i=o.supplier)==null?void 0:i.name)??"N/A"),1)]}),_:2},1024),e(v,null,{default:t(()=>{var i;return[r(d(((i=o.store_branch)==null?void 0:i.name)??"N/A"),1)]}),_:2},1024),e(v,null,{default:t(()=>[r(d(o.order_number),1)]),_:2},1024),e(v,null,{default:t(()=>[r(d(o.order_date),1)]),_:2},1024),e(v,null,{default:t(()=>[r(d(o.created_at),1)]),_:2},1024),e(v,null,{default:t(()=>[e(ie,{class:De([z(o.order_status),"font-bold"])},{default:t(()=>[r(d(o.order_status.toUpperCase()),1)]),_:2},1032,["class"])]),_:2},1024),e(v,null,{default:t(()=>[e(L,{class:"gap-3"},{default:t(()=>[u(w)("view store order")?(m(),S("button",{key:0,onClick:i=>U(o.order_number)},[e(ce,{class:"size-5"})],8,Ie)):E("",!0),o.order_status==="pending"&&u(w)("edit store orders")?(m(),S("button",{key:1,class:"text-blue-500",onClick:i=>M(o.order_number)},[e(pe,{class:"size-5"})],8,Pe)):E("",!0)]),_:2},1024)]),_:2},1024)]))),128))]),_:1})]),_:1}),e(ge,null,{default:t(()=>[(m(!0),S(N,null,O(C.orders.data,o=>(m(),T(xe,null,{default:t(()=>[e(ve,{title:o.order_number},{default:t(()=>[u(w)("view store order")?(m(),T(me,{key:0,class:"size-5",onClick:i=>U(o.order_number)},null,8,["onClick"])):E("",!0),o.order_request_status==="pending"&&u(w)("edit store orders")?(m(),T(be,{key:1,class:"size-5",onClick:i=>M(o.order_number)},null,8,["onClick"])):E("",!0)]),_:2},1032,["title"]),e(V,null,{default:t(()=>[r(" Status: "+d(o.order_status.toUpperCase()),1)]),_:2},1024),e(V,null,{default:t(()=>[r(" Order Date: "+d(o.order_date),1)]),_:2},1024)]),_:2},1024))),256))]),_:1}),e(Se,{data:C.orders},null,8,["data"])]),_:1})]),_:1},8,["hasButton","exportRoute"])}}};export{Ue as default};
