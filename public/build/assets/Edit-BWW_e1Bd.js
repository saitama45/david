import{Y as je,f as Te,T as de,V as Ue,W as ue,x,bq as Fe,l as w,az as G,y as ce,r as Me,o as v,c as _e,w as m,a as l,u as o,b as y,N as me,aA as F,g as r,n as A,br as H,m as R,O as W,aP as I,s as X,d as b,t as p,h,_ as M,bs as fe,P as Le,z as Qe,e as J,ay as K,F as Z,bt as Pe,a$ as Be,aW as Re,aX as ze,aY as Ye,a_ as Ge,i as He,b0 as We}from"./app-Bp7xdNcv.js";import{u as Xe}from"./useToast-BYf4YE8m.js";import{u as Je}from"./useSelectOptions-DNoqVwQ-.js";import{u as Ke}from"./useEditQuantity-DLPB5BXZ.js";import{_ as pe,a as ve}from"./ItemQuantityModal.vue_vue_type_style_index_0_scoped_cebaab2c_lang-BGO3cF0Q.js";import be from"./StockIndicator-OXXkftVS.js";import{A as Ze}from"./arrow-left-Bx8aOM0-.js";import{P as z}from"./package-8PI2OvT-.js";import{T as ye}from"./triangle-alert-ClI8I6RE.js";import{S as ge}from"./square-pen-BXz0dBaO.js";import{C as et}from"./chevron-left-CG0IIGB9.js";import"./circle-x-ya5U_PzQ.js";const tt={class:"space-y-4"},st={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},rt={class:"flex items-center gap-3"},ot={class:"p-2 bg-blue-600 rounded-lg"},at={class:"px-4 sm:px-6 py-4"},nt={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},it={class:"space-y-2"},lt={key:0,class:"text-sm text-red-600"},dt={class:"space-y-2"},ut={key:0,class:"text-sm text-red-600"},ct={key:1,class:"text-sm text-muted-foreground"},_t={class:"space-y-2"},mt={key:0,class:"text-sm text-red-600"},ft={class:"space-y-2 md:col-span-3"},pt={key:0,class:"text-sm text-red-600"},vt={class:"space-y-2 md:col-span-3"},bt={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},yt={class:"flex items-center gap-3"},gt={class:"p-2 bg-green-600 rounded-lg"},ht={class:"px-4 sm:px-6 py-4"},xt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},kt={class:"space-y-2"},wt={key:0,class:"p-4 text-center text-gray-500"},St={key:1,class:"p-4 text-center text-gray-500"},Ct={key:0,class:"text-sm text-red-600"},qt={class:"space-y-2"},It={class:"space-y-2"},Nt={class:"space-y-2"},$t={key:0,class:"text-sm text-red-600"},Et={class:"flex justify-end mt-4"},Vt={key:1,class:"text-sm text-muted-foreground mt-2"},Dt={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},Ot={class:"flex items-center gap-3"},At={class:"p-2 bg-purple-600 rounded-lg"},jt={class:"text-lg font-semibold text-gray-900"},Tt={class:"p-4 sm:p-6 space-y-4"},Ut={class:"flex flex-col gap-3"},Ft={class:"relative"},Mt={class:"flex flex-wrap gap-2"},Lt={class:"flex items-center gap-2"},Qt={class:"font-bold text-lg"},Pt={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 text-sm text-gray-600"},Bt={class:"flex items-center gap-2"},Rt={class:"block md:hidden space-y-2"},zt={class:"flex items-start justify-between mb-2"},Yt={class:"flex-1"},Gt={class:"font-medium text-gray-900"},Ht=["onClick"],Wt={class:"grid grid-cols-2 gap-2 text-sm"},Xt={class:"mt-1 flex items-center gap-1"},Jt={class:"font-medium"},Kt=["onClick"],Zt={class:"mt-1"},es={class:"mt-2 pt-2 border-t border-gray-100"},ts=["onClick"],ss={key:0,class:"text-center py-8 text-gray-500"},rs={class:"hidden md:block"},os={class:"overflow-x-auto border border-gray-200 rounded-lg"},as={class:"w-full text-sm"},ns={class:"divide-y divide-gray-200"},is={class:"px-4 py-3 text-gray-900"},ls={class:"font-medium"},ds={class:"px-4 py-3 text-center"},us={class:"flex items-center justify-center gap-2"},cs={class:"font-medium"},_s=["onClick"],ms={key:0,class:"text-xs text-red-600 text-center"},fs={key:1,class:"text-xs text-red-600 text-center"},ps={class:"px-4 py-3 text-gray-900"},vs={class:"px-4 py-3 text-center"},bs={class:"flex justify-center gap-1"},ys=["onClick"],gs=["onClick"],hs={key:0},xs={colspan:"4",class:"px-4 py-8 text-center text-gray-500"},ks={class:"flex flex-col items-center"},ws={key:0,class:"flex flex-col sm:flex-row items-center justify-between gap-3 pt-4 border-t border-gray-200"},Ss={class:"text-sm text-gray-700"},Cs={class:"flex items-center gap-1"},qs=["disabled"],Is=["onClick","disabled"],Ns=["disabled"],$s={key:1,class:"mt-4"},Es={class:"flex flex-col sm:flex-row gap-3 justify-end pt-4 border-t border-gray-200"},Vs={class:"flex gap-2"},Ds={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Os={class:"grid gap-4 py-4"},As={class:"grid grid-cols-4 items-center gap-4"},js={__name:"Edit",props:{branches:Array,items:Array,user_store_branch_id:Number,order:Object},setup(he){var oe,ae,ne,ie,le;const u=he,ee=Te(),{toast:f}=Xe(),n=de({store_branch_id:(oe=u.order)!=null&&oe.store_branch_id?Number(u.order.store_branch_id):u.user_store_branch_id,sending_store_branch_id:(ae=u.order)!=null&&ae.sending_store_branch_id?Number(u.order.sending_store_branch_id):null,transfer_date:(ne=u.order)!=null&&ne.order_date?new Date(u.order.order_date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],interco_reason:((ie=u.order)==null?void 0:ie.interco_reason)||"",remarks:((le=u.order)==null?void 0:le.remarks)||"",items:[]});Ue(()=>{u.order&&ue(()=>{if(u.order.sending_store_branch_id){const s=Number(u.order.sending_store_branch_id);n.sending_store_branch_id=s,ue(()=>{if(u.order.store_branch_id){const e=Number(u.order.store_branch_id);n.store_branch_id=e}u.order.order_date&&(n.transfer_date=new Date(u.order.order_date).toISOString().split("T")[0]),u.order.interco_reason&&(n.interco_reason=u.order.interco_reason),u.order.remarks&&(n.remarks=u.order.remarks),N.value&&N.value.length>0&&Ae()})}}),u.order&&u.order.store_order_items&&(_.value=u.order.store_order_items.map(s=>{var e,d,t,i;return{id:Date.now()+Math.random(),original_id:s.id,item_code:String(((e=s.sapMasterfile)==null?void 0:e.ItemCode)||s.item_code),description:((d=s.sapMasterfile)==null?void 0:d.ItemDescription)||s.description||"No description",unit_of_measurement:String(s.uom||"PCS"),alt_uom:String(((t=s.sapMasterfile)==null?void 0:t.AltUOM)||s.uom||"PCS"),quantity_ordered:parseFloat(Number(s.quantity_ordered||0)),cost_per_quantity:Number(s.cost_per_quantity||0),uom:((i=s.sapMasterfile)==null?void 0:i.BaseUOM)||s.uom||"PCS",stock:0,total_cost:parseFloat((Number(s.quantity_ordered||0)*Number(s.cost_per_quantity||0)).toFixed(2)),remarks:s.remarks||""}}),Oe(),n.sending_store_branch_id&&se(n.sending_store_branch_id))});const _=x([]);x(null),x(!1),x(null),x([]),x([]);const g=x({}),E=x(!1),U=x(null),V=x(!1),O=x([]),a=Fe({id:null,inventory_code:null,name:null,description:null,unit_of_measurement:null,base_uom:null,base_qty:null,quantity:null,cost:null,total_cost:null,uom:null}),S=de({item:null}),{options:N}=Je(u.branches),{isEditQuantityModalOpen:L,formQuantity:q,openEditQuantityModal:xe}=Ke(n,_,null),D=x({transferDetails:!0,addItem:!0,items:!0}),Y=s=>{D.value[s]=!D.value[s]},Q=x(""),C=x(1),k=x(10),j=w(()=>{if(!Q.value)return _.value;const s=Q.value.toLowerCase();return _.value.filter(e=>e.description.toLowerCase().includes(s)||e.item_code.toLowerCase().includes(s)||e.uom&&e.uom.toLowerCase().includes(s))}),te=w(()=>Math.ceil(j.value.length/k.value)),P=w(()=>{const s=(C.value-1)*k.value,e=s+k.value;return j.value.slice(s,e)}),ke=w(()=>{const s=te.value,e=C.value,d=2,t=[];for(let i=Math.max(2,e-d);i<=Math.min(s-1,e+d);i++)t.push(i);return e-d>2&&t.unshift("..."),e+d<s-1&&t.push("..."),s>1&&t.unshift(1),s>1&&s!==1&&t.push(s),t.filter(i=>i!=="..."||t.indexOf(i)===t.lastIndexOf(i))});w(()=>u.branches.find(s=>s.id===n.sending_store_branch_id)),w(()=>u.branches.find(s=>s.id===n.store_branch_id));const we=w(()=>_.value.reduce((s,e)=>s+(e.quantity_ordered||0),0));w(()=>_.value.reduce((s,e)=>s+(e.quantity_ordered||0)*(e.cost_per_quantity||0),0)),w(()=>n.sending_store_branch_id&&n.store_branch_id&&n.sending_store_branch_id!==n.store_branch_id);const Se=w(()=>n.sending_store_branch_id&&n.store_branch_id&&n.sending_store_branch_id!==n.store_branch_id),Ce=w(()=>{if(!n.sending_store_branch_id)return[];const s=N.value.filter(e=>e.value!==n.sending_store_branch_id);if(n.store_branch_id&&!s.some(e=>e.value===n.store_branch_id)){const e=N.value.find(d=>d.value===n.store_branch_id);e&&s.push(e)}return s}),qe=w(()=>!n.sending_store_branch_id),se=async s=>{if(!s){O.value=[];return}V.value=!0;try{const d=(await G.get(route("interco.get-available-items",{sending_store_id:s}))).data.items.filter(t=>t&&t.item_code&&t.item_code.trim()!==""&&t.alt_uom&&t.alt_uom.trim()!=="");O.value=d.map(t=>{const i={value:`${t.item_code}|${t.alt_uom}`,label:`${t.item_code} - ${t.description} (${t.alt_uom})`,_originalData:{item_code:t.item_code,description:t.description,alt_uom:t.alt_uom,uom:t.uom,cost_per_quantity:t.cost_per_quantity}};return t.item_code==="916A2C"&&console.log("ðŸ” DEBUG: Processing 916A2C in fetchSendingStoreItems:",{item_code:t.item_code,description:t.description,alt_uom:t.alt_uom,final_label:i.label,original_data_description:i._originalData.description}),i}),_.value.forEach(t=>{const i=d.find(c=>c.item_code===t.item_code&&c.alt_uom===(t.alt_uom||t.uom));i&&i.description&&i.description!==t.description&&(Object.assign(t,{description:i.description}),t.item_code==="916A2C"&&console.log("ðŸŽ¯ DEBUG: Reactively updated 916A2C item description:",{item_code:t.item_code,old_description:t.description,new_description:i.description,matched_uom:t.alt_uom||t.uom}))}),_.value=[..._.value]}catch{f.add({severity:"error",summary:"Error",detail:"Failed to load items for the selected sending store.",life:5e3}),O.value=[]}finally{V.value=!1}},Ie=()=>{if(S.clearErrors(),!S.item){S.setError("item","Item field is required");return}if(isNaN(Number(a.quantity))||Number(a.quantity)<1){S.setError("quantity","Quantity must be at least 1 and a valid number");return}if(a.cost===null||Number(a.cost)===0){f.add({severity:"error",summary:"Validation Error",detail:"Item cost cannot be zero or empty.",life:5e3});return}const s=[];if(a.inventory_code||s.push("Item code is missing"),a.unit_of_measurement||s.push("UOM is missing"),(!a.quantity||Number(a.quantity)<1)&&s.push("Valid quantity is required"),(a.cost===null||isNaN(Number(a.cost)))&&s.push("Item cost is invalid"),a.description||(a.description="No description"),s.length>0){f.add({severity:"error",summary:"Validation Error",detail:s.join("; "),life:5e3});return}const e=_.value.findIndex(i=>i.item_code===a.inventory_code),d=Number(a.quantity),t=Number(a.cost);if(e!==-1){const i=_.value[e],c=i.quantity_ordered+d,T=parseFloat((c*t).toFixed(2));i.quantity_ordered=c,i.total_cost=T,i.stock===void 0&&a.stock!==void 0&&(i.stock=a.stock)}else{const i={id:Date.now(),item_code:String(a.inventory_code),description:a.description||"No description",unit_of_measurement:a.unit_of_measurement,alt_uom:a.unit_of_measurement,quantity_ordered:parseFloat(Number(a.quantity).toFixed(2)),cost_per_quantity:Number(a.cost),uom:a.uom,stock:a.stock||0,total_cost:parseFloat((Number(a.quantity)*Number(a.cost)).toFixed(2))};_.value.push(i)}Object.keys(a).forEach(i=>{a[i]=null}),U.value=null,f.add({severity:"success",summary:"Success",detail:"Item added successfully.",life:5e3}),S.item=null,S.clearErrors()},re=s=>{_.value.splice(s,1)},B=(s,e)=>{xe(s.id,s.quantity_ordered)},Ne=()=>{let s=_.value.findIndex(e=>e.id===q.id);if(s===-1&&(s=_.value.findIndex(e=>e.item_code===q.item_code||e.description===q.description)),s!==-1){const e=Number(q.quantity),d=_.value[s];if(isNaN(e)||e<=0){q.errors.quantity="Quantity must be a positive number.",f.add({severity:"error",summary:"Validation Error",detail:"Quantity must be a positive number.",life:3e3});return}const t=Number(d.cost_per_quantity);if(isNaN(t)){f.add({severity:"error",summary:"Calculation Error",detail:"Item cost is invalid. Cannot update total cost.",life:3e3});return}d.quantity_ordered=parseFloat(e.toFixed(2)),d.total_cost=parseFloat((e*t).toFixed(2)),_.value=[..._.value],f.add({severity:"success",summary:"Success",detail:"Quantity Updated.",life:3e3}),L.value=!1}else f.add({severity:"error",summary:"Error",detail:`Item not found in transfer list. Looking for ID: ${q.id}, Item Code: ${q.item_code}, Description: ${q.description}`,life:5e3})},$e=()=>{const s={};return n.sending_store_branch_id||(s.sending_store_branch_id="Sending store is required"),n.store_branch_id||(s.store_branch_id="Receiving store is required"),n.sending_store_branch_id===n.store_branch_id&&(s.store_selection="Sending and receiving stores must be different"),n.transfer_date||(s.transfer_date="Transfer date is required"),(!n.interco_reason||!n.interco_reason.trim())&&(s.interco_reason="Reason for transfer is required"),_.value.length===0&&(s.items="At least one item is required"),_.value.forEach((e,d)=>{(!e.quantity_ordered||e.quantity_ordered<1)&&(s[`item_${d}_quantity`]="Quantity must be at least 1"),e.quantity_ordered>(e.stock||0)&&(s[`item_${d}_stock`]=`Insufficient stock. Only ${e.stock||0} available`)}),g.value=s,Object.keys(s).length===0},Ee=()=>{if(!$e()){f.add({severity:"error",summary:"Validation Error",detail:"Please fix all validation errors before submitting.",life:5e3});return}if(_.value.length===0){f.add({severity:"error",summary:"No Items",detail:"Please add at least one item to the transfer before submitting.",life:5e3});return}ee.require({message:"Are you sure you want to update this interco transfer?",header:"Confirm Interco Transfer Update",icon:"pi pi-exclamation-triangle",rejectClass:"p-button-danger",rejectLabel:"No",acceptLabel:"Yes",acceptClass:"p-button-success",accept:()=>{Ve()},reject:()=>{f.add({severity:"info",summary:"Cancelled",detail:"Interco transfer update was cancelled.",life:3e3})}})},Ve=()=>{const s={store_branch_id:n.store_branch_id,sending_store_branch_id:n.sending_store_branch_id,transfer_date:n.transfer_date,interco_reason:n.interco_reason,remarks:n.remarks||"",items:_.value.map((e,d)=>({id:e.original_id||null,item_code:String(e.item_code),quantity_ordered:parseInt(Number(e.quantity_ordered)),cost_per_quantity:Number(e.cost_per_quantity||1),uom:String(e.unit_of_measurement||e.uom||"PCS"),remarks:e.remarks||""}))};E.value=!0,me.put(route("interco.update",u.order.id),s,{onSuccess:e=>{E.value=!1,f.add({severity:"success",summary:"Success",detail:"Interco transfer request updated successfully!",life:5e3})},onError:e=>{if(g.value=e,e.error)f.add({severity:"error",summary:"Submission Failed",detail:e.error,life:8e3});else if(e.items)f.add({severity:"error",summary:"Item Validation Error",detail:`Issue with items: ${e.items}`,life:8e3});else if(e.store_branch_id)f.add({severity:"error",summary:"Store Selection Error",detail:`Receiving store: ${e.store_branch_id}`,life:8e3});else if(e.sending_store_branch_id)f.add({severity:"error",summary:"Store Selection Error",detail:`Sending store: ${e.sending_store_branch_id}`,life:8e3});else{const d=Object.entries(e).map(([t,i])=>`${t}: ${i}`).join("; ");f.add({severity:"error",summary:"Validation Failed",detail:d,life:1e4})}E.value=!1},onCancel:()=>{E.value=!1},onFinish:()=>{E.value=!1},preserveState:!0,preserveScroll:!0})},De=()=>{try{if(_.value.length===0){f.add({severity:"info",summary:"Info",detail:"No items to clear.",life:3e3});return}ee.require({message:"Are you sure you want to remove ALL items from the transfer?",header:"Confirm Clear All",icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined",rejectLabel:"Cancel",acceptLabel:"Clear All",acceptClass:"p-button-danger",accept:()=>{_.value=[],f.add({severity:"success",summary:"Success",detail:"All items have been removed from the transfer.",life:3e3})},reject:()=>{}})}catch{window.confirm("Are you sure you want to remove ALL items from the transfer?")&&(_.value=[])}},Oe=async()=>{if(!(!n.sending_store_branch_id||_.value.length===0))try{const s=_.value.map(d=>d.item_code).filter(d=>d).join(",");if(!s)return;const e=await G.get("/interco/branch-inventory",{params:{branch_id:n.sending_store_branch_id,item_codes:s}});if(e.data&&e.data.items){const d=e.data.items;_.value.forEach(t=>{const i=d.find(c=>c.item_code===t.item_code||c.ItemCode===t.item_code);i?t.stock=parseFloat(i.quantity||i.Quantity||0):t.stock=0})}else _.value.forEach(d=>{d.stock=0})}catch(s){s.response&&s.response.status===405?f.add({severity:"warn",summary:"Stock Data Unavailable",detail:"Unable to fetch current stock levels. Using default values.",life:5e3}):s.response&&s.response.status===403?f.add({severity:"warn",summary:"Access Restricted",detail:"You don't have permission to view stock levels for this branch.",life:5e3}):f.add({severity:"error",summary:"Stock Data Error",detail:"Failed to load stock information. Items will show 0 stock.",life:5e3}),_.value.forEach(e=>{e.stock=0})}},Ae=()=>{const s=[];if(u.order){if(u.order.sending_store_branch_id||s.push("Sending store ID is missing from order data"),u.order.store_branch_id||s.push("Receiving store ID is missing from order data"),u.order.sending_store_branch_id===u.order.store_branch_id&&s.push("Sending and receiving stores cannot be the same"),!u.order.order_date)s.push("Order date is missing from order data");else{const e=new Date(u.order.order_date);isNaN(e.getTime())&&s.push("Order date is invalid")}if(!(!N.value||N.value.length===0)){{const e=N.value.some(t=>t.value===n.sending_store_branch_id),d=N.value.some(t=>t.value===n.store_branch_id);!e&&u.order.sending_store_branch_id&&s.push(`You may not have permission to access sending store ${u.order.sending_store_branch_id}`),!d&&u.order.store_branch_id&&s.push(`You may not have permission to access receiving store ${u.order.store_branch_id}`)}if(s.length>0){const e=s.filter(d=>d.includes("missing")||d.includes("invalid")||d.includes("same"));e.length>0&&f.add({severity:"warn",summary:"Data Quality Warning",detail:`Some data may need attention: ${e.slice(0,2).join(", ")}`,life:6e3})}}}};return ce(()=>n.sending_store_branch_id,s=>{s?(_.value=_.value.filter(e=>e.stock>0),se(s)):O.value=[],U.value=null,Object.keys(a).forEach(e=>{a[e]=null}),n.store_branch_id===s&&(n.store_branch_id=null)}),ce(U,async s=>{if(s){V.value=!0,S.item=s;const[e,d]=s.split("|");try{const t=n.sending_store_branch_id;if(!t){f.add({severity:"error",summary:"Error",detail:"Failed to determine sending store.",life:5e3}),V.value=!1;return}const c=(await G.get(route("interco.get-item-details",{itemCode:e,altUOM:d,sendingStoreId:t}))).data.item;if(c)a.inventory_code=String(c.item_code),a.description=c.description||"No description",a.unit_of_measurement=c.alt_uom||c.uom,a.cost=Number(c.cost_per_quantity),a.uom=c.uom,a.stock=c.stock||0,e==="916A2C"&&console.log("ðŸŽ¯ DEBUG: 916A2C API success - Product details updated:",{inventory_code:a.inventory_code,description:a.description,unit_of_measurement:a.unit_of_measurement,stock:a.stock,original_api_description:c.description,fallback_used:c.description===null||c.description===void 0});else{const T=O.value.find($=>$.value===s);if(T&&T._originalData){const $=T._originalData;a.inventory_code=String($.item_code),a.description=$.description||"No description",a.unit_of_measurement=$.alt_uom||$.uom,a.cost=Number($.cost_per_quantity||0),a.uom=$.uom,a.stock=0,e==="916A2C"&&console.log("ðŸŽ¯ DEBUG: 916A2C fallback - Product details set:",{inventory_code:a.inventory_code,description:a.description,unit_of_measurement:a.unit_of_measurement,original_fallback_description:$.description,selected_option_label:T.label})}else f.add({severity:"error",summary:"Error",detail:"Item details not found.",life:5e3})}}catch{const i=O.value.find(c=>c.value===s);if(i&&i._originalData){const c=i._originalData;a.inventory_code=String(c.item_code),a.description=c.description||"No description",a.unit_of_measurement=c.alt_uom||c.uom,a.cost=Number(c.cost_per_quantity||0),a.uom=c.uom,a.stock=0,console.log("âœ… DEBUG: Catch fallback product details set:",{inventory_code:a.inventory_code,description:a.description})}else f.add({severity:"error",summary:"Error",detail:"Failed to load item details.",life:5e3})}finally{V.value=!1}}else Object.keys(a).forEach(e=>{a[e]=null})},{deep:!0}),(s,e)=>{const d=Me("Layout");return v(),_e(d,{heading:"Edit Store Transfer"},{"header-actions":m(()=>[l(o(F),{variant:"outline",onClick:e[0]||(e[0]=t=>o(me).get(s.route("interco.index")))},{default:m(()=>[l(o(Ze),{class:"w-4 h-4 mr-2"}),e[20]||(e[20]=y(" Back to Transfers "))]),_:1})]),default:m(()=>[r("div",tt,[r("div",st,[r("button",{onClick:e[1]||(e[1]=t=>Y("transferDetails")),class:"w-full px-4 sm:px-6 py-4 bg-gradient-to-r from-blue-50 to-blue-100 border-b border-blue-200 flex items-center justify-between text-left hover:from-blue-100 hover:to-blue-200 transition-colors"},[r("div",rt,[r("div",ot,[l(o(z),{class:"w-5 h-5 text-white"})]),e[21]||(e[21]=r("div",null,[r("h2",{class:"text-lg font-semibold text-gray-900"},"Transfer Details"),r("p",{class:"text-sm text-gray-600"},"Basic transfer information")],-1))]),l(o(H),{class:A(["w-5 h-5 text-gray-600 transition-transform duration-200",{"rotate-180":D.value.transferDetails}])},null,8,["class"])]),R(r("div",at,[r("div",nt,[r("div",it,[l(o(I),{for:"sending_store"},{default:m(()=>e[22]||(e[22]=[y("Sending Store *")])),_:1}),l(o(X),{filter:"",placeholder:"Select sending store",modelValue:o(n).sending_store_branch_id,"onUpdate:modelValue":e[2]||(e[2]=t=>o(n).sending_store_branch_id=t),options:o(N),optionLabel:"label",optionValue:"value",class:"w-full"},null,8,["modelValue","options"]),g.value.sending_store_branch_id?(v(),b("p",lt,p(g.value.sending_store_branch_id),1)):h("",!0)]),r("div",dt,[l(o(I),{for:"receiving_store"},{default:m(()=>e[23]||(e[23]=[y("Receiving Store *")])),_:1}),l(o(X),{filter:"",placeholder:"Select receiving store",modelValue:o(n).store_branch_id,"onUpdate:modelValue":e[3]||(e[3]=t=>o(n).store_branch_id=t),options:Ce.value,disabled:qe.value,optionLabel:"label",optionValue:"value",class:"w-full"},null,8,["modelValue","options","disabled"]),g.value.store_branch_id?(v(),b("p",ut,p(g.value.store_branch_id),1)):h("",!0),o(n).sending_store_branch_id?h("",!0):(v(),b("p",ct," Select a sending store first "))]),r("div",_t,[l(o(I),{for:"transfer_date"},{default:m(()=>e[24]||(e[24]=[y("Transfer Date")])),_:1}),l(o(M),{id:"transfer_date",type:"date",modelValue:o(n).transfer_date,"onUpdate:modelValue":e[4]||(e[4]=t=>o(n).transfer_date=t),class:"w-full"},null,8,["modelValue"]),g.value.transfer_date?(v(),b("p",mt,p(g.value.transfer_date),1)):h("",!0)]),r("div",ft,[l(o(I),{for:"reason"},{default:m(()=>e[25]||(e[25]=[y("Reason for Transfer *")])),_:1}),l(o(fe),{id:"reason",modelValue:o(n).interco_reason,"onUpdate:modelValue":e[5]||(e[5]=t=>o(n).interco_reason=t),placeholder:"Explain why this transfer is needed...",rows:"3"},null,8,["modelValue"]),g.value.interco_reason?(v(),b("p",pt,p(g.value.interco_reason),1)):h("",!0)]),r("div",vt,[l(o(I),{for:"remarks"},{default:m(()=>e[26]||(e[26]=[y("Remarks (Optional)")])),_:1}),l(o(fe),{id:"remarks",modelValue:o(n).remarks,"onUpdate:modelValue":e[6]||(e[6]=t=>o(n).remarks=t),placeholder:"Additional notes or instructions...",rows:"2"},null,8,["modelValue"])])])],512),[[W,D.value.transferDetails]])]),r("div",bt,[r("button",{onClick:e[7]||(e[7]=t=>Y("addItem")),class:"w-full px-4 sm:px-6 py-4 bg-gradient-to-r from-green-50 to-green-100 border-b border-green-200 flex items-center justify-between text-left hover:from-green-100 hover:to-green-200 transition-colors"},[r("div",yt,[r("div",gt,[l(o(Le),{class:"w-5 h-5 text-white"})]),e[27]||(e[27]=r("div",null,[r("h3",{class:"text-lg font-semibold text-gray-900"},"Add Items"),r("p",{class:"text-sm text-gray-600"},"Add items to your transfer")],-1))]),l(o(H),{class:A(["w-5 h-5 text-gray-600 transition-transform duration-200",{"rotate-180":D.value.addItem}])},null,8,["class"])]),R(r("div",ht,[g.value.store_selection?(v(),_e(o(pe),{key:0,class:"mb-4"},{default:m(()=>[l(o(ye),{class:"w-4 h-4"}),l(o(ve),null,{default:m(()=>[y(p(g.value.store_selection),1)]),_:1})]),_:1})):h("",!0),r("div",xt,[r("div",kt,[l(o(I),{class:"text-sm font-medium text-gray-700"},{default:m(()=>e[28]||(e[28]=[y("Item")])),_:1}),l(o(X),{filter:"",placeholder:"Select an Item",modelValue:U.value,"onUpdate:modelValue":e[8]||(e[8]=t=>U.value=t),options:O.value,optionLabel:"label",optionValue:"value",disabled:!o(n).sending_store_branch_id||V.value,class:"w-full"},{empty:m(()=>[V.value?(v(),b("div",wt," Loading items... ")):(v(),b("div",St," No items available for this sending store. "))]),_:1},8,["modelValue","options","disabled"]),o(S).errors.item?(v(),b("p",Ct,p(o(S).errors.item),1)):h("",!0)]),r("div",qt,[l(o(I),{class:"text-sm font-medium text-gray-700"},{default:m(()=>e[29]||(e[29]=[y("UOM")])),_:1}),l(o(M),{type:"text",disabled:"",modelValue:a.unit_of_measurement,"onUpdate:modelValue":e[9]||(e[9]=t=>a.unit_of_measurement=t),class:"flex h-10 w-full rounded-md border border-gray-300 bg-gray-50 px-3 py-2 text-sm"},null,8,["modelValue"])]),r("div",It,[l(o(I),{class:"text-sm font-medium text-gray-700"},{default:m(()=>e[30]||(e[30]=[y("SOH Stock")])),_:1}),l(o(M),{type:"text",disabled:"",value:a.stock||0,class:"flex h-10 w-full rounded-md border border-gray-300 bg-gray-50 px-3 py-2 text-sm"},null,8,["value"])]),r("div",Nt,[l(o(I),{class:"text-sm font-medium text-gray-700"},{default:m(()=>e[31]||(e[31]=[y("Quantity")])),_:1}),l(o(M),{type:"number",modelValue:a.quantity,"onUpdate:modelValue":e[10]||(e[10]=t=>a.quantity=t),class:"flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm"},null,8,["modelValue"]),o(S).errors.quantity?(v(),b("p",$t,p(o(S).errors.quantity),1)):h("",!0)])]),r("div",Et,[l(o(F),{onClick:Ie,disabled:V.value||!o(n).sending_store_branch_id},{default:m(()=>e[32]||(e[32]=[y(" Add to Transfer ")])),_:1},8,["disabled"])]),o(n).sending_store_branch_id?h("",!0):(v(),b("p",Vt," Select a sending store to add items "))],512),[[W,D.value.addItem]])]),r("div",Dt,[r("button",{onClick:e[11]||(e[11]=t=>Y("items")),class:"w-full px-4 sm:px-6 py-4 bg-gradient-to-r from-purple-50 to-purple-100 border-b border-purple-200 flex items-center justify-between text-left hover:from-purple-100 hover:to-purple-200 transition-colors"},[r("div",Ot,[r("div",At,[l(o(z),{class:"w-5 h-5 text-white"})]),r("div",null,[r("h3",jt,"Transfer Items ("+p(_.value.length)+")",1),e[33]||(e[33]=r("p",{class:"text-sm text-gray-600"},"Manage your transfer items and quantities",-1))])]),l(o(H),{class:A(["w-5 h-5 text-gray-600 transition-transform duration-200",{"rotate-180":D.value.items}])},null,8,["class"])]),R(r("div",Tt,[r("div",Ut,[r("div",Ft,[R(r("input",{type:"text","onUpdate:modelValue":e[12]||(e[12]=t=>Q.value=t),placeholder:"Search items by code or description...",class:"w-full h-10 pl-10 pr-4 rounded-md border border-gray-300 bg-white text-sm shadow-sm transition-colors placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500"},null,512),[[Qe,Q.value]]),e[34]||(e[34]=r("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1))]),r("div",Mt,[r("div",Lt,[e[35]||(e[35]=r("span",{class:"text-sm text-gray-600"},"Total Quantity:",-1)),r("span",Qt,p(we.value),1)])])]),r("div",Pt,[r("span",null,p(j.value.length)+" items found",1),r("div",Bt,[e[36]||(e[36]=r("span",null,"Items per page:",-1)),r("button",{onClick:e[13]||(e[13]=t=>k.value=10),class:A(["px-2 py-1 rounded text-xs font-medium transition-colors",k.value===10?"bg-blue-100 text-blue-700":"text-gray-500 hover:text-gray-700"])}," 10 ",2),r("button",{onClick:e[14]||(e[14]=t=>k.value=25),class:A(["px-2 py-1 rounded text-xs font-medium transition-colors",k.value===25?"bg-blue-100 text-blue-700":"text-gray-500 hover:text-gray-700"])}," 25 ",2),r("button",{onClick:e[15]||(e[15]=t=>k.value=50),class:A(["px-2 py-1 rounded text-xs font-medium transition-colors",k.value===50?"bg-blue-100 text-blue-700":"text-gray-500 hover:text-gray-700"])}," 50 ",2)])]),r("div",Rt,[(v(!0),b(Z,null,J(P.value,(t,i)=>(v(),b("div",{key:t.id,class:"bg-white border border-gray-200 rounded-lg p-3 hover:shadow-md transition-shadow"},[r("div",zt,[r("div",Yt,[r("div",Gt,p(t.item_code)+" - "+p(t.description)+" ("+p(t.alt_uom||t.uom)+")",1)]),r("button",{onClick:c=>re(i),class:"h-8 w-8 p-0 hover:bg-red-50 hover:text-red-600 hover:border-red-300 flex-shrink-0 ml-2 rounded-md border border-gray-300"},[l(o(K),{class:"w-4 h-4"})],8,Ht)]),r("div",Wt,[r("div",null,[e[37]||(e[37]=r("span",{class:"text-gray-600"},"Quantity:",-1)),r("div",Xt,[r("span",Jt,p(t.quantity_ordered),1),r("button",{onClick:c=>B(t,i),class:"text-blue-600 hover:text-blue-800"},[l(o(ge),{class:"w-3 h-3"})],8,Kt)])]),r("div",null,[e[38]||(e[38]=r("span",{class:"text-gray-600"},"SOH Stock:",-1)),r("div",Zt,[l(be,{available:Number(t.stock||0),requested:t.quantity_ordered,size:"small"},null,8,["available","requested"])])])]),r("div",es,[r("button",{onClick:c=>B(t,i),class:"w-full text-sm text-blue-600 hover:text-blue-800 font-medium"}," Edit Quantity ",8,ts)])]))),128)),P.value.length===0?(v(),b("div",ss,[l(o(z),{class:"w-12 h-12 text-gray-400 mx-auto mb-2"}),e[39]||(e[39]=r("p",null,"No items found. Try searching or add items manually.",-1))])):h("",!0)]),r("div",rs,[r("div",os,[r("table",as,[e[41]||(e[41]=r("thead",{class:"bg-gray-50 border-b border-gray-200"},[r("tr",null,[r("th",{class:"px-4 py-3 text-left font-medium text-gray-900"},"Description"),r("th",{class:"px-4 py-3 text-center font-medium text-gray-900"},"Quantity"),r("th",{class:"px-4 py-3 text-left font-medium text-gray-900"},"SOH Stock"),r("th",{class:"px-4 py-3 text-center font-medium text-gray-900"},"Actions")])],-1)),r("tbody",ns,[(v(!0),b(Z,null,J(P.value,(t,i)=>(v(),b("tr",{key:t.id,class:"hover:bg-gray-50"},[r("td",is,[r("div",null,[r("p",ls,p(t.item_code)+" - "+p(t.description)+" ("+p(t.alt_uom||t.uom)+")",1)])]),r("td",ds,[r("div",us,[r("span",cs,p(t.quantity_ordered),1),r("button",{onClick:c=>B(t,i),class:"text-blue-600 hover:text-blue-800"},[l(o(ge),{class:"w-3 h-3"})],8,_s)]),g.value[`item_${i}_quantity`]?(v(),b("p",ms,p(g.value[`item_${i}_quantity`]),1)):h("",!0),g.value[`item_${i}_stock`]?(v(),b("p",fs,p(g.value[`item_${i}_stock`]),1)):h("",!0)]),r("td",ps,[l(be,{available:Number(t.stock||0),requested:t.quantity_ordered,size:"small"},null,8,["available","requested"])]),r("td",vs,[r("div",bs,[r("button",{onClick:c=>B(t,i),class:"text-blue-600 hover:text-blue-800 text-sm font-medium"}," Edit ",8,ys),r("button",{onClick:c=>re(i),class:"text-red-600 hover:text-red-800"},[l(o(K),{class:"w-4 h-4"})],8,gs)])])]))),128)),P.value.length===0?(v(),b("tr",hs,[r("td",xs,[r("div",ks,[l(o(z),{class:"w-12 h-12 text-gray-400 mb-2"}),e[40]||(e[40]=r("p",null,"No items found. Try searching or add items manually.",-1))])])])):h("",!0)])])])]),j.value.length>k.value?(v(),b("div",ws,[r("div",Ss," Showing "+p((C.value-1)*k.value+1)+" to "+p(Math.min(C.value*k.value,j.value.length))+" of "+p(j.value.length)+" items ",1),r("div",Cs,[r("button",{onClick:e[16]||(e[16]=t=>C.value--),disabled:C.value===1,class:"h-8 w-8 p-0 rounded-md border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},[l(o(et),{class:"w-4 h-4"})],8,qs),(v(!0),b(Z,null,J(ke.value,t=>(v(),b("button",{key:t,onClick:i=>C.value=t==="..."?null:C.value=t,disabled:t==="...",class:A(["h-8 w-8 p-0 rounded-md text-sm font-medium transition-colors",C.value===t?"bg-blue-600 text-white":t==="..."?"text-gray-500 cursor-default":"border border-gray-300 hover:bg-gray-50"])},p(t),11,Is))),128)),r("button",{onClick:e[17]||(e[17]=t=>C.value++),disabled:C.value===te.value,class:"h-8 w-8 p-0 rounded-md border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},[l(o(Pe),{class:"w-4 h-4"})],8,Ns)])])):h("",!0),g.value.items?(v(),b("div",$s,[l(o(pe),{variant:"destructive"},{default:m(()=>[l(o(ye),{class:"w-4 h-4"}),l(o(ve),null,{default:m(()=>[y(p(g.value.items),1)]),_:1})]),_:1})])):h("",!0),r("div",Es,[r("div",Vs,[l(o(F),{onClick:De,variant:"outline",class:"text-red-600 hover:text-red-700 hover:bg-red-50",disabled:_.value.length===0},{default:m(()=>[l(o(K),{class:"w-4 h-4 mr-2"}),e[42]||(e[42]=y(" Clear All "))]),_:1},8,["disabled"])]),l(o(F),{onClick:Ee,disabled:E.value||!Se.value,class:"min-w-[120px]"},{default:m(()=>[E.value?(v(),b("svg",Ds,e[43]||(e[43]=[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):h("",!0),y(" "+p(E.value?"Updating...":"Update Transfer"),1)]),_:1},8,["disabled"])])],512),[[W,D.value.items]])])]),l(o(We),{open:o(L),"onUpdate:open":e[19]||(e[19]=t=>He(L)?L.value=t:null)},{default:m(()=>[l(o(Be),{class:"sm:max-w-[425px]"},{default:m(()=>[l(o(Re),null,{default:m(()=>[l(o(ze),null,{default:m(()=>e[44]||(e[44]=[y("Edit Quantity")])),_:1}),l(o(Ye),null,{default:m(()=>e[45]||(e[45]=[y(" Make changes to the quantity here. Click save when you're done. ")])),_:1})]),_:1}),r("div",Os,[r("div",As,[l(o(I),{for:"quantity",class:"text-right"},{default:m(()=>e[46]||(e[46]=[y(" Quantity ")])),_:1}),l(o(M),{id:"quantity",type:"number",class:"col-span-3",modelValue:o(q).quantity,"onUpdate:modelValue":e[18]||(e[18]=t=>o(q).quantity=t)},null,8,["modelValue"])])]),l(o(Ge),null,{default:m(()=>[l(o(F),{onClick:Ne},{default:m(()=>e[47]||(e[47]=[y("Save changes")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})}}},Hs=je(js,[["__scopeId","data-v-11b02820"]]);export{Hs as default};
