import{f as Ge,x as C,aW as Ke,T as se,V as Ze,l as A,y as M,aX as et,az as V,r as c,o as F,c as ne,w as o,d as I,g as d,F as Z,e as ee,t as b,h as De,a as t,b as n,u as p,s as ie,m as tt,O as ot,n as Fe,k as ue,ay as de,i as at,N as lt}from"./app-Drfr7wPO.js";import{u as rt}from"./useSelectOptions-BWAyP7Dg.js";import{u as st}from"./useToast-Blb7EynO.js";import{u as nt}from"./useBackButton-CnvTWR2a.js";import{u as it}from"./useEditQuantity-BjinyBMs.js";import{C as ut}from"./calendar-Cjd1rHHD.js";const dt={key:0,class:"mb-4 p-4 rounded-lg bg-yellow-100 text-yellow-800 border border-yellow-200"},mt={class:"list-disc list-inside"},ct={class:"grid sm:grid-cols-3 gap-5 grid-cols-1"},pt={class:"grid gap-5"},ft={class:"flex flex-col space-y-1"},yt={class:"flex flex-col space-y-1"},_t={class:"relative"},bt=["value","disabled"],vt={class:"flex justify-between items-center mb-4"},gt={class:"text-lg font-semibold"},xt={class:"grid grid-cols-7 gap-2"},wt=["onClick"],Ct={class:"flex flex-col space-y-1"},Dt={class:"flex flex-col space-y-1"},Ft={key:0,class:"p-4 text-center text-gray-500"},St={key:1,class:"p-4 text-center text-gray-500"},ht={class:"flex flex-col space-y-1"},qt={class:"flex flex-col space-y-1"},Nt={class:"flex flex-col space-y-1"},It={class:"overflow-x-auto"},kt=["onClick"],Bt=["onClick"],Ot={class:"space-y-5"},Tt={class:"flex flex-col space-y-1"},Et={class:"flex flex-col space-y-1"},Ut={class:"text-xs"},Qt={class:"grid gap-4 py-4"},Mt={class:"grid grid-cols-4 items-center gap-4"},Ht={__name:"Edit",props:{order:{type:Object,required:!0},orderedItems:{type:Object,required:!0},branches:{type:Object,required:!0},suppliers:{type:Object,required:!0},enabledDates:{type:Array,required:!0}},setup(Se){nt(route("mass-orders.index"));const g=Se,H=Ge(),{toast:f}=st(),T=C(null),me=C(null);Ke(()=>{const l=localStorage.getItem("editStoreOrderDraft"),e=localStorage.getItem("previoustoreOrderNumber");l&&(T.value=JSON.parse(l)),e&&(me.value=e)});const Y=C(!1),a=se({supplier_id:g.order.supplier.supplier_code+"",order_date:g.order.order_date,branch_id:g.order.store_branch_id?String(g.order.store_branch_id):null,orders:[]}),te=C([]),z=async l=>{if(!l){J.value=[];return}S.value=!0;try{const e=await V.get(route("store-orders.get-supplier-items",l));J.value=e.data.items}catch{f.add({severity:"error",summary:"Error",detail:"Failed to load items for the selected supplier.",life:5e3}),J.value=[]}finally{S.value=!1}};Ze(()=>{T.value&&me.value===g.order.order_number?H.require({message:"You have an unfinished draft. Would you like to continue where you left off or discard the draft?",header:"Unfinished Draft Detected",icon:"pi pi-exclamation-triangle",rejectProps:{label:"Discard",severity:"danger"},acceptProps:{label:"Continue",severity:"primary"},accept:()=>{a.supplier_id=T.value.supplier_id,a.branch_id=T.value.branch_id,a.order_date=T.value.order_date!==null&&T.value.order_date!==void 0?T.value.order_date:g.order.order_date,a.orders=T.value.orders||[],te.value=a.orders,z(a.supplier_id)},reject:()=>{ce(),z(g.order.supplier.supplier_code)}}):(ce(),z(g.order.supplier.supplier_code)),Y.value=!0});const ce=()=>{const l=[];g.orderedItems.forEach((e,s)=>{let u=1,m=null;const v=e.supplier_item;if(v&&v.sap_master_file){const q=v.sap_master_file;if(Object.prototype.hasOwnProperty.call(q,"BaseQty")){const N=q.BaseQty;u=Number(N),(isNaN(u)||u<=0)&&(u=1),m=q.BaseUOM}}const _=Number(e.quantity_ordered),y=Number(e.cost_per_quantity),x=parseFloat((_*u).toFixed(2)),w=parseFloat((x*y).toFixed(2)),h={id:e.id,inventory_code:String(e.supplier_item.ItemCode),name:e.supplier_item.item_name,unit_of_measurement:e.supplier_item.uom,base_uom:m,base_qty:u,base_uom_qty:x,quantity:_,cost:y,total_cost:w,uom:e.supplier_item.uom};l.push(h)}),a.orders=l,te.value=a.orders},W=C(g.branches),{options:he}=rt(g.suppliers),qe=A(()=>Object.entries(W.value||{}).map(([l,e])=>({value:l,label:e}))),J=C([]),L=C(null),S=C(!1),$=C([]),X=C(!1),oe=C(g.enabledDates),j=C(!1),E=C(new Date(g.order.order_date+"T00:00:00")),ae=C(null),le=C("top-full mt-2");M(j,l=>{if(l&&ae.value){const e=ae.value.getBoundingClientRect(),s=400;window.innerHeight-e.bottom<s&&e.top>s?le.value="bottom-full mb-2":le.value="top-full mt-2"}});const Ne=()=>{const l=[],e=E.value||new Date,s=e.getFullYear(),u=e.getMonth(),m=new Date(s,u,1).getDay(),v=new Date(s,u+1,0).getDate(),_=new Set(oe.value);for(let y=0;y<m;y++)l.push(null);for(let y=1;y<=v;y++){const x=new Date(s,u,y),w=`${x.getFullYear()}-${String(x.getMonth()+1).padStart(2,"0")}-${String(x.getDate()).padStart(2,"0")}`,h=!_.has(w);l.push({day:y,date:x,isDisabled:h})}return l},Ie=()=>E.value=new Date(E.value.getFullYear(),E.value.getMonth()-1,1),ke=()=>E.value=new Date(E.value.getFullYear(),E.value.getMonth()+1,1),Be=l=>{if(l&&!l.isDisabled){const e=l.date,s=e.getFullYear(),u=String(e.getMonth()+1).padStart(2,"0"),m=String(e.getDate()).padStart(2,"0");a.order_date=`${s}-${u}-${m}`,j.value=!1}};M(a,l=>{if(!Y.value)return;const e=JSON.stringify(l);localStorage.setItem("editStoreOrderDraft",e),localStorage.setItem("previoustoreOrderNumber",g.order.order_number)},{deep:!0});const k=se({item:null}),i=et({id:null,inventory_code:null,name:null,unit_of_measurement:null,base_uom:null,base_qty:null,quantity:null,cost:null,total_cost:null,uom:null}),pe=l=>{H.require({message:"Are you sure you want to remove this item from your orders?",header:"Confirmation",icon:"pi pi-exclamation-triangle",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Remove",severity:"danger"},accept:()=>{a.orders=a.orders.filter(e=>e.id!==l),f.add({severity:"success",summary:"Confirmed",detail:"Item Removed",life:3e3})}})},Oe=()=>{H.require({message:"Are you sure you want to remove ALL items from your orders?",header:"Confirmation",icon:"pi pi-exclamation-triangle",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Remove All",severity:"danger"},accept:()=>{a.orders=[],f.add({severity:"success",summary:"Confirmed",detail:"All items removed.",life:3e3})}})},Te=()=>{if(k.clearErrors(),!k.item){k.setError("item","Item field is required");return}if(isNaN(Number(i.quantity))||Number(i.quantity)<.1){k.setError("quantity","Quantity must be at least 0.1 and a valid number");return}if(i.cost===null||Number(i.cost)===0){f.add({severity:"error",summary:"Validation Error",detail:"Item cost cannot be zero or empty.",life:5e3});return}if(!i.inventory_code||!i.name||!i.unit_of_measurement||!i.quantity||i.cost===null){f.add({severity:"error",summary:"Validation Error",detail:"Please ensure all item details are loaded (name, code, UOM, quantity, cost).",life:5e3});return}const l=a.orders.findIndex(m=>m.inventory_code===i.inventory_code),e=Number(i.base_qty)>0?Number(i.base_qty):1,s=Number(i.quantity),u=Number(i.cost);if(l!==-1){const m=a.orders[l],v=m.quantity+s,_=Number(m.base_qty)>0?Number(m.base_qty):1,y=parseFloat((v*_).toFixed(2)),x=parseFloat((y*u).toFixed(2));m.quantity=v,m.base_uom_qty=y,m.total_cost=x}else i.base_uom_qty=parseFloat((s*e).toFixed(2)),i.total_cost=parseFloat((i.base_uom_qty*u).toFixed(2)),a.orders.push({id:null,inventory_code:String(i.inventory_code),name:i.name,unit_of_measurement:i.unit_of_measurement,base_uom:i.base_uom,base_qty:i.base_qty,base_uom_qty:i.base_uom_qty,quantity:parseFloat(Number(i.quantity).toFixed(2)),cost:Number(i.cost),uom:i.uom,total_cost:i.total_cost});Object.keys(i).forEach(m=>{i[m]=null}),L.value=null,f.add({severity:"success",summary:"Success",detail:"Item added successfully.",life:5e3}),k.item=null,k.clearErrors()},Ee=()=>{if(a.orders.length<1){f.add({severity:"error",summary:"Error",detail:"Please select at least one item before proceeding.",life:5e3});return}const l=e=>{if(!e)return null;if(typeof e=="string")return e;const s=new Date(e),u=String(s.getMonth()+1).padStart(2,"0"),m=String(s.getDate()).padStart(2,"0");return`${s.getFullYear()}-${u}-${m}`};a.order_date=l(a.order_date);try{H.require({message:"Are you sure you want to update the order details?",header:"Confirmation",icon:"pi pi-exclamation-triangle",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Confirm",severity:"info"},accept:()=>{a.put(route("mass-orders.update",g.order.order_number),{onSuccess:()=>{f.add({severity:"success",summary:"Success",detail:"Order Updated Successfully.",life:5e3}),localStorage.removeItem("editStoreOrderDraft"),localStorage.removeItem("previoustoreOrderNumber"),lt.visit(route("mass-orders.index"))},onError:e=>{f.add({severity:"error",summary:"Error",detail:e.error||e.message||"Can't place update the order.",life:5e3})}})}})}catch{f.add({severity:"error",summary:"Error",detail:"An unexpected error occurred with the confirmation dialog.",life:5e3})}};M(L,async l=>{if(l){S.value=!0,k.item=l;try{const e=a.supplier_id;if(!e){f.add({severity:"error",summary:"Error",detail:"Failed to determine supplier code.",life:5e3}),S.value=!1;return}const u=(await V.get(route("SupplierItems.get-details-by-code",{itemCode:l,supplierCode:e}))).data.item;if(u){i.inventory_code=String(u.ItemCode),i.name=u.item_name,i.unit_of_measurement=u.uom,i.cost=Number(u.cost),i.uom=u.uom;let m=null,v=1;const _=u.sap_master_file;if(_&&Object.prototype.hasOwnProperty.call(_,"BaseQty")){const y=_.BaseQty;v=Number(y),(isNaN(v)||v<=0)&&(v=1),m=_.BaseUOM}i.base_uom=m,i.base_qty=v}else f.add({severity:"error",summary:"Error",detail:"Item details not found.",life:5e3})}catch{f.add({severity:"error",summary:"Error",detail:"Failed to load item details.",life:5e3})}finally{S.value=!1}}else Object.keys(i).forEach(e=>{i[e]=null})},{deep:!0});const Ue=A(()=>a.orders.reduce((l,e)=>l+parseFloat(e.total_cost),0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}));M(()=>a.supplier_id,async l=>{if(Y.value){if(a.order_date=null,a.branch_id=null,W.value={},L.value=null,Object.keys(i).forEach(e=>{i[e]=null}),z(l),oe.value=[],!l){X.value=!0;return}X.value=!0;try{const e=await V.get(route("mass-orders.available-dates",{supplier_code:l}));oe.value=e.data,X.value=!1}catch{f.add({severity:"error",summary:"Error",detail:"Failed to load available dates.",life:5e3})}}}),M(()=>a.order_date,async l=>{if(Y.value)if(a.branch_id=null,l&&a.supplier_id)try{const e=await V.get(route("mass-orders.get-branches",{order_date:l,supplier_code:a.supplier_id}));W.value=e.data}catch(e){console.error("Error fetching branches:",e),f.add({severity:"error",summary:"Error",detail:"Failed to load store branches for the selected date.",life:5e3})}else W.value={}});const Qe=A(()=>a.supplier_id!==null&&a.supplier_id!==""),re=A(()=>a.orders.length>0),Me=A(()=>a.orders.length===0&&a.supplier_id!==null&&a.supplier_id!==""&&a.branch_id!==null&&a.branch_id!==""&&a.order_date!==null),{isEditQuantityModalOpen:G,formQuantity:P,openEditQuantityModal:fe}=it(a,te,g.order),Ve=()=>{const l=a.orders.findIndex(e=>e.id===P.id);if(l!==-1){const e=Number(P.quantity),s=a.orders[l];if(isNaN(e)||e<=0){P.errors.quantity="Quantity must be a positive number.",f.add({severity:"error",summary:"Validation Error",detail:"Quantity must be a positive number.",life:3e3});return}const u=Number(s.cost);if(isNaN(u)){f.add({severity:"error",summary:"Calculation Error",detail:"Item cost is invalid. Cannot update total cost.",life:3e3});return}const m=Number(s.base_qty)>0?Number(s.base_qty):1;s.quantity=parseFloat(e.toFixed(2)),s.base_uom_qty=parseFloat((e*m).toFixed(2)),s.total_cost=parseFloat(Number(s.base_uom_qty)*Number(s.cost)).toFixed(2),a.orders=[...a.orders],f.add({severity:"success",summary:"Success",detail:"Quantity Updated.",life:3e3}),G.value=!1}else f.add({severity:"error",summary:"Error",detail:"Item not found in order list.",life:3e3})},Le=`Edit Order #${g.order.order_number}`,U=se({orders_file:null}),R=C(!1);M(R,l=>{l||(U.reset(),U.clearErrors())});const $e=()=>{R.value=!0,$.value=[]},je=async()=>{const l=a.supplier_id;if(!l){f.add({severity:"warn",summary:"Warning",detail:"Please select a supplier first to download the template.",life:5e3});return}try{const e=await V.get(route("store-orders.download-supplier-order-template",{supplierCode:l}),{responseType:"blob"}),s=window.URL.createObjectURL(new Blob([e.data])),u=document.createElement("a");u.href=s,u.setAttribute("download",`supplier_order_template_${l}.xlsx`),document.body.appendChild(u),u.click(),u.remove(),window.URL.revokeObjectURL(s),f.add({severity:"success",summary:"Success",detail:"Template download started.",life:3e3})}catch(e){console.error("Error downloading template:",e),f.add({severity:"error",summary:"Error",detail:"Failed to download template. Please try again.",life:5e3})}},Pe=()=>{S.value=!0,$.value=[];const l=new FormData;l.append("orders_file",U.orders_file),l.append("supplier_id",a.supplier_id),V.post(route("store-orders.imported-file"),l,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{e.data.orders.forEach(s=>{const u=s.item_code||s.ItemCode||s.inventory_code,m=s.item_name||s.ItemName||s.name,v=s.qty||s.Qty||s.quantity,_=Number(v),y=Number(s.cost||s.Cost),x=s.unit||s.UOM||s.unit_of_measurement,w=Number(s.base_qty||s.BaseQTY);if(isNaN(y)||y===0){f.add({severity:"error",summary:"Validation Error",detail:`Imported item '${m||u||"Unknown Item"}' has a cost of zero or is invalid and will be skipped.`,life:7e3});return}if(isNaN(_)||_<.1)return;if(isNaN(w)||w<=0){f.add({severity:"error",summary:"Validation Error",detail:`Imported item '${m||u||"Unknown Item"}' has an invalid BaseQTY and will be skipped. BaseQTY must be a positive number.`,life:7e3});return}const h=parseFloat((_*w).toFixed(2)),q=parseFloat((h*y).toFixed(2)),N=a.orders.findIndex(D=>D.inventory_code===u);if(N!==-1){const D=Number(a.orders[N].quantity)+_,K=parseFloat((D*w).toFixed(2));a.orders[N].quantity=D,a.orders[N].base_uom_qty=K,a.orders[N].total_cost=parseFloat(K*y).toFixed(2)}else{const D={id:null,inventory_code:String(u),name:m,unit_of_measurement:x,base_uom:s.base_uom||null,base_qty:w,base_uom_qty:h,quantity:parseFloat(_.toFixed(2)),cost:y,uom:x,total_cost:q};a.orders.push(D)}}),R.value=!1,f.add({severity:"success",summary:"Success",detail:"Items added successfully.",life:5e3}),U.orders_file=null,e.data.skipped_items&&e.data.skipped_items.length>0&&($.value=e.data.skipped_items.map(s=>`Item '${s.item_name||s.item_code||"Unknown"}' was skipped: ${s.reason}`))}).catch(e=>{f.add({severity:"error",summary:"Error",detail:e.response.data.message||"An error occurred while trying to get the imported orders. Please make sure that you are using the correct format.",life:5e3}),U.setError("orders_file",e.response.data.message||"Unknown error during import.")}).finally(()=>S.value=!1)};return(l,e)=>{const s=c("CardTitle"),u=c("CardDescription"),m=c("CardHeader"),v=c("InputLabel"),_=c("FormError"),y=c("CardContent"),x=c("Card"),w=c("Label"),h=c("Input"),q=c("Button"),N=c("CardFooter"),D=c("LabelXS"),K=c("SpanBold"),ye=c("DivFlexCenter"),B=c("TH"),Re=c("TableHead"),O=c("TD"),_e=c("LinkButton"),Ae=c("TableBody"),He=c("Table"),Ye=c("MobileTableHeading"),ze=c("MobileTableRow"),We=c("MobileTableContainer"),be=c("DialogTitle"),ve=c("DialogDescription"),ge=c("DialogHeader"),Je=c("Loading"),xe=c("DialogFooter"),we=c("DialogContent"),Ce=c("Dialog"),Xe=c("Layout");return F(),ne(Xe,{heading:Le,hasButton:Me.value,buttonName:"Import Orders",handleClick:$e},{default:o(()=>[$.value.length>0?(F(),I("div",dt,[e[13]||(e[13]=d("p",{class:"font-bold mb-2"},"Skipped Items:",-1)),d("ul",mt,[(F(!0),I(Z,null,ee($.value,(r,Q)=>(F(),I("li",{key:Q},b(r),1))),128))])])):De("",!0),d("div",ct,[d("section",pt,[t(x,null,{default:o(()=>[t(m,null,{default:o(()=>[t(s,null,{default:o(()=>e[14]||(e[14]=[n("Order Details")])),_:1}),t(u,null,{default:o(()=>e[15]||(e[15]=[n("Please input all the fields")])),_:1})]),_:1}),t(y,{class:"space-y-3"},{default:o(()=>[d("div",ft,[t(v,{label:"Supplier"}),t(p(ie),{filter:"",placeholder:"Select a Supplier",modelValue:p(a).supplier_id,"onUpdate:modelValue":e[0]||(e[0]=r=>p(a).supplier_id=r),options:p(he),optionLabel:"label",optionValue:"value",disabled:re.value},null,8,["modelValue","options","disabled"]),t(_,null,{default:o(()=>[n(b(p(a).errors.supplier_id),1)]),_:1})]),d("div",yt,[t(v,{label:"Order Date"}),d("div",{class:"relative",ref_key:"dateInputRef",ref:ae},[d("div",_t,[d("input",{id:"order_date",type:"text",readonly:"",value:p(a).order_date,onClick:e[1]||(e[1]=r=>j.value=!j.value),disabled:X.value||re.value,class:"flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm shadow-sm transition-colors placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-gray-400 disabled:cursor-not-allowed disabled:opacity-50 cursor-pointer",placeholder:"Select a date"},null,8,bt),t(p(ut),{class:"absolute right-3 top-1/2 -translate-y-1/2 size-4 text-gray-500 pointer-events-none"})]),tt(d("div",{class:Fe(["absolute z-50 bg-white border border-gray-200 rounded-lg shadow-lg p-4 w-full min-w-[300px]",le.value])},[d("div",vt,[d("button",{type:"button",onClick:e[2]||(e[2]=ue(r=>Ie(),["stop"])),class:"p-2 rounded-full hover:bg-gray-100"},"<"),d("h2",gt,b((E.value||new Date).toLocaleString("default",{month:"long",year:"numeric"})),1),d("button",{type:"button",onClick:e[3]||(e[3]=ue(r=>ke(),["stop"])),class:"p-2 rounded-full hover:bg-gray-100"},">")]),e[16]||(e[16]=d("div",{class:"grid grid-cols-7 gap-1 text-center text-xs font-medium text-gray-500 mb-2"},[d("span",null,"Su"),d("span",null,"Mo"),d("span",null,"Tu"),d("span",null,"We"),d("span",null,"Th"),d("span",null,"Fr"),d("span",null,"Sa")],-1)),d("div",xt,[(F(!0),I(Z,null,ee(Ne(),(r,Q)=>(F(),I("div",{key:Q,class:Fe(["text-center py-1.5 rounded-full text-sm",[r?r.isDisabled?"text-gray-300 line-through cursor-not-allowed":p(a).order_date&&r.date.toDateString()===new Date(p(a).order_date+"T00:00:00").toDateString()?"bg-blue-600 text-white font-bold shadow-md":"bg-gray-100 text-gray-800 font-semibold cursor-pointer hover:bg-blue-100":""]]),onClick:Vt=>Be(r)},b(r?r.day:""),11,wt))),128))])],2),[[ot,j.value]])],512),t(_,null,{default:o(()=>[n(b(p(a).errors.order_date),1)]),_:1})]),d("div",Ct,[t(v,{label:"Store Branch"}),t(p(ie),{filter:"",placeholder:"Select a Store",modelValue:p(a).branch_id,"onUpdate:modelValue":e[4]||(e[4]=r=>p(a).branch_id=r),options:qe.value,optionLabel:"label",optionValue:"value",disabled:re.value},null,8,["modelValue","options","disabled"]),t(_,null,{default:o(()=>[n(b(p(a).errors.branch_id),1)]),_:1})])]),_:1})]),_:1}),t(x,null,{default:o(()=>[t(m,null,{default:o(()=>[t(s,null,{default:o(()=>e[17]||(e[17]=[n("Add Item")])),_:1}),t(u,null,{default:o(()=>e[18]||(e[18]=[n("Please input all the fields")])),_:1})]),_:1}),t(y,{class:"space-y-3"},{default:o(()=>[d("div",Dt,[t(w,null,{default:o(()=>e[19]||(e[19]=[n("Item")])),_:1}),t(p(ie),{filter:"",placeholder:"Select an Item",modelValue:L.value,"onUpdate:modelValue":e[5]||(e[5]=r=>L.value=r),options:J.value,optionLabel:"label",optionValue:"value",disabled:!Qe.value||S.value},{empty:o(()=>[S.value?(F(),I("div",Ft," Loading items... ")):(F(),I("div",St," No items available for this supplier. "))]),_:1},8,["modelValue","options","disabled"]),t(_,null,{default:o(()=>[n(b(p(k).errors.item),1)]),_:1})]),d("div",ht,[t(w,null,{default:o(()=>e[20]||(e[20]=[n("Unit Of Measurement (UOM)")])),_:1}),t(h,{type:"text",disabled:"",modelValue:i.unit_of_measurement,"onUpdate:modelValue":e[6]||(e[6]=r=>i.unit_of_measurement=r)},null,8,["modelValue"])]),d("div",qt,[t(w,null,{default:o(()=>e[21]||(e[21]=[n("Cost")])),_:1}),t(h,{type:"text",disabled:"",modelValue:i.cost,"onUpdate:modelValue":e[7]||(e[7]=r=>i.cost=r)},null,8,["modelValue"])]),d("div",Nt,[t(w,null,{default:o(()=>e[22]||(e[22]=[n("Quantity")])),_:1}),t(h,{type:"number",modelValue:i.quantity,"onUpdate:modelValue":e[8]||(e[8]=r=>i.quantity=r)},null,8,["modelValue"]),t(_,null,{default:o(()=>[n(b(p(k).errors.quantity),1)]),_:1})])]),_:1}),t(N,{class:"flex justify-end"},{default:o(()=>[t(q,{onClick:Te,disabled:S.value},{default:o(()=>e[23]||(e[23]=[n(" Add to Orders ")])),_:1},8,["disabled"])]),_:1})]),_:1})]),t(x,{class:"col-span-2 flex flex-col"},{default:o(()=>[t(m,{class:"flex justify-between"},{default:o(()=>[t(ye,{class:"justify-between"},{default:o(()=>[t(s,null,{default:o(()=>e[24]||(e[24]=[n("Items List")])),_:1}),t(ye,{class:"gap-2"},{default:o(()=>[t(D,null,{default:o(()=>e[25]||(e[25]=[n(" Overall Total:")])),_:1}),t(K,null,{default:o(()=>[n(b(Ue.value),1)]),_:1}),t(q,{onClick:Oe,variant:"outline",class:"text-red-500",disabled:p(a).orders.length===0},{default:o(()=>[t(p(de),{class:"size-4 mr-1"}),e[26]||(e[26]=n(" Delete All "))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),t(y,{class:"flex-1"},{default:o(()=>[d("div",It,[t(He,null,{default:o(()=>[t(Re,null,{default:o(()=>[t(B,null,{default:o(()=>e[27]||(e[27]=[n(" Name ")])),_:1}),t(B,null,{default:o(()=>e[28]||(e[28]=[n(" Code ")])),_:1}),t(B,null,{default:o(()=>e[29]||(e[29]=[n(" Ordered Qty ")])),_:1}),t(B,null,{default:o(()=>e[30]||(e[30]=[n(" Unit ")])),_:1}),t(B,null,{default:o(()=>e[31]||(e[31]=[n(" BaseUOM Qty ")])),_:1}),t(B,null,{default:o(()=>e[32]||(e[32]=[n(" Base UOM ")])),_:1}),t(B,null,{default:o(()=>e[33]||(e[33]=[n(" Cost ")])),_:1}),t(B,null,{default:o(()=>e[34]||(e[34]=[n(" Total Cost ")])),_:1}),t(B,null,{default:o(()=>e[35]||(e[35]=[n(" Action ")])),_:1})]),_:1}),t(Ae,null,{default:o(()=>[(F(!0),I(Z,null,ee(p(a).orders,r=>(F(),I("tr",{key:r.id},[t(O,null,{default:o(()=>[n(b(r.name),1)]),_:2},1024),t(O,null,{default:o(()=>[n(b(r.inventory_code),1)]),_:2},1024),t(O,null,{default:o(()=>[n(b(r.quantity),1)]),_:2},1024),t(O,null,{default:o(()=>[n(b(r.unit_of_measurement),1)]),_:2},1024),t(O,null,{default:o(()=>[n(b(r.base_uom_qty),1)]),_:2},1024),t(O,null,{default:o(()=>[n(b(r.base_uom),1)]),_:2},1024),t(O,null,{default:o(()=>[n(b(Number(r.cost).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),1)]),_:2},1024),t(O,null,{default:o(()=>[n(b(Number(r.total_cost).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),1)]),_:2},1024),t(O,{class:"flex gap-3"},{default:o(()=>[t(_e,{onClick:Q=>p(fe)(r.id,r.quantity)},{default:o(()=>e[36]||(e[36]=[n(" Edit Quantity ")])),_:2},1032,["onClick"]),d("button",{onClick:Q=>pe(r.id),variant:"outline",class:"text-red-500 size-5"},[t(p(de))],8,kt)]),_:2},1024)]))),128))]),_:1})]),_:1})]),t(We,null,{default:o(()=>[(F(!0),I(Z,null,ee(p(a).orders,r=>(F(),ne(ze,{key:r.id},{default:o(()=>[t(Ye,{title:`${r.name} (${r.inventory_code})`},{default:o(()=>[d("button",{class:"text-red-500 size-5",onClick:Q=>pe(r.id),variant:"outline"},[t(p(de))],8,Bt)]),_:2},1032,["title"]),t(D,null,{default:o(()=>[n("UOM: "+b(r.unit_of_measurement),1)]),_:2},1024),t(D,null,{default:o(()=>[n("Ordered Qty: "+b(r.quantity),1)]),_:2},1024),t(D,null,{default:o(()=>[n("BaseUOM Qty: "+b(r.base_uom_qty),1)]),_:2},1024),t(D,null,{default:o(()=>[n("Cost: "+b(Number(r.cost).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),1)]),_:2},1024),t(D,null,{default:o(()=>[n("Total Cost: "+b(Number(r.total_cost).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),1)]),_:2},1024),t(_e,{onClick:Q=>p(fe)(r.id,r.quantity)},{default:o(()=>e[37]||(e[37]=[n(" Edit Quantity ")])),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})]),_:1}),t(N,{class:"flex justify-end"},{default:o(()=>[t(q,{onClick:Ee},{default:o(()=>e[38]||(e[38]=[n("Update Order")])),_:1})]),_:1})]),_:1})]),t(Ce,{open:R.value,"onUpdate:open":e[10]||(e[10]=r=>R.value=r)},{default:o(()=>[t(we,{class:"sm:max-w-[600px]"},{default:o(()=>[t(ge,null,{default:o(()=>[t(be,null,{default:o(()=>e[39]||(e[39]=[n("Import Orders")])),_:1}),t(ve,null,{default:o(()=>e[40]||(e[40]=[n(" Upload an Excel file to import orders. ")])),_:1})]),_:1}),d("div",Ot,[d("div",Tt,[t(h,{type:"file",onInput:e[9]||(e[9]=r=>p(U).orders_file=r.target.files[0])}),t(_,null,{default:o(()=>[n(b(p(U).errors.orders_file),1)]),_:1})]),d("div",Et,[t(w,{class:"text-xs"},{default:o(()=>e[41]||(e[41]=[n("Accepted Orders File Format")])),_:1}),d("ul",null,[d("li",Ut,[d("a",{class:"text-blue-500 underline cursor-pointer",onClick:ue(je,["prevent"])},"Click to download template")])])])]),t(xe,null,{default:o(()=>[t(q,{disabled:S.value,onClick:Pe,type:"submit",class:"gap-2"},{default:o(()=>[e[42]||(e[42]=n(" Import ")),d("span",null,[S.value?(F(),ne(Je,{key:0})):De("",!0)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),t(Ce,{open:p(G),"onUpdate:open":e[12]||(e[12]=r=>at(G)?G.value=r:null)},{default:o(()=>[t(we,{class:"sm:max-w-[425px]"},{default:o(()=>[t(ge,null,{default:o(()=>[t(be,null,{default:o(()=>e[43]||(e[43]=[n("Edit Quantity")])),_:1}),t(ve,null,{default:o(()=>e[44]||(e[44]=[n("Make changes to the quantity here. Click save when you're done.")])),_:1})]),_:1}),d("div",Qt,[d("div",Mt,[t(w,{for:"quantity",class:"text-right"},{default:o(()=>e[45]||(e[45]=[n(" Quantity ")])),_:1}),t(h,{id:"quantity",type:"number",class:"col-span-3",modelValue:p(P).quantity,"onUpdate:modelValue":e[11]||(e[11]=r=>p(P).quantity=r)},null,8,["modelValue"])])]),t(xe,null,{default:o(()=>[t(q,{onClick:Ve},{default:o(()=>e[46]||(e[46]=[n("Save changes")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"])]),_:1},8,["hasButton"])}}};export{Ht as default};
