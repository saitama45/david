import{f as be,T as F,r as l,o as C,c as j,w as n,a as t,b as o,u as i,t as d,d as I,e as Q,g as c,F as R,h as ve,i as xe}from"./app-p8ycGfai.js";import{u as A}from"./useSelectOptions-Ci2WUICq.js";import{u as Te}from"./useToast-BAk2IYqi.js";const De=["onClick"],qe=["onClick"],Ie=["onClick"],ke=["onClick"],Ve={key:0},Pe={__name:"Create",props:{categories:{type:Object,required:!0},products:{type:Object,required:!0}},setup(z){const B=be(),{toast:D}=Te(),P=z,{options:X}=A(P.products);A(P.categories);const a=F({product_id:"",name:null,remarks:null,ingredients:[]}),p=ref(!1),s=F({id:"",product_id:"",inventory_code:"",name:"",quantity:"",uom:"",unit:""});watch(()=>s.id,r=>{r&&(p.value=!0,axios.get(route("product.show",r)).then(e=>e.data).then(e=>{s.name=e.name,s.inventory_code=e.inventory_code,s.uom=e.unit_of_measurement,s.unit=e.unit_of_measurement}).catch(e=>console.log(e)).finally(()=>p.value=!1))});const L=r=>{const e=a.ingredients.findIndex(f=>f.id===r);a.ingredients[e].quantity<1?a.ingredients[e].quantity=Number((a.ingredients[e].quantity+.1).toFixed(1)):a.ingredients[e].quantity+=1},H=r=>{const e=a.ingredients.findIndex(f=>f.id===r);if(a.ingredients[e].quantity<1?a.ingredients[e].quantity=Number((a.ingredients[e].quantity-.1).toFixed(1)):a.ingredients[e].quantity-=1,a.ingredients[e].quantity<.1){a.ingredients=a.ingredients.filter(f=>f.id!==r);return}},N=r=>{B.require({message:"Are you sure you want to remove this from the ingredients list?",header:"Confirmation",icon:"pi pi-exclamation-triangle",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Remove",severity:"danger"},accept:()=>{a.ingredients=a.ingredients.filter(e=>e.id!==r),D.add({severity:"success",summary:"Confirmed",detail:"Item Removed",life:3e3})}})},G=()=>{if(s.clearErrors(),!s.id){s.setError("id","Product field is required");return}if(Number(s.quantity)<0){s.setError("quantity","Quantity must be at least 0");return}const r=a.ingredients.findIndex(e=>e.id===s.id);r!==-1?(a.ingredients[r].quantity+=Number(s.quantity),a.ingredients[r].unit=s.unit):a.ingredients.push({...s}),s.reset()},J=()=>{if(a.ingredients.length<1){D.add({severity:"error",summary:"Error",detail:"Please select at least one ingredient before proceeding.",life:5e3});return}B.require({message:"Are you sure you want to create this menu?",header:"Confirmation",icon:"pi pi-exclamation-triangle",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Create",severity:"success"},accept:()=>{a.post(route("menu-list.store"),{preserveScroll:!0,onSuccess:()=>{D.add({severity:"success",summary:"Success",detail:"Menu created successfully",life:3e3})},onError:r=>{D.add({severity:"error",summary:"Error",detail:"Failed to create menu.",life:3e3}),console.log(r)}})}})},k=F({menu_file:null}),g=ref(!1),K=()=>{g.value=!0},W=()=>{p.value=!0,k.post(route("menu-list.import"),{onSuccess:()=>{p.value=!1,g.value=!1},onError:()=>{p.value=!1}})};return watch(g,r=>{}),(r,e)=>{const f=l("CardTitle"),O=l("CardDescription"),S=l("CardHeader"),_=l("Label"),y=l("Input"),b=l("FormError"),m=l("InputContainer"),Y=l("Textarea"),U=l("CardContent"),V=l("Card"),Z=l("Select"),M=l("Button"),h=l("CardFooter"),ee=l("DivFlexCol"),te=l("SpanBold"),ne=l("TableHeader"),v=l("TH"),le=l("TableHead"),x=l("TD"),w=l("Minus"),E=l("Plus"),$=l("DeleteButton"),oe=l("TableBody"),ue=l("Table"),ae=l("MobileTableHeading"),q=l("LabelXS"),ie=l("MobileTableRow"),se=l("MobileTableContainer"),re=l("DivFlexCenter"),de=l("TableContainer"),me=l("DialogTitle"),pe=l("DialogDescription"),fe=l("DialogHeader"),_e=l("Loading"),ce=l("DialogFooter"),ge=l("DialogContent"),ye=l("Dialog"),Ce=l("Layout");return C(),j(Ce,{heading:"Create New BOM",hasButton:!0,buttonName:"Import BOM",handleClick:K},{default:n(()=>[t(V,{class:"grid sm:grid-cols-3 gap-5 p-5"},{default:n(()=>[t(ee,{class:"gap-5"},{default:n(()=>[t(V,null,{default:n(()=>[t(S,null,{default:n(()=>[t(f,null,{default:n(()=>e[9]||(e[9]=[o("BOM Details")])),_:1}),t(O,null,{default:n(()=>e[10]||(e[10]=[o("Please input all the required fields.")])),_:1})]),_:1}),t(U,{class:"grid sm:grid-cols-1 gap-5"},{default:n(()=>[t(m,null,{default:n(()=>[t(_,null,{default:n(()=>e[11]||(e[11]=[o("Product ID")])),_:1}),t(y,{modelValue:i(a).product_id,"onUpdate:modelValue":e[0]||(e[0]=u=>i(a).product_id=u)},null,8,["modelValue"]),t(b,null,{default:n(()=>[o(d(i(a).errors.product_id),1)]),_:1})]),_:1}),t(m,null,{default:n(()=>[t(_,null,{default:n(()=>e[12]||(e[12]=[o("Name")])),_:1}),t(y,{modelValue:i(a).name,"onUpdate:modelValue":e[1]||(e[1]=u=>i(a).name=u)},null,8,["modelValue"]),t(b,null,{default:n(()=>[o(d(i(a).errors.name),1)]),_:1})]),_:1}),t(m,null,{default:n(()=>[t(_,null,{default:n(()=>e[13]||(e[13]=[o("Remarks")])),_:1}),t(Y,{modelValue:i(a).remarks,"onUpdate:modelValue":e[2]||(e[2]=u=>i(a).remarks=u)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(V,null,{default:n(()=>[t(S,null,{default:n(()=>[t(f,null,{default:n(()=>e[14]||(e[14]=[o("Ingredients")])),_:1}),t(O,null,{default:n(()=>e[15]||(e[15]=[o("Please input all the required fields.")])),_:1})]),_:1}),t(U,{class:"space-y-5"},{default:n(()=>[t(m,null,{default:n(()=>[t(_,null,{default:n(()=>e[16]||(e[16]=[o("Product")])),_:1}),t(Z,{filter:"",options:i(X),modelValue:i(s).id,"onUpdate:modelValue":e[3]||(e[3]=u=>i(s).id=u),optionLabel:"label",optionValue:"value"},null,8,["options","modelValue"]),t(b,null,{default:n(()=>[o(d(i(s).errors.id),1)]),_:1})]),_:1}),t(m,null,{default:n(()=>[t(_,null,{default:n(()=>e[17]||(e[17]=[o("Product UOM")])),_:1}),t(y,{modelValue:i(s).uom,"onUpdate:modelValue":e[4]||(e[4]=u=>i(s).uom=u),disabled:!0},null,8,["modelValue"])]),_:1}),t(m,null,{default:n(()=>[t(_,null,{default:n(()=>e[18]||(e[18]=[o("Quantity")])),_:1}),t(y,{type:"number",modelValue:i(s).quantity,"onUpdate:modelValue":e[5]||(e[5]=u=>i(s).quantity=u)},null,8,["modelValue"]),t(b,null,{default:n(()=>[o(d(i(s).errors.quantity),1)]),_:1})]),_:1}),t(m,null,{default:n(()=>[t(_,null,{default:n(()=>e[19]||(e[19]=[o("Ingredient UOM")])),_:1}),t(y,{modelValue:i(s).unit,"onUpdate:modelValue":e[6]||(e[6]=u=>i(s).unit=u)},null,8,["modelValue"])]),_:1})]),_:1}),t(h,{class:"justify-end"},{default:n(()=>[t(M,{onClick:G},{default:n(()=>e[20]||(e[20]=[o("Add")])),_:1})]),_:1})]),_:1})]),_:1}),t(de,{class:"sm:col-span-2"},{default:n(()=>[t(ne,null,{default:n(()=>[t(te,null,{default:n(()=>e[21]||(e[21]=[o("Ingredients")])),_:1})]),_:1}),t(ue,null,{default:n(()=>[t(le,null,{default:n(()=>[t(v,null,{default:n(()=>e[22]||(e[22]=[o("Inventory Code")])),_:1}),t(v,null,{default:n(()=>e[23]||(e[23]=[o("Name")])),_:1}),t(v,null,{default:n(()=>e[24]||(e[24]=[o("Quantity")])),_:1}),t(v,null,{default:n(()=>e[25]||(e[25]=[o("Ingredient UOM")])),_:1}),t(v,null,{default:n(()=>e[26]||(e[26]=[o("Actions")])),_:1})]),_:1}),t(oe,null,{default:n(()=>[(C(!0),I(R,null,Q(i(a).ingredients,u=>(C(),I("tr",null,[t(x,null,{default:n(()=>[o(d(u.inventory_code),1)]),_:2},1024),t(x,null,{default:n(()=>[o(d(u.name),1)]),_:2},1024),t(x,null,{default:n(()=>[o(d(u.quantity),1)]),_:2},1024),t(x,null,{default:n(()=>[o(d(u.unit),1)]),_:2},1024),t(x,{class:"flex gap-3"},{default:n(()=>[c("button",{class:"text-red-500",onClick:T=>H(u.id)},[t(w)],8,De),c("button",{class:"text-green-500",onClick:T=>L(u.id)},[t(E)],8,qe),t($,{onClick:T=>N(u.id),variant:"outline",class:"text-red-500"},null,8,["onClick"])]),_:2},1024)]))),256))]),_:1})]),_:1}),t(se,null,{default:n(()=>[(C(!0),I(R,null,Q(i(a).ingredients,u=>(C(),j(ie,null,{default:n(()=>[t(ae,{title:`${u.name} (${u.inventory_code})`},{default:n(()=>[c("button",{class:"text-red-500 size-5",onClick:T=>H(u.id)},[t(w)],8,Ie),c("button",{class:"text-green-500 size-5",onClick:T=>L(u.id)},[t(E)],8,ke),t($,{onClick:T=>N(u.id),variant:"outline",class:"text-red-500"},null,8,["onClick"])]),_:2},1032,["title"]),t(q,null,{default:n(()=>[o("UOM: "+d(u.unit),1)]),_:2},1024),t(q,null,{default:n(()=>[o("Quantity: "+d(u.quantity),1)]),_:2},1024)]),_:2},1024))),256))]),_:1}),t(re,{class:"justify-end"},{default:n(()=>[t(M,{onClick:J},{default:n(()=>e[27]||(e[27]=[o("Create")])),_:1})]),_:1})]),_:1})]),_:1}),t(ye,{open:i(g),"onUpdate:open":e[8]||(e[8]=u=>xe(g)?g.value=u:null)},{default:n(()=>[t(ge,{class:"sm:max-w-[600px]"},{default:n(()=>[t(fe,null,{default:n(()=>[t(me,null,{default:n(()=>e[28]||(e[28]=[o("Import Menu List")])),_:1}),t(pe,null,{default:n(()=>e[29]||(e[29]=[o(" Import the excel file here. ")])),_:1})]),_:1}),t(m,null,{default:n(()=>[t(q,null,{default:n(()=>e[30]||(e[30]=[o(" Menu List ")])),_:1}),t(y,{disabled:i(p),type:"file",onInput:e[7]||(e[7]=u=>i(k).menu_file=u.target.files[0])},null,8,["disabled"]),t(b,null,{default:n(()=>[o(d(i(k).errors.menu_file),1)]),_:1})]),_:1}),t(m,null,{default:n(()=>[t(q,null,{default:n(()=>e[31]||(e[31]=[o("Menu Template")])),_:1}),e[32]||(e[32]=c("ul",null,[c("li",{class:"text-xs"},[o(" Template: "),c("a",{class:"text-blue-500 underline",href:"/excel/menu-template"},"Click to download")])],-1))]),_:1}),t(ce,null,{default:n(()=>[t(M,{disabled:i(p),onClick:W,class:"gap-2"},{default:n(()=>[e[33]||(e[33]=o(" Proceed ")),i(p)?(C(),I("span",Ve,[t(_e)])):ve("",!0)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})}}};export{Pe as default};
