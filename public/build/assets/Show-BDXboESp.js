import{u as ye}from"./useBackButton-B9bUould.js";import{f as ce,x as D,T as z,y as be,r as a,o as m,c,w as o,a as t,g as v,b as l,t as i,n as ge,h as b,d as O,e as X,u as p,F as G,M as xe,P as ke,i as Ce}from"./app-rjK1ng7o.js";import{u as Te}from"./useToast-DBCD-RTl.js";import{u as De}from"./useEditQuantity-BCpCvMmE.js";const Oe={class:"flex flex-col gap-5"},qe={class:"sm:flex-row flex flex-col gap-5"},Fe={class:"text-gray-700 text-sm"},Ie={class:"font-bold"},we={class:"text-gray-700 text-sm"},Be={class:"font-bold"},Ee={class:"text-gray-700 text-sm"},Ae=["onClick"],Ne=["onClick"],Ve={key:0},Le={key:0},He={__name:"Show",props:{order:{type:Object},orderedItems:{type:Object}},setup(u){ce();const{toast:H}=Te(),{backButton:J}=ye(route("orders-approval.index")),U=u;D(null);const K=r=>{switch(r){case"APPROVED":return"bg-green-500 text-white";case"PENDING":return"bg-yellow-500 text-white";case"REJECTED":return"bg-red-500 text-white";default:return"bg-yellow-500 text-white"}};z({remarks:null});const f=D(!1),q=D(!1),F=D(!1);be(q,r=>{r||(f.value=!1,_.reset(),_.clearErrors())});const _=z({id:null,remarks:null,updatedOrderedItemDetails:null}),W=r=>{q.value=!0,_.id=r},Y=r=>{F.value=!0,_.id=r},Z=()=>{f.value=!0,_.updatedOrderedItemDetails=y.value,_.post(route("orders-approval.approve"),{onSuccess:()=>{H.add({severity:"success",summary:"Success",detail:"Order Approved Successfully.",life:3e3}),f.value=!1},onError:r=>{console.log(r),f.value=!1}})},h=()=>{f.value=!0,_.post(route("orders-approval.reject"),{onSuccess:()=>{H.add({severity:"success",summary:"Success",detail:"Order Reject Successfully.",life:3e3}),f.value=!1},onError:()=>{f.value=!1}})},y=D([]);U.orderedItems.forEach(r=>y.value.push({id:r.id,quantity_ordered:r.quantity_ordered,quantity_approved:r.quantity_ordered,item_cost:r.cost_per_quantity,total_cost:r.total_cost}));const ee=r=>{const e=y.value.findIndex(s=>s.id===r);if(e!==-1){const s=y.value[e];s.quantity_approved>0&&(s.quantity_approved=Number(parseFloat(s.quantity_approved-.1).toFixed(2)),s.total_cost=parseFloat(s.item_cost*s.quantity_approved).toFixed(2))}},te=r=>{const e=y.value.findIndex(s=>s.id===r);if(e!==-1){const s=y.value[e];s.quantity_approved=Number(parseFloat(s.quantity_approved+.1).toFixed(2)),s.total_cost=parseFloat(s.item_cost*s.quantity_approved).toFixed(2)}},{isEditQuantityModalOpen:I,formQuantity:w,openEditQuantityModal:oe,editOrderQuantity:le}=De(null,y,U.order);return(r,e)=>{const s=a("Badge"),T=a("Button"),j=a("DivFlexCenter"),ne=a("TableHeader"),g=a("TH"),ae=a("TableHead"),x=a("TD"),re=a("LinkButton"),se=a("TableBody"),ue=a("Table"),de=a("MobileTableHeading"),B=a("LabelXS"),ie=a("MobileTableRow"),pe=a("MobileTableContainer"),me=a("TableContainer"),E=a("DialogTitle"),A=a("DialogDescription"),N=a("DialogHeader"),$=a("Label"),P=a("Textarea"),V=a("FormError"),L=a("InputContainer"),Q=a("Loading"),R=a("DialogFooter"),M=a("DialogContent"),S=a("Dialog"),fe=a("Input"),_e=a("Layout");return m(),c(_e,{heading:"Order Details"},{default:o(()=>[t(me,null,{default:o(()=>[v("section",Oe,[v("section",qe,[v("span",Fe,[e[8]||(e[8]=l(" Order Number: ")),v("span",Ie,i(u.order.order_number),1)]),v("span",we,[e[9]||(e[9]=l(" Order Date: ")),v("span",Be,i(u.order.order_date),1)]),v("span",Ee,[e[10]||(e[10]=l(" Status: ")),t(s,{class:ge(K(u.order.order_status.toUpperCase()))},{default:o(()=>[l(i(u.order.order_status.toUpperCase()),1)]),_:1},8,["class"])])]),t(j,{class:"gap-5"},{default:o(()=>[u.order.order_status==="pending"?(m(),c(T,{key:0,variant:"destructive",onClick:e[0]||(e[0]=n=>Y(u.order.id))},{default:o(()=>e[11]||(e[11]=[l(" Decline Order ")])),_:1})):b("",!0),u.order.order_status==="pending"?(m(),c(T,{key:1,class:"bg-green-500 hover:bg-green-300",onClick:e[1]||(e[1]=n=>W(u.order.id))},{default:o(()=>e[12]||(e[12]=[l(" Approve Order ")])),_:1})):b("",!0)]),_:1})]),t(ne),t(ue,null,{default:o(()=>[t(ae,null,{default:o(()=>[t(g,null,{default:o(()=>e[13]||(e[13]=[l(" Item Code ")])),_:1}),t(g,null,{default:o(()=>e[14]||(e[14]=[l(" Name ")])),_:1}),t(g,null,{default:o(()=>e[15]||(e[15]=[l(" Unit ")])),_:1}),t(g,null,{default:o(()=>e[16]||(e[16]=[l(" Quantity ")])),_:1}),u.order.order_status==="approved"?(m(),c(g,{key:0},{default:o(()=>e[17]||(e[17]=[l("Approved")])),_:1})):b("",!0),t(g,null,{default:o(()=>e[18]||(e[18]=[l(" Cost ")])),_:1}),t(g,null,{default:o(()=>e[19]||(e[19]=[l(" Total Cost ")])),_:1})]),_:1}),t(se,null,{default:o(()=>[(m(!0),O(G,null,X(u.orderedItems,n=>(m(),O("tr",{key:u.order.id},[t(x,null,{default:o(()=>{var d;return[l(i(((d=n.supplier_item)==null?void 0:d.ItemCode)??"N/A"),1)]}),_:2},1024),t(x,null,{default:o(()=>{var d;return[l(i(((d=n.supplier_item)==null?void 0:d.item_name)??"N/A"),1)]}),_:2},1024),t(x,null,{default:o(()=>{var d;return[l(i(((d=n.supplier_item)==null?void 0:d.uom)??"N/A"),1)]}),_:2},1024),t(x,{class:"flex items-center gap-3"},{default:o(()=>{var d;return[l(i(((d=y.value.find(k=>k.id===n.id))==null?void 0:d.quantity_approved)||0)+" ",1),u.order.order_status==="pending"?(m(),c(re,{key:0,onClick:k=>p(oe)(n.id,n.quantity_ordered)},{default:o(()=>e[20]||(e[20]=[l(" Edit Quantity ")])),_:2},1032,["onClick"])):b("",!0)]}),_:2},1024),u.order.order_status==="approved"?(m(),c(x,{key:0},{default:o(()=>[l(i(n.quantity_approved),1)]),_:2},1024)):b("",!0),t(x,null,{default:o(()=>[l(i(parseFloat(n.cost_per_quantity).toFixed(2)),1)]),_:2},1024),t(x,null,{default:o(()=>{var d;return[l(i(((d=y.value.find(k=>k.id===n.id))==null?void 0:d.total_cost)||0),1)]}),_:2},1024)]))),128))]),_:1})]),_:1}),t(pe,null,{default:o(()=>[(m(!0),O(G,null,X(u.orderedItems,n=>(m(),c(ie,{key:u.order.id},{default:o(()=>{var d,k;return[t(de,{title:`${((d=n.supplier_item)==null?void 0:d.item_name)??"N/A"} (${((k=n.supplier_item)==null?void 0:k.ItemCode)??"N/A"})`},{default:o(()=>[u.order.order_status==="pending"?(m(),c(j,{key:0,class:"gap-2"},{default:o(()=>[v("button",{onClick:C=>ee(n.id)},[t(p(xe),{class:"size-4 text-red-500"})],8,Ae),v("button",{onClick:C=>te(n.id)},[t(p(ke),{class:"size-4 text-green-500"})],8,Ne)]),_:2},1024)):b("",!0)]),_:2},1032,["title"]),t(B,null,{default:o(()=>{var C;return[l("UOM: "+i(((C=n.supplier_item)==null?void 0:C.uom)??"N/A"),1)]}),_:2},1024),t(B,null,{default:o(()=>{var C;return[l("Quantity: "+i(((C=y.value.find(ve=>ve.id===n.id))==null?void 0:C.quantity_approved)||0),1)]}),_:2},1024)]}),_:2},1024))),128))]),_:1})]),_:1}),t(T,{variant:"outline",class:"text-lg px-7",onClick:p(J)},{default:o(()=>e[21]||(e[21]=[l(" Back ")])),_:1},8,["onClick"]),t(S,{open:q.value,"onUpdate:open":e[3]||(e[3]=n=>q.value=n)},{default:o(()=>[t(M,{class:"sm:max-w-[600px]"},{default:o(()=>[t(N,null,{default:o(()=>[t(E,null,{default:o(()=>e[22]||(e[22]=[l("Approve Order")])),_:1}),t(A)]),_:1}),t(L,null,{default:o(()=>[t($,{class:"text-xs"},{default:o(()=>e[23]||(e[23]=[l("Remarks")])),_:1}),t(P,{modelValue:p(_).remarks,"onUpdate:modelValue":e[2]||(e[2]=n=>p(_).remarks=n)},null,8,["modelValue"]),t(V,null,{default:o(()=>[l(i(p(_).errors.remarks),1)]),_:1})]),_:1}),t(R,null,{default:o(()=>[t(T,{disabled:f.value,onClick:Z,type:"submit",class:"gap-2"},{default:o(()=>[e[24]||(e[24]=l(" Approve ")),f.value?(m(),O("span",Ve,[t(Q)])):b("",!0)]),_:1},8,["disabled"])]),_:1})]),_:1}),e[25]||(e[25]=v("div",{class:"space-y-5"},null,-1))]),_:1},8,["open"]),t(S,{open:F.value,"onUpdate:open":e[5]||(e[5]=n=>F.value=n)},{default:o(()=>[t(M,{class:"sm:max-w-[600px]"},{default:o(()=>[t(N,null,{default:o(()=>[t(E,null,{default:o(()=>e[26]||(e[26]=[l("Reject Order")])),_:1}),t(A)]),_:1}),t(L,null,{default:o(()=>[t($,{class:"text-xs"},{default:o(()=>e[27]||(e[27]=[l("Remarks")])),_:1}),t(P,{modelValue:p(_).remarks,"onUpdate:modelValue":e[4]||(e[4]=n=>p(_).remarks=n)},null,8,["modelValue"]),t(V,null,{default:o(()=>[l(i(p(_).errors.remarks),1)]),_:1})]),_:1}),t(R,null,{default:o(()=>[t(T,{disabled:f.value,onClick:h,type:"submit",class:"gap-2"},{default:o(()=>[e[28]||(e[28]=l(" Reject ")),v("span",null,[f.value?(m(),c(Q,{key:0})):b("",!0)])]),_:1},8,["disabled"])]),_:1})]),_:1}),e[29]||(e[29]=v("div",{class:"space-y-5"},null,-1))]),_:1},8,["open"]),t(S,{open:p(I),"onUpdate:open":e[7]||(e[7]=n=>Ce(I)?I.value=n:null)},{default:o(()=>[t(M,{class:"sm:max-w-[600px]"},{default:o(()=>[t(N,null,{default:o(()=>[t(E,null,{default:o(()=>e[30]||(e[30]=[l("Edit Quantity")])),_:1}),t(A,null,{default:o(()=>e[31]||(e[31]=[l(" Please input all the required fields. ")])),_:1})]),_:1}),t(L,null,{default:o(()=>[t(B,null,{default:o(()=>e[32]||(e[32]=[l("Quantity")])),_:1}),t(fe,{type:"number",modelValue:p(w).quantity,"onUpdate:modelValue":e[6]||(e[6]=n=>p(w).quantity=n)},null,8,["modelValue"]),t(V,null,{default:o(()=>[l(i(p(w).errors.quantity),1)]),_:1})]),_:1}),t(R,null,{default:o(()=>[t(T,{onClick:p(le),disabled:f.value,type:"submit",class:"gap-2"},{default:o(()=>[e[33]||(e[33]=l(" Confirm ")),f.value?(m(),O("span",Le,[t(Q)])):b("",!0)]),_:1},8,["onClick","disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})}}};export{He as default};
