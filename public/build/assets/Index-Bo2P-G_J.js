import{l as R}from"./lodash-Cj3gZpb5.js";import{D as st,x as h,l as w,y as U,r as D,o as l,c as I,w as O,g as t,a as r,u as n,C as at,d as p,t as o,h as F,n as g,aX as ot,b as _,b6 as rt,a7 as k,bi as E,e as M,F as H,N as lt}from"./app-Bw_fMWAP.js";import{u as nt}from"./useAuth-CBAjI_yz.js";import{S as it}from"./search-DhpFAzMz.js";import{R as Q}from"./rotate-ccw-C6sgn8yp.js";import{C as W,B as dt}from"./calendar-days-B96Yb9X9.js";import{P as ct}from"./package-B7IKRS5Q.js";import{B as ut}from"./badge-D_q7X7L2.js";import{T as gt}from"./trending-up-5JwK62pX.js";/**
 * @license lucide-vue-next v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=st("TrendingDownIcon",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),mt={class:"lg:hidden mb-4"},pt={class:"flex items-center gap-3"},yt={key:0,class:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-700 rounded-full"},vt={class:"p-6"},bt={class:"mb-6"},ft={class:"relative"},ht={key:0,class:"absolute right-4 top-1/2 transform -translate-y-1/2"},_t={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},wt={class:"space-y-2"},Vt={class:"flex items-center gap-2 text-sm font-medium text-gray-700"},Ct={class:"space-y-2"},Dt={class:"flex items-center gap-2 text-sm font-medium text-gray-700"},It={class:"space-y-2"},St={class:"flex items-center gap-2 text-sm font-medium text-gray-700"},Ft={class:"space-y-2"},kt={class:"flex items-center gap-2 text-sm font-medium text-gray-700"},qt={class:"flex items-center justify-between mt-6 pt-6 border-t border-gray-200"},Nt={class:"text-sm text-gray-600"},At={class:"flex items-center gap-3"},Tt={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},Bt={class:"bg-white rounded-lg border border-gray-200 p-4"},Pt={class:"flex items-center justify-between"},jt={class:"bg-white rounded-lg border border-gray-200 p-4"},$t={class:"flex items-center justify-between"},Lt={class:"text-2xl font-bold text-gray-900"},Rt={class:"bg-white rounded-lg border border-gray-200 p-4"},Ut={class:"flex items-center justify-between"},Ot={class:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden"},Et={class:"hidden lg:block overflow-x-auto"},Mt={class:"min-w-full"},Ht={class:"bg-white divide-y divide-gray-100"},Qt={key:0,class:"hover:bg-gray-50"},Wt={colspan:"11",class:"text-center py-12 text-gray-500"},Yt={class:"flex flex-col items-center"},zt=["title"],Xt={class:"px-4 py-4 text-sm font-mono text-gray-900"},Gt=["title"],Jt={class:"px-4 py-4 text-sm text-gray-600"},Kt={class:"px-4 py-4 text-sm text-right font-medium text-gray-900"},Zt={class:"px-4 py-4 text-sm text-center font-medium text-gray-900 bg-blue-50"},te={class:"px-4 py-4 text-sm text-center font-medium text-gray-900 bg-blue-50"},ee={class:"px-4 py-4 text-center font-medium bg-blue-50"},se={class:"px-4 py-4 text-sm text-right font-medium text-gray-900 bg-amber-50"},ae={class:"px-4 py-4 text-sm text-right font-medium text-gray-900 bg-amber-50"},oe={class:"px-4 py-4 text-right font-medium bg-amber-50"},re={class:"lg:hidden"},le={key:0,class:"p-8 text-center"},ne={class:"divide-y divide-gray-100"},ie={class:"flex items-center justify-between mb-3"},de={class:"flex flex-col"},ce={class:"text-sm font-mono text-gray-900"},ue={class:"text-xs text-gray-500"},ge={class:"text-right"},xe={class:"text-sm font-semibold text-gray-900"},me={class:"text-xs text-gray-500"},pe={class:"mb-3"},ye={class:"text-sm text-gray-900 line-clamp-2"},ve={class:"grid grid-cols-2 gap-3 text-sm"},be={class:"bg-blue-50 p-2 rounded"},fe={class:"font-medium"},he={class:"bg-blue-50 p-2 rounded"},_e={class:"font-medium"},we={class:"bg-amber-50 p-2 rounded"},Ve={class:"font-medium"},Ce={class:"bg-amber-50 p-2 rounded"},De={class:"font-medium"},Ie={class:"bg-white px-6 py-4 border-t border-gray-200 mt-6 rounded-b-xl"},je={__name:"Index",props:{varianceData:{type:Array,required:!0},paginatedData:{type:Object,required:!0},filters:{type:Object,required:!0},stores:{type:Array,required:!0},assignedStoreIds:{type:Array,required:!0}},setup(i){const x=i,V=h(!1),q=h(!1),Y=[{label:"25 rows",value:25},{label:"50 rows",value:50},{label:"100 rows",value:100},{label:"200 rows",value:200}],z=w(()=>x.stores.map(a=>({label:`${a.name} (${a.branch_code})`,value:a.id,searchTerms:[a.name,a.branch_code].join(" ").toLowerCase()}))),T=()=>{const a=new Date,e=a.getFullYear(),f=String(a.getMonth()+1).padStart(2,"0"),N=String(a.getDate()).padStart(2,"0");return`${e}-${f}-${N}`},B=()=>{const a=new Date,e=a.getFullYear(),f=String(a.getMonth()+1).padStart(2,"0");return`${e}-${f}-01`},y=h(x.filters.date_from||B()),v=h(x.filters.date_to||T()),m=h(x.filters.store_ids||[]),d=h(x.filters.search||""),C=h(x.filters.per_page||50);nt();const P=()=>{lt.get(route("reports.qty-variance-cost-variance-report.index"),{date_from:y.value,date_to:v.value,store_ids:m.value,search:d.value,per_page:C.value},{preserveState:!0,preserveScroll:!0,replace:!0})};U([y,v,m,C],R.throttle(P,300)),U(d,R.throttle(P,500));const X=()=>{V.value=!V.value},j=w(()=>{let a=0;return y.value&&a++,v.value&&a++,m.value&&m.value.length>0&&a++,d.value&&a++,a}),G=w(()=>j.value>0);w(()=>!V.value||window.innerWidth>=1024);const J=()=>{y.value=B(),v.value=T(),m.value=x.assignedStoreIds,d.value="",C.value=50},K=w(()=>route("reports.qty-variance-cost-variance-report.export",{date_from:y.value,date_to:v.value,store_ids:m.value,search:d.value})),c=a=>a?new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(a):"â‚±0.00",b=a=>a?new Intl.NumberFormat("en-PH").format(a):"0",u=w(()=>{const a={actualInventory:0,theoreticalInventory:0,qtyVariance:0,actualCost:0,theoreticalCost:0,costVariance:0};return x.varianceData.forEach(e=>{a.actualInventory+=e.actual_inventory||0,a.theoreticalInventory+=e.theoretical_inventory||0,a.qtyVariance+=e.qty_variance||0,a.actualCost+=e.actual_cost||0,a.theoreticalCost+=e.theoretical_cost||0,a.costVariance+=e.cost_variance||0}),a}),$=a=>a>0?"text-green-600 bg-green-50":a<0?"text-red-600 bg-red-50":"text-gray-600 bg-gray-50",S=a=>a>0?gt:xt;return(a,e)=>{const f=D("Input"),N=D("Select"),Z=D("Button"),tt=D("Pagination"),et=D("Layout");return l(),I(et,{heading:"Qty Variance / Cost Variance Report",hasExcelDownload:!0,exportRoute:K.value},{default:O(()=>{var L;return[t("div",mt,[t("button",{onClick:X,class:"flex items-center justify-between w-full p-4 bg-white rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow"},[t("div",pt,[r(n(at),{class:"w-5 h-5 text-gray-600"}),e[8]||(e[8]=t("span",{class:"font-medium text-gray-900"},"Filters",-1)),G.value?(l(),p("span",yt,o(j.value),1)):F("",!0)]),r(n(ot),{class:g(["w-5 h-5 text-gray-400 transition-transform",V.value?"rotate-180":""])},null,8,["class"])])]),t("div",{class:g(["bg-white rounded-xl border border-gray-200 shadow-sm mb-6 transition-all duration-300",V.value&&a.window.innerWidth<1024?"hidden":"block"])},[t("div",vt,[t("div",bt,[t("div",ft,[r(n(it),{class:g(["w-5 h-5 text-gray-400 absolute left-4 top-1/2 transform -translate-y-1/2 transition-colors",q.value?"text-blue-500":""])},null,8,["class"]),r(f,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=s=>d.value=s),onFocus:e[1]||(e[1]=s=>q.value=!0),onBlur:e[2]||(e[2]=s=>q.value=!1),placeholder:"Search by item code, description, or store...",class:"pl-12 pr-4 py-3 w-full text-base border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 rounded-lg"},null,8,["modelValue"]),d.value?(l(),p("div",ht,[t("button",{onClick:e[3]||(e[3]=s=>d.value=""),class:"text-gray-400 hover:text-gray-600 transition-colors"},[r(n(Q),{class:"w-4 h-4"})])])):F("",!0)])]),t("div",_t,[t("div",wt,[t("label",Vt,[r(n(W),{class:"w-4 h-4"}),e[9]||(e[9]=_(" From Date "))]),r(f,{type:"date",modelValue:y.value,"onUpdate:modelValue":e[4]||(e[4]=s=>y.value=s),class:"w-full border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 rounded-lg"},null,8,["modelValue"])]),t("div",Ct,[t("label",Dt,[r(n(W),{class:"w-4 h-4"}),e[10]||(e[10]=_(" To Date "))]),r(f,{type:"date",modelValue:v.value,"onUpdate:modelValue":e[5]||(e[5]=s=>v.value=s),class:"w-full border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 rounded-lg"},null,8,["modelValue"])]),t("div",It,[t("label",St,[r(n(dt),{class:"w-4 h-4"}),e[11]||(e[11]=_(" Stores "))]),r(n(rt),{filter:"",placeholder:"Select Stores",modelValue:m.value,"onUpdate:modelValue":e[6]||(e[6]=s=>m.value=s),options:z.value,optionLabel:"label",optionValue:"value",class:"w-full"},null,8,["modelValue","options"])]),t("div",Ft,[t("label",kt,[r(n(ct),{class:"w-4 h-4"}),e[12]||(e[12]=_(" Per Page "))]),r(N,{modelValue:C.value,"onUpdate:modelValue":e[7]||(e[7]=s=>C.value=s),options:Y,optionLabel:"label",optionValue:"value",class:"w-full",clearable:!1},null,8,["modelValue"])])]),t("div",qt,[t("div",Nt," Showing "+o(((L=i.paginatedData.data)==null?void 0:L.length)||0)+" of "+o(i.paginatedData.total||0)+" results ",1),t("div",At,[r(Z,{onClick:J,variant:"outline",class:"flex items-center gap-2 px-4 py-2 border-gray-300 hover:bg-gray-50 transition-colors"},{default:O(()=>[r(n(Q),{class:"w-4 h-4"}),e[13]||(e[13]=_(" Reset Filters "))]),_:1})])])])],2),t("div",Tt,[t("div",Bt,[t("div",Pt,[t("div",null,[e[14]||(e[14]=t("p",{class:"text-sm text-gray-600"},"Qty Variance",-1)),t("p",{class:g(["text-2xl font-bold",u.value.qtyVariance>=0?"text-green-600":"text-red-600"])},o(b(u.value.qtyVariance)),3)]),(l(),I(k(S(u.value.qtyVariance)),{class:g(["w-8 h-8",u.value.qtyVariance>=0?"text-green-500":"text-red-500"])},null,8,["class"]))])]),t("div",jt,[t("div",$t,[t("div",null,[e[15]||(e[15]=t("p",{class:"text-sm text-gray-600"},"Total Actual Cost",-1)),t("p",Lt,o(c(u.value.actualCost)),1)]),r(n(ut),{class:"w-8 h-8 text-amber-500"})])]),t("div",Rt,[t("div",Ut,[t("div",null,[e[16]||(e[16]=t("p",{class:"text-sm text-gray-600"},"Cost Variance",-1)),t("p",{class:g(["text-2xl font-bold",u.value.costVariance>=0?"text-green-600":"text-red-600"])},o(c(u.value.costVariance)),3)]),(l(),I(k(S(u.value.costVariance)),{class:g(["w-8 h-8",u.value.costVariance>=0?"text-green-500":"text-red-500"])},null,8,["class"]))])])]),t("div",Ot,[t("div",Et,[t("table",Mt,[e[19]||(e[19]=t("thead",{class:"bg-gray-50 border-b border-gray-200"},[t("tr",{class:"text-xs text-gray-500 uppercase tracking-wider"},[t("th",{class:"px-4 py-4 text-left font-medium"},"Store Branch"),t("th",{class:"px-4 py-4 text-left font-medium"},"Item Code"),t("th",{class:"px-4 py-4 text-left font-medium"},"Item Description"),t("th",{class:"px-4 py-4 text-left font-medium"},"UoM"),t("th",{class:"px-4 py-4 text-right font-medium"},"Cost"),t("th",{class:"px-4 py-4 text-center font-medium bg-blue-50"},"Actual Inventory"),t("th",{class:"px-4 py-4 text-center font-medium bg-blue-50"},"Theoretical Inventory"),t("th",{class:"px-4 py-4 text-center font-medium bg-blue-50"},"Qty Variance"),t("th",{class:"px-4 py-4 text-right font-medium bg-amber-50"},"Actual Cost"),t("th",{class:"px-4 py-4 text-right font-medium bg-amber-50"},"Theoretical Cost"),t("th",{class:"px-4 py-4 text-right font-medium bg-amber-50"},"Cost Variance")])],-1)),t("tbody",Ht,[!i.paginatedData.data||i.paginatedData.data.length===0?(l(),p("tr",Qt,[t("td",Wt,[t("div",Yt,[r(n(E),{class:"w-12 h-12 text-gray-300 mb-3"}),e[17]||(e[17]=t("span",{class:"text-lg font-medium"},"No data available",-1)),e[18]||(e[18]=t("span",{class:"text-sm text-gray-400 mt-1"},"Try adjusting your filters or search criteria",-1))])])])):F("",!0),(l(!0),p(H,null,M(i.paginatedData.data||[],(s,A)=>(l(),p("tr",{key:s.id||A,class:"hover:bg-gray-50 transition-colors"},[t("td",{class:"px-4 py-4 text-sm text-gray-900 max-w-xs truncate",title:s.store_name},o(s.store_name||"N/A"),9,zt),t("td",Xt,o(s.item_code||"N/A"),1),t("td",{class:"px-4 py-4 text-sm text-gray-900 max-w-xs truncate",title:s.item_description},o(s.item_description||"N/A"),9,Gt),t("td",Jt,o(s.uom||"N/A"),1),t("td",Kt,o(c(s.cost)),1),t("td",Zt,o(b(s.actual_inventory)),1),t("td",te,o(b(s.theoretical_inventory)),1),t("td",ee,[t("div",{class:g(["inline-flex items-center gap-1 px-2 py-1 rounded text-xs",$(s.qty_variance)])},[(l(),I(k(S(s.qty_variance)),{class:"w-3 h-3"})),_(" "+o(b(s.qty_variance)),1)],2)]),t("td",se,o(c(s.actual_cost)),1),t("td",ae,o(c(s.theoretical_cost)),1),t("td",oe,[t("div",{class:g(["inline-flex items-center gap-1 px-2 py-1 rounded text-xs",$(s.cost_variance)])},[(l(),I(k(S(s.cost_variance)),{class:"w-3 h-3"})),_(" "+o(c(s.cost_variance)),1)],2)])]))),128))])])]),t("div",re,[!i.paginatedData.data||i.paginatedData.data.length===0?(l(),p("div",le,[r(n(E),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e[20]||(e[20]=t("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No data available",-1)),e[21]||(e[21]=t("p",{class:"text-sm text-gray-500"},"Try adjusting your filters or search criteria",-1))])):F("",!0),t("div",ne,[(l(!0),p(H,null,M(i.paginatedData.data||[],(s,A)=>(l(),p("div",{key:s.id||A,class:"p-4 hover:bg-gray-50 transition-colors"},[t("div",ie,[t("div",de,[t("span",ce,o(s.item_code||"N/A"),1),t("span",ue,o(s.store_name||"N/A"),1)]),t("div",ge,[t("div",xe,o(c(s.cost_variance)),1),t("div",me,o(b(s.qty_variance))+" qty variance ",1)])]),t("div",pe,[t("p",ye,o(s.item_description||"N/A"),1)]),t("div",ve,[t("div",be,[e[22]||(e[22]=t("div",{class:"text-xs text-blue-600"},"Actual Inv",-1)),t("div",fe,o(b(s.actual_inventory)),1)]),t("div",he,[e[23]||(e[23]=t("div",{class:"text-xs text-blue-600"},"Theoretical Inv",-1)),t("div",_e,o(b(s.theoretical_inventory)),1)]),t("div",we,[e[24]||(e[24]=t("div",{class:"text-xs text-amber-600"},"Actual Cost",-1)),t("div",Ve,o(c(s.actual_cost)),1)]),t("div",Ce,[e[25]||(e[25]=t("div",{class:"text-xs text-amber-600"},"Theoretical Cost",-1)),t("div",De,o(c(s.theoretical_cost)),1)])])]))),128))])])]),t("div",Ie,[r(tt,{data:i.paginatedData},null,8,["data"])])]}),_:1},8,["exportRoute"])}}};export{je as default};
