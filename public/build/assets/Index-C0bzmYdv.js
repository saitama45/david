import{l as R}from"./lodash-DqVvdaAw.js";import{x as m,l as f,y as E,r as V,o as r,c as st,w as U,g as t,a as l,u as i,C as at,d as n,t as o,h as j,n as q,aX as ot,b as O,b6 as lt,bi as A,e as w,F as y,N as rt}from"./app-rjK1ng7o.js";import{u as nt}from"./useAuth-DN4uYPJg.js";import{S as dt}from"./search-1D3z8Z95.js";import{R as $}from"./rotate-ccw-AmYMTH22.js";import{C as H,B as it}from"./calendar-days-BOVgMW5B.js";import{P as Q}from"./package-Dr2_9bTP.js";import{B as ut}from"./badge-CqtggCsF.js";const ct={class:"lg:hidden mb-4"},pt={class:"flex items-center gap-3"},gt={key:0,class:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-700 rounded-full"},xt={class:"p-6"},mt={class:"mb-6"},yt={class:"relative"},bt={key:0,class:"absolute right-4 top-1/2 transform -translate-y-1/2"},vt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},ft={class:"space-y-2"},ht={class:"flex items-center gap-2 text-sm font-medium text-gray-700"},_t={class:"space-y-2"},wt={class:"flex items-center gap-2 text-sm font-medium text-gray-700"},Ct={class:"space-y-2"},St={class:"flex items-center gap-2 text-sm font-medium text-gray-700"},kt={class:"space-y-2"},Dt={class:"flex items-center gap-2 text-sm font-medium text-gray-700"},Pt={class:"flex items-center justify-between mt-6 pt-6 border-t border-gray-200"},Vt={class:"text-sm text-gray-600"},jt={class:"flex items-center gap-3"},Ot={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},Ft={class:"bg-white rounded-lg border border-gray-200 p-4"},Nt={class:"flex items-center justify-between"},qt={class:"text-2xl font-bold text-gray-900"},At={class:"bg-white rounded-lg border border-gray-200 p-4"},Bt={class:"flex items-center justify-between"},It={class:"text-2xl font-bold text-gray-900"},Tt={class:"bg-white rounded-lg border border-gray-200 p-4"},Lt={class:"flex items-center justify-between"},Rt={class:"text-2xl font-bold text-gray-900"},Et={class:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden"},Ut={key:0,class:"absolute inset-0 bg-white/80 flex items-center justify-center z-10"},$t={class:"hidden lg:block overflow-x-auto"},Ht={class:"min-w-full"},Qt={class:"bg-gray-50 border-b border-gray-200"},zt={class:"text-xs text-gray-500 uppercase tracking-wider"},Wt={class:"text-xs text-gray-500 uppercase tracking-wider"},Xt={class:"bg-white divide-y divide-gray-100"},Mt={key:0,class:"hover:bg-gray-50"},Gt=["colspan"],Jt={class:"flex flex-col items-center"},Kt={class:"px-6 py-4 text-sm font-mono text-gray-900"},Yt=["title"],Zt={class:"px-6 py-4 text-sm text-gray-600"},te={class:"px-6 py-4 text-sm text-gray-600"},ee={class:"px-3 py-4 text-sm text-center font-medium text-gray-900"},se={class:"px-3 py-4 text-sm text-right font-medium text-gray-900"},ae={class:"px-3 py-4 text-sm text-center font-bold text-gray-900 bg-amber-50"},oe={class:"px-3 py-4 text-sm text-right font-bold text-gray-900 bg-amber-50"},le={class:"lg:hidden"},re={key:0,class:"p-8 text-center"},ne={class:"divide-y divide-gray-100"},de={class:"flex items-center justify-between mb-3"},ie={class:"flex flex-col"},ue={class:"text-sm font-mono text-gray-900"},ce={class:"text-xs text-gray-500"},pe={class:"text-right"},ge={class:"text-sm font-semibold text-gray-900"},xe={class:"text-xs text-gray-500"},me={class:"mb-3"},ye={class:"text-sm text-gray-900 line-clamp-2"},be={class:"space-y-2"},ve={class:"text-gray-600"},fe={class:"text-right"},he={class:"font-medium"},_e={class:"text-gray-500 ml-1"},we={class:"bg-white px-6 py-4 border-t border-gray-200 mt-6 rounded-b-xl"},Fe={__name:"Index",props:{pmixData:{type:Array,required:!0},paginatedData:{type:Object,required:!0},filters:{type:Object,required:!0},stores:{type:Array,required:!0},storeColumns:{type:Object,required:!0},assignedStoreIds:{type:Array,required:!0}},setup(c){const p=c,C=m(!1),F=m(!1),N=m(!1),z=[{label:"25 rows",value:25},{label:"50 rows",value:50},{label:"100 rows",value:100},{label:"200 rows",value:200}],W=f(()=>p.stores.map(a=>({label:`${a.name} (${a.brand_code})`,value:a.id,searchTerms:[a.name,a.brand_code].join(" ").toLowerCase()}))),b=m(p.filters.date_from||""),v=m(p.filters.date_to||""),x=m(p.filters.store_ids||[]),g=m(p.filters.search||""),S=m(p.filters.per_page||50);nt();const B=()=>{F.value=!0,rt.get(route("reports.pmix-report.index"),{date_from:b.value,date_to:v.value,store_ids:x.value,search:g.value,per_page:S.value},{preserveState:!0,preserveScroll:!0,replace:!0,onStart:()=>F.value=!0,onFinish:()=>F.value=!1})};E([b,v,x,S],R.throttle(B,300)),E(g,R.throttle(B,500));const X=()=>{C.value=!C.value},I=f(()=>{let a=0;return b.value&&a++,v.value&&a++,x.value&&x.value.length>0&&a++,g.value&&a++,a}),M=f(()=>I.value>0);f(()=>!C.value||window.innerWidth>=1024);const G=()=>{b.value="",v.value="",x.value=p.assignedStoreIds,g.value="",S.value=50},J=f(()=>route("reports.pmix-report.export",{date_from:b.value,date_to:v.value,store_ids:x.value,search:g.value})),k=a=>a?new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(a):"â‚±0.00",h=a=>a?new Intl.NumberFormat("en-PH").format(a):"0",T=f(()=>{const a={quantity:0,sales:0};return p.pmixData.forEach(e=>{Object.values(e.stores).forEach(_=>{a.quantity+=_.quantity,a.sales+=_.sales})}),a}),D=f(()=>Object.entries(p.storeColumns).map(([a,e])=>({id:a,name:e})));return(a,e)=>{const _=V("Input"),K=V("Select"),Y=V("Button"),Z=V("Pagination"),tt=V("Layout");return r(),st(tt,{heading:"PMIX Report",hasExcelDownload:!0,exportRoute:J.value},{default:U(()=>{var L;return[t("div",ct,[t("button",{onClick:X,class:"flex items-center justify-between w-full p-4 bg-white rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow"},[t("div",pt,[l(i(at),{class:"w-5 h-5 text-gray-600"}),e[8]||(e[8]=t("span",{class:"font-medium text-gray-900"},"Filters",-1)),M.value?(r(),n("span",gt,o(I.value),1)):j("",!0)]),l(i(ot),{class:q(["w-5 h-5 text-gray-400 transition-transform",C.value?"rotate-180":""])},null,8,["class"])])]),t("div",{class:q(["bg-white rounded-xl border border-gray-200 shadow-sm mb-6 transition-all duration-300",C.value&&a.window.innerWidth<1024?"hidden":"block"])},[t("div",xt,[t("div",mt,[t("div",yt,[l(i(dt),{class:q(["w-5 h-5 text-gray-400 absolute left-4 top-1/2 transform -translate-y-1/2 transition-colors",N.value?"text-blue-500":""])},null,8,["class"]),l(_,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=s=>g.value=s),onFocus:e[1]||(e[1]=s=>N.value=!0),onBlur:e[2]||(e[2]=s=>N.value=!1),placeholder:"Search by POS code, description, category, or sub-category...",class:"pl-12 pr-4 py-3 w-full text-base border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 rounded-lg"},null,8,["modelValue"]),g.value?(r(),n("div",bt,[t("button",{onClick:e[3]||(e[3]=s=>g.value=""),class:"text-gray-400 hover:text-gray-600 transition-colors"},[l(i($),{class:"w-4 h-4"})])])):j("",!0)])]),t("div",vt,[t("div",ft,[t("label",ht,[l(i(H),{class:"w-4 h-4"}),e[9]||(e[9]=O(" From Date "))]),l(_,{type:"date",modelValue:b.value,"onUpdate:modelValue":e[4]||(e[4]=s=>b.value=s),class:"w-full border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 rounded-lg"},null,8,["modelValue"])]),t("div",_t,[t("label",wt,[l(i(H),{class:"w-4 h-4"}),e[10]||(e[10]=O(" To Date "))]),l(_,{type:"date",modelValue:v.value,"onUpdate:modelValue":e[5]||(e[5]=s=>v.value=s),class:"w-full border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 rounded-lg"},null,8,["modelValue"])]),t("div",Ct,[t("label",St,[l(i(it),{class:"w-4 h-4"}),e[11]||(e[11]=O(" Stores "))]),l(i(lt),{filter:"",placeholder:"Select Stores",modelValue:x.value,"onUpdate:modelValue":e[6]||(e[6]=s=>x.value=s),options:W.value,optionLabel:"label",optionValue:"value",class:"w-full"},null,8,["modelValue","options"])]),t("div",kt,[t("label",Dt,[l(i(Q),{class:"w-4 h-4"}),e[12]||(e[12]=O(" Per Page "))]),l(K,{modelValue:S.value,"onUpdate:modelValue":e[7]||(e[7]=s=>S.value=s),options:z,optionLabel:"label",optionValue:"value",class:"w-full",clearable:!1},null,8,["modelValue"])])]),t("div",Pt,[t("div",Vt," Showing "+o(((L=c.paginatedData.data)==null?void 0:L.length)||0)+" of "+o(c.paginatedData.total||0)+" results ",1),t("div",jt,[l(Y,{onClick:G,variant:"outline",class:"flex items-center gap-2 px-4 py-2 border-gray-300 hover:bg-gray-50 transition-colors"},{default:U(()=>[l(i($),{class:"w-4 h-4"}),e[13]||(e[13]=O(" Reset Filters "))]),_:1})])])])],2),t("div",Ot,[t("div",Ft,[t("div",Nt,[t("div",null,[e[14]||(e[14]=t("p",{class:"text-sm text-gray-600"},"Total Items",-1)),t("p",qt,o(h(c.paginatedData.total||0)),1)]),l(i(A),{class:"w-8 h-8 text-blue-500"})])]),t("div",At,[t("div",Bt,[t("div",null,[e[15]||(e[15]=t("p",{class:"text-sm text-gray-600"},"Total Quantity",-1)),t("p",It,o(h(T.value.quantity)),1)]),l(i(Q),{class:"w-8 h-8 text-green-500"})])]),t("div",Tt,[t("div",Lt,[t("div",null,[e[16]||(e[16]=t("p",{class:"text-sm text-gray-600"},"Total Sales",-1)),t("p",Rt,o(k(T.value.sales)),1)]),l(i(ut),{class:"w-8 h-8 text-amber-500"})])])]),t("div",Et,[F.value?(r(),n("div",Ut,e[17]||(e[17]=[t("div",{class:"flex items-center gap-3 text-gray-600"},[t("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),t("span",null,"Loading...")],-1)]))):j("",!0),t("div",$t,[t("table",Ht,[t("thead",Qt,[t("tr",zt,[e[18]||(e[18]=t("th",{class:"px-6 py-4 text-left font-medium"},"POS Code",-1)),e[19]||(e[19]=t("th",{class:"px-6 py-4 text-left font-medium"},"Item Description",-1)),e[20]||(e[20]=t("th",{class:"px-6 py-4 text-left font-medium"},"Category",-1)),e[21]||(e[21]=t("th",{class:"px-6 py-4 text-left font-medium"},"Sub Category",-1)),(r(!0),n(y,null,w(D.value,s=>(r(),n("th",{key:s.id,class:"px-6 py-4 text-center font-medium",colspan:"2"},o(s.name),1))),128)),e[22]||(e[22]=t("th",{class:"px-6 py-4 text-center font-medium bg-amber-50",colspan:"2"},"Total",-1))]),t("tr",Wt,[e[25]||(e[25]=t("th",{class:"px-6 py-2"},null,-1)),e[26]||(e[26]=t("th",{class:"px-6 py-2"},null,-1)),e[27]||(e[27]=t("th",{class:"px-6 py-2"},null,-1)),e[28]||(e[28]=t("th",{class:"px-6 py-2"},null,-1)),(r(!0),n(y,null,w(D.value,s=>(r(),n(y,{key:"sub-"+s.id},[e[23]||(e[23]=t("th",{class:"px-3 py-2 text-center font-medium text-gray-600"},"Qty",-1)),e[24]||(e[24]=t("th",{class:"px-3 py-2 text-right font-medium text-gray-600"},"Sales",-1))],64))),128)),e[29]||(e[29]=t("th",{class:"px-3 py-2 text-center font-medium text-gray-700 bg-amber-50"},"Qty",-1)),e[30]||(e[30]=t("th",{class:"px-3 py-2 text-right font-medium text-gray-700 bg-amber-50"},"Sales",-1))])]),t("tbody",Xt,[!c.paginatedData.data||c.paginatedData.data.length===0?(r(),n("tr",Mt,[t("td",{colspan:4+D.value.length*2+2,class:"text-center py-12 text-gray-500"},[t("div",Jt,[l(i(A),{class:"w-12 h-12 text-gray-300 mb-3"}),e[31]||(e[31]=t("span",{class:"text-lg font-medium"},"No data available",-1)),e[32]||(e[32]=t("span",{class:"text-sm text-gray-400 mt-1"},"Try adjusting your filters or search criteria",-1))])],8,Gt)])):j("",!0),(r(!0),n(y,null,w(c.paginatedData.data||[],(s,et)=>(r(),n("tr",{key:s.POSCode,class:"hover:bg-gray-50 transition-colors"},[t("td",Kt,o(s.POSCode||"N/A"),1),t("td",{class:"px-6 py-4 text-sm text-gray-900 max-w-xs truncate",title:s.POSDescription},o(s.POSDescription||"N/A"),9,Yt),t("td",Zt,o(s.Category||"N/A"),1),t("td",te,o(s.SubCategory||"N/A"),1),(r(!0),n(y,null,w(D.value,d=>{var u,P;return r(),n(y,{key:"data-"+d.id},[t("td",ee,o(h(((u=s.stores[d.id])==null?void 0:u.quantity)||0)),1),t("td",se,o(k(((P=s.stores[d.id])==null?void 0:P.sales)||0)),1)],64)}),128)),t("td",ae,o(h(Object.values(s.stores).reduce((d,u)=>d+u.quantity,0))),1),t("td",oe,o(k(Object.values(s.stores).reduce((d,u)=>d+u.sales,0))),1)]))),128))])])]),t("div",le,[!c.paginatedData.data||c.paginatedData.data.length===0?(r(),n("div",re,[l(i(A),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e[33]||(e[33]=t("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No data available",-1)),e[34]||(e[34]=t("p",{class:"text-sm text-gray-500"},"Try adjusting your filters or search criteria",-1))])):j("",!0),t("div",ne,[(r(!0),n(y,null,w(c.paginatedData.data||[],(s,et)=>(r(),n("div",{key:s.POSCode,class:"p-4 hover:bg-gray-50 transition-colors"},[t("div",de,[t("div",ie,[t("span",ue,o(s.POSCode||"N/A"),1),t("span",ce,o(s.Category||"N/A"),1)]),t("div",pe,[t("div",ge,o(k(Object.values(s.stores).reduce((d,u)=>d+u.sales,0))),1),t("div",xe,o(h(Object.values(s.stores).reduce((d,u)=>d+u.quantity,0)))+" units ",1)])]),t("div",me,[t("p",ye,o(s.POSDescription||"N/A"),1)]),t("div",be,[(r(!0),n(y,null,w(D.value,d=>{var u,P;return r(),n("div",{key:"mobile-"+d.id,class:"flex items-center justify-between text-sm"},[t("span",ve,o(d.name)+":",1),t("div",fe,[t("span",he,o(h(((u=s.stores[d.id])==null?void 0:u.quantity)||0)),1),t("span",_e,"("+o(k(((P=s.stores[d.id])==null?void 0:P.sales)||0))+")",1)])])}),128))])]))),128))])])]),t("div",we,[l(Z,{data:c.paginatedData},null,8,["data"])])]}),_:1},8,["exportRoute"])}}};export{Fe as default};
