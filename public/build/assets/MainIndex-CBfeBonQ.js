import{f as fe,Q as I,N as A,T as O,r as l,o as p,c as D,w as o,a as t,u as n,b as s,h as B,g as m,i as x,ak as _e,ao as ve,ap as be,aq as xe,ar as ge,as as ye,d as k,e as E,at as Te,t as g,F as R}from"./app-rjK1ng7o.js";import"./lodash-DqVvdaAw.js";import{u as Se}from"./useSelectOptions-C8yZk_6t.js";import{u as Ce}from"./useToast-DBCD-RTl.js";const Ie={class:"flex justify-end"},De={key:0},Le={__name:"MainIndex",props:{transactions:{type:Object,required:!0},branches:{type:Object,required:!0}},setup(y){const{toast:T}=Ce(),P=fe(),{options:H}=Se(y.branches);let F=ref(I().props.filters.search),u=ref(I().props.from??null),i=ref(I().props.to??null);const d=ref(I().props.filters.branchId||H.value[0].value);watch(u,r=>{A.get(route("store-transactions-approval.main-index"),{search:F.value,from:r,to:i.value,branchId:d.value},{preserveState:!0,preserveScroll:!0})}),watch(i,r=>{A.get(route("store-transactions-approval.main-index"),{search:F.value,from:u.value,to:r,branchId:d.value},{preserveState:!0,preserveScroll:!0})}),watch(d,r=>{A.get(route("store-transactions-approval.main-index"),{search:F.value,from:u.value,to:i.value,branchId:r},{preserveState:!0,preserveScroll:!0})});const $=()=>{u.value=null,i.value=null,d.value=H.value[0].value},j=computed(()=>route("store-transactions.export-main-index",{branchId:d.value,from:u.value,to:i.value})),V=O({store_transactions_file:null}),c=ref(!1),f=ref(!1),q=()=>{f.value=!0};watch(f,r=>{r||(c.value=!1)});const U=()=>{c.value=!0,V.post(route("store-transactions.import"),{onSuccess:()=>{c.value=!1,f.value=!1,T.add({severity:"success",summary:"Success",detail:"Store transactions created successfully",life:3e3})},onError:r=>{T.add({severity:"error",summary:"Error",detail:"An error occured while trying to import store transactions.",life:3e3}),c.value=!1}})},_=ref([]),w=O({id:null}),M=()=>{w.id=_.value,P.require({message:"Are you sure you want to approve the selected transactions?",header:"Confirmation",icon:"pi pi-exclamation-triangle",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Confirm",severity:"success"},accept:()=>{w.post(route("store-transactions-approval.approve-selected-transactions"),{onSuccess:()=>{T.add({severity:"success",summary:"Success",detail:"Store Transactions Approved Successfully.",life:3e3})}})}})},X=()=>{P.require({message:"Are you sure you want to approve all the items status?",header:"Confirmation",icon:"pi pi-exclamation-triangle",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Confirm",severity:"success"},accept:()=>{w.post(route("store-transactions-approval.approve-all-transactions"),{onSuccess:()=>{T.add({severity:"success",summary:"Success",detail:"Store Transactions Approved Successfully.",life:3e3})}})}})};return(r,e)=>{const S=l("Button"),h=l("Filter"),Q=l("PopoverTrigger"),L=l("Input"),z=l("PopoverContent"),G=l("Popover"),J=l("DivFlexCenter"),K=l("TableHeader"),v=l("TH"),W=l("TableHead"),Y=l("Checkbox"),b=l("TD"),Z=l("ShowButton"),ee=l("TableBody"),te=l("Table"),oe=l("TableContainer"),le=l("DialogTitle"),ae=l("DialogDescription"),ne=l("DialogHeader"),se=l("LabelXS"),re=l("FormError"),N=l("InputContainer"),ue=l("Label"),ie=l("Loading"),de=l("DialogFooter"),pe=l("DialogContent"),ce=l("Dialog"),me=l("Layout");return p(),D(me,{heading:"Store Transactions Approval",hasButton:!0,buttonName:"Import Store Transactions",handleClick:q,hasExcelDownload:!0,exportRoute:n(j)},{default:o(()=>[t(oe,null,{default:o(()=>[t(K,null,{default:o(()=>[n(_).length>0?(p(),D(S,{key:0,onClick:M,variant:"outline"},{default:o(()=>e[6]||(e[6]=[s("Approve Selected Items")])),_:1})):B("",!0),y.transactions.length>0&&n(_).length==0?(p(),D(S,{key:1,onClick:X,class:"bg-green-500"},{default:o(()=>e[7]||(e[7]=[s("Approve All")])),_:1})):B("",!0),t(J,{class:"gap-5"},{default:o(()=>[t(G,null,{default:o(()=>[t(Q,null,{default:o(()=>[t(h)]),_:1}),t(z,null,{default:o(()=>[m("div",Ie,[t(S,{onClick:$,variant:"link",class:"text-end text-red-500 text-xs"},{default:o(()=>e[8]||(e[8]=[s(" Reset Filter ")])),_:1})]),e[10]||(e[10]=m("label",{class:"text-xs"},"From",-1)),t(L,{type:"date",modelValue:n(u),"onUpdate:modelValue":e[0]||(e[0]=a=>x(u)?u.value=a:u=a)},null,8,["modelValue"]),e[11]||(e[11]=m("label",{class:"text-xs"},"To",-1)),t(L,{type:"date",modelValue:n(i),"onUpdate:modelValue":e[1]||(e[1]=a=>x(i)?i.value=a:i=a)},null,8,["modelValue"]),e[12]||(e[12]=m("label",{class:"text-xs"},"Store",-1)),t(n(_e),{modelValue:n(d),"onUpdate:modelValue":e[2]||(e[2]=a=>x(d)?d.value=a:null)},{default:o(()=>[t(n(ve),null,{default:o(()=>[t(n(be),{placeholder:"Select a store"})]),_:1}),t(n(xe),null,{default:o(()=>[t(n(ge),null,{default:o(()=>[t(n(ye),null,{default:o(()=>e[9]||(e[9]=[s("Stores")])),_:1}),(p(!0),k(R,null,E(y.branches,(a,C)=>(p(),D(n(Te),{key:C,value:C},{default:o(()=>[s(g(a),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(te,null,{default:o(()=>[t(W,null,{default:o(()=>[t(v),t(v,null,{default:o(()=>e[13]||(e[13]=[s("Order Date")])),_:1}),t(v,null,{default:o(()=>e[14]||(e[14]=[s("Transactions Count")])),_:1}),t(v,null,{default:o(()=>e[15]||(e[15]=[s("Overall Net Total")])),_:1}),t(v,null,{default:o(()=>e[16]||(e[16]=[s("Actions")])),_:1})]),_:1}),t(ee,null,{default:o(()=>[(p(!0),k(R,null,E(y.transactions,a=>(p(),k("tr",{key:a.id},[t(b,null,{default:o(()=>[t(Y,{modelValue:n(_),"onUpdate:modelValue":e[3]||(e[3]=C=>x(_)?_.value=C:null),value:a.order_date,inputId:`transaction-${a.order_date}`},null,8,["modelValue","value","inputId"])]),_:2},1024),t(b,null,{default:o(()=>[s(g(a.order_date),1)]),_:2},1024),t(b,null,{default:o(()=>[s(g(a.transaction_count),1)]),_:2},1024),t(b,null,{default:o(()=>[s(g(a.net_total),1)]),_:2},1024),t(b,{class:"flex items-center"},{default:o(()=>[t(Z,{isLink:!0,href:r.route("store-transactions-approval.index",{order_date:a.order_date,branchId:n(d)})},null,8,["href"])]),_:2},1024)]))),128))]),_:1})]),_:1})]),_:1}),t(ce,{open:n(f),"onUpdate:open":e[5]||(e[5]=a=>x(f)?f.value=a:null)},{default:o(()=>[t(pe,{class:"sm:max-w-[600px]"},{default:o(()=>[t(ne,null,{default:o(()=>[t(le,null,{default:o(()=>e[17]||(e[17]=[s("Import Store Transactions List")])),_:1}),t(ae,null,{default:o(()=>e[18]||(e[18]=[s(" Import the excel file here. ")])),_:1})]),_:1}),t(N,null,{default:o(()=>[t(se,null,{default:o(()=>e[19]||(e[19]=[s(" Store Transactions List ")])),_:1}),t(L,{disabled:n(c),type:"file",onInput:e[4]||(e[4]=a=>n(V).store_transactions_file=a.target.files[0])},null,8,["disabled"]),t(re,null,{default:o(()=>[s(g(n(V).errors.store_transactions_file),1)]),_:1})]),_:1}),t(N,null,{default:o(()=>[t(ue,{class:"text-xs"},{default:o(()=>e[20]||(e[20]=[s("Store Transaction Template")])),_:1}),e[21]||(e[21]=m("ul",null,[m("li",{class:"text-xs"},[s(" Template: "),m("a",{class:"text-blue-500 underline",href:"/excel/store-transactions-template"},"Click to download")])],-1))]),_:1}),t(de,null,{default:o(()=>[t(S,{disabled:n(c),onClick:U,class:"gap-2"},{default:o(()=>[e[22]||(e[22]=s(" Proceed ")),n(c)?(p(),k("span",De,[t(ie)])):B("",!0)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1},8,["exportRoute"])}}};export{Le as default};
