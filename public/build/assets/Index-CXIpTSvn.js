import{l as $}from"./lodash-Z9yJD-f9.js";import{x as g,l as h,y as R,r as N,o as d,c as et,w as U,g as t,a as l,u as r,C as st,d as i,t as o,h as w,n as p,br as at,b as x,ay as B,e as M,F as H,N as ot}from"./app-p8ycGfai.js";import{u as lt}from"./useAuth-CsB0rIGq.js";import{_ as rt}from"./SearchableSelect-ClgNtmbc.js";import{S as nt}from"./search-Czf2XZZ_.js";import{R as W}from"./rotate-ccw-JUU7RYek.js";import{C as E,B as dt,a as z}from"./calendar-days-Ghify1tX.js";import{P as Q}from"./package-WwDcP9-w.js";const it={class:"lg:hidden mb-4"},ut={class:"flex items-center gap-3"},ct={key:0,class:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-700 rounded-full"},gt={class:"p-6"},pt={class:"mb-6"},xt={class:"relative"},mt={key:0,class:"absolute right-4 top-1/2 transform -translate-y-1/2"},yt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4"},bt={class:"space-y-2"},ft={class:"flex items-center gap-2 text-sm font-medium text-gray-700"},vt={class:"space-y-2"},_t={class:"flex items-center gap-2 text-sm font-medium text-gray-700"},ht={class:"space-y-2"},wt={class:"flex items-center gap-2 text-sm font-medium text-gray-700"},St={class:"space-y-2"},Dt={class:"flex items-center gap-2 text-sm font-medium text-gray-700"},Vt={class:"space-y-2"},Ct={class:"flex items-center gap-2 text-sm font-medium text-gray-700"},Nt={class:"flex items-center justify-between mt-6 pt-6 border-t border-gray-200"},At={class:"text-sm text-gray-600"},Ft={class:"flex items-center gap-3"},kt={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},Tt={class:"bg-white rounded-lg border border-gray-200 p-4"},jt={class:"flex items-center justify-between"},It={class:"text-2xl font-bold text-gray-900"},Pt={class:"bg-white rounded-lg border border-gray-200 p-4"},Bt={class:"flex items-center justify-between"},Ot={class:"text-2xl font-bold text-gray-900"},qt={class:"bg-white rounded-lg border border-gray-200 p-4"},Lt={class:"flex items-center justify-between"},$t={class:"text-2xl font-bold text-gray-900"},Rt={class:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden"},Ut={key:0,class:"absolute inset-0 bg-white/80 flex items-center justify-center z-10"},Mt={class:"hidden lg:block overflow-x-auto"},Ht={class:"min-w-full"},Wt={class:"bg-white divide-y divide-gray-100"},Et={key:0,class:"hover:bg-gray-50"},zt={colspan:"10",class:"text-center py-12 text-gray-500"},Qt={class:"flex flex-col items-center"},Yt={class:"px-6 py-4 text-sm font-mono text-gray-900"},Gt=["title"],Jt={class:"px-6 py-4 text-sm text-gray-600"},Kt={class:"font-mono"},Xt={class:"text-gray-500"},Zt={class:"px-6 py-4 text-sm text-center font-medium text-gray-900"},te={class:"px-6 py-4 text-sm text-right font-medium text-gray-900"},ee={class:"px-6 py-4 text-sm text-right font-medium text-gray-900"},se={class:"px-6 py-4 text-center"},ae=["title"],oe={class:"px-6 py-4 text-sm text-gray-600"},le={class:"lg:hidden"},re={key:0,class:"p-8 text-center"},ne={class:"divide-y divide-gray-100"},de={class:"flex items-center justify-between mb-3"},ie={class:"flex flex-col flex-1"},ue={class:"text-sm font-mono text-gray-900"},ce={class:"text-xs text-gray-500"},ge={class:"text-xs text-gray-700 mt-1"},pe={class:"font-mono"},xe={class:"text-right"},me={class:"text-sm font-semibold text-gray-900"},ye={class:"text-xs text-gray-500"},be={class:"flex items-center justify-between mb-2"},fe={class:"text-xs text-gray-500"},ve={key:0,class:"text-xs text-gray-600"},_e={class:"bg-white px-6 py-4 border-t border-gray-200 mt-6 rounded-b-xl"},Fe={__name:"Index",props:{wastages:{type:Array,required:!0},paginatedData:{type:Object,required:!0},filters:{type:Object,required:!0},stores:{type:Array,required:!0},statusOptions:{type:Array,required:!0},assignedStoreIds:{type:Array,required:!0},summaryTotals:{type:Object,required:!0}},setup(n){const m=n,S=g(!1),A=g(!1),j=g(!1),Y=[{label:"25 rows",value:25},{label:"50 rows",value:50},{label:"100 rows",value:100},{label:"200 rows",value:200}],G=h(()=>m.stores.map(a=>({label:`${a.label}`,value:a.value,searchTerms:[a.label].join(" ").toLowerCase()}))),J=h(()=>m.statusOptions.map(a=>({label:a.label,value:a.value}))),b=g(m.filters.date_from||""),f=g(m.filters.date_to||""),v=g(m.filters.store_branch_id||""),_=g(m.filters.status||"approved_lvl2"),u=g(m.filters.search||""),D=g(m.filters.per_page||50);lt();const O=()=>{A.value=!0,ot.get(route("reports.wastage-report.index"),{date_from:b.value,date_to:f.value,store_branch_id:v.value,status:_.value,search:u.value,per_page:D.value},{preserveState:!0,preserveScroll:!0,replace:!0,onStart:()=>A.value=!0,onFinish:()=>A.value=!1})};R([b,f,v,_,D],$.throttle(O,300)),R(u,$.throttle(O,500));const K=()=>{S.value=!S.value},q=h(()=>{let a=0;return b.value&&a++,f.value&&a++,v.value&&a++,_.value&&a++,u.value&&a++,a}),X=h(()=>q.value>0);h(()=>!S.value||window.innerWidth>=1024);const Z=()=>{const a=new Date,e=new Date(a.getFullYear(),a.getMonth(),1);b.value=e.toISOString().split("T")[0],f.value=a.toISOString().split("T")[0],v.value=null,_.value="approved_lvl2",u.value="",D.value=50},tt=h(()=>route("reports.wastage-report.export",{date_from:b.value,date_to:f.value,store_branch_id:v.value,status:_.value,search:u.value})),V=a=>a?new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(a):"â‚±0.00",F=a=>a?new Intl.NumberFormat("en-PH").format(a):"0";function L(a){if(!a)return"N/A";const e=new Date(a),C=String(e.getMonth()+1).padStart(2,"0"),k=String(e.getDate()).padStart(2,"0"),I=e.getFullYear();let c=e.getHours();const P=String(e.getMinutes()).padStart(2,"0"),T=c>=12?"P.M.":"A.M.";return c=c%12,c=c||12,`${C}/${k}/${I} ${String(c).padStart(2,"0")}:${P} ${T}`}const y=a=>{const e={pending:{bg:"bg-gray-50 border-gray-200",text:"text-gray-700",dot:"bg-gray-400",label:"Pending"},approved_lvl1:{bg:"bg-blue-50 border-blue-200",text:"text-blue-700",dot:"bg-blue-400",label:"Approved Level 1"},approved_lvl2:{bg:"bg-green-50 border-green-200",text:"text-green-700",dot:"bg-green-400",label:"Approved Level 2"},cancelled:{bg:"bg-red-50 border-red-200",text:"text-red-700",dot:"bg-red-400",label:"Cancelled"}};return e[a]||e.pending};return(a,e)=>{const C=N("Input"),k=N("Select"),I=N("Button"),c=N("Pagination"),P=N("Layout");return d(),et(P,{heading:"Wastage Report",hasExcelDownload:!0,exportRoute:tt.value},{default:U(()=>{var T;return[t("div",it,[t("button",{onClick:K,class:"flex items-center justify-between w-full p-4 bg-white rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow"},[t("div",ut,[l(r(st),{class:"w-5 h-5 text-gray-600"}),e[9]||(e[9]=t("span",{class:"font-medium text-gray-900"},"Filters",-1)),X.value?(d(),i("span",ct,o(q.value),1)):w("",!0)]),l(r(at),{class:p(["w-5 h-5 text-gray-400 transition-transform",S.value?"rotate-180":""])},null,8,["class"])])]),t("div",{class:p(["bg-white rounded-xl border border-gray-200 shadow-sm mb-6 transition-all duration-300",S.value&&a.window.innerWidth<1024?"hidden":"block"])},[t("div",gt,[t("div",pt,[t("div",xt,[l(r(nt),{class:p(["w-5 h-5 text-gray-400 absolute left-4 top-1/2 transform -translate-y-1/2 transition-colors",j.value?"text-blue-500":""])},null,8,["class"]),l(C,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=s=>u.value=s),onFocus:e[1]||(e[1]=s=>j.value=!0),onBlur:e[2]||(e[2]=s=>j.value=!1),placeholder:"Search by wastage number or store name...",class:"pl-12 pr-4 py-3 w-full text-base border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 rounded-lg"},null,8,["modelValue"]),u.value?(d(),i("div",mt,[t("button",{onClick:e[3]||(e[3]=s=>u.value=""),class:"text-gray-400 hover:text-gray-600 transition-colors"},[l(r(W),{class:"w-4 h-4"})])])):w("",!0)])]),t("div",yt,[t("div",bt,[t("label",ft,[l(r(E),{class:"w-4 h-4"}),e[10]||(e[10]=x(" From Date "))]),l(C,{type:"date",modelValue:b.value,"onUpdate:modelValue":e[4]||(e[4]=s=>b.value=s),class:"w-full border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 rounded-lg"},null,8,["modelValue"])]),t("div",vt,[t("label",_t,[l(r(E),{class:"w-4 h-4"}),e[11]||(e[11]=x(" To Date "))]),l(C,{type:"date",modelValue:f.value,"onUpdate:modelValue":e[5]||(e[5]=s=>f.value=s),class:"w-full border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 rounded-lg"},null,8,["modelValue"])]),t("div",ht,[t("label",wt,[l(r(dt),{class:"w-4 h-4"}),e[12]||(e[12]=x(" Store "))]),l(rt,{modelValue:v.value,"onUpdate:modelValue":e[6]||(e[6]=s=>v.value=s),placeholder:"All Stores",options:G.value,optionLabel:"label",optionValue:"value",class:"w-full",clearable:""},null,8,["modelValue","options"])]),t("div",St,[t("label",Dt,[l(r(z),{class:"w-4 h-4"}),e[13]||(e[13]=x(" Status "))]),l(k,{modelValue:_.value,"onUpdate:modelValue":e[7]||(e[7]=s=>_.value=s),placeholder:"All Status",options:J.value,optionLabel:"label",optionValue:"value",class:"w-full",clearable:""},null,8,["modelValue","options"])]),t("div",Vt,[t("label",Ct,[l(r(Q),{class:"w-4 h-4"}),e[14]||(e[14]=x(" Per Page "))]),l(k,{modelValue:D.value,"onUpdate:modelValue":e[8]||(e[8]=s=>D.value=s),options:Y,optionLabel:"label",optionValue:"value",class:"w-full",clearable:!1},null,8,["modelValue"])])]),t("div",Nt,[t("div",At," Showing "+o(((T=n.paginatedData.data)==null?void 0:T.length)||0)+" of "+o(n.paginatedData.total||0)+" results ",1),t("div",Ft,[l(I,{onClick:Z,variant:"outline",class:"flex items-center gap-2 px-4 py-2 border-gray-300 hover:bg-gray-50 transition-colors"},{default:U(()=>[l(r(W),{class:"w-4 h-4"}),e[15]||(e[15]=x(" Reset Filters "))]),_:1})])])])],2),t("div",kt,[t("div",Tt,[t("div",jt,[t("div",null,[e[16]||(e[16]=t("p",{class:"text-sm text-gray-600"},"Total Records",-1)),t("p",It,o(F(n.summaryTotals.total_records||0)),1)]),l(r(B),{class:"w-8 h-8 text-blue-500"})])]),t("div",Pt,[t("div",Bt,[t("div",null,[e[17]||(e[17]=t("p",{class:"text-sm text-gray-600"},"Total Quantity",-1)),t("p",Ot,o(F(n.summaryTotals.total_quantity||0)),1)]),l(r(Q),{class:"w-8 h-8 text-green-500"})])]),t("div",qt,[t("div",Lt,[t("div",null,[e[18]||(e[18]=t("p",{class:"text-sm text-gray-600"},"Total Cost",-1)),t("p",$t,o(V(n.summaryTotals.total_cost||0)),1)]),l(r(z),{class:"w-8 h-8 text-amber-500"})])])]),t("div",Rt,[A.value?(d(),i("div",Ut,e[19]||(e[19]=[t("div",{class:"flex items-center gap-3 text-gray-600"},[t("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),t("span",null,"Loading...")],-1)]))):w("",!0),t("div",Mt,[t("table",Ht,[e[23]||(e[23]=t("thead",{class:"bg-gray-50 border-b border-gray-200"},[t("tr",{class:"text-xs text-gray-500 uppercase tracking-wider"},[t("th",{class:"px-6 py-4 text-left font-medium"},"Wastage #"),t("th",{class:"px-6 py-4 text-left font-medium"},"Store"),t("th",{class:"px-6 py-4 text-left font-medium"},"Item Description"),t("th",{class:"px-6 py-4 text-center font-medium"},"Qty"),t("th",{class:"px-6 py-4 text-right font-medium"},"Unit Cost"),t("th",{class:"px-6 py-4 text-right font-medium"},"Total Cost"),t("th",{class:"px-6 py-4 text-center font-medium"},"Status"),t("th",{class:"px-6 py-4 text-left font-medium"},"Reason"),t("th",{class:"px-6 py-4 text-left font-medium"},"Date")])],-1)),t("tbody",Wt,[!n.paginatedData.data||n.paginatedData.data.length===0?(d(),i("tr",Et,[t("td",zt,[t("div",Qt,[l(r(B),{class:"w-12 h-12 text-gray-300 mb-3"}),e[20]||(e[20]=t("span",{class:"text-lg font-medium"},"No data available",-1)),e[21]||(e[21]=t("span",{class:"text-sm text-gray-400 mt-1"},"Try adjusting your filters or search criteria",-1))])])])):w("",!0),(d(!0),i(H,null,M(n.paginatedData.data,s=>(d(),i("tr",{key:s.id,class:"hover:bg-gray-50 transition-colors"},[t("td",Yt,o(s.wastage_no||"N/A"),1),t("td",{class:"px-6 py-4 text-sm text-gray-900 max-w-xs truncate",title:s.store_branch.name},o(s.store_branch.name||"N/A"),9,Gt),t("td",Jt,[t("span",Kt,o(s.sap_masterfile.ItemCode||"N/A"),1),e[22]||(e[22]=x(" - ")),t("span",null,o(s.sap_masterfile.ItemDescription||"No description"),1),t("span",Xt,"("+o(s.sap_masterfile.BaseUOM||"N/A")+")",1)]),t("td",Zt,o(F(s.wastage_qty||0)),1),t("td",te,o(V(s.cost||0)),1),t("td",ee,o(V((s.wastage_qty||0)*(s.cost||0))),1),t("td",se,[t("div",{class:p(["inline-flex items-center gap-2 px-3 py-1 rounded-full border text-xs font-medium",y(s.wastage_status).bg])},[t("div",{class:p(["w-2 h-2 rounded-full",y(s.wastage_status).dot])},null,2),t("span",{class:p(y(s.wastage_status).text)},o(y(s.wastage_status).label),3)],2)]),t("td",{class:"px-6 py-4 text-sm text-gray-600 max-w-xs truncate",title:s.reason},o(s.reason||"No reason specified"),9,ae),t("td",oe,o(L(s.created_at)),1)]))),128))])])]),t("div",le,[!n.paginatedData.data||n.paginatedData.data.length===0?(d(),i("div",re,[l(r(B),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e[24]||(e[24]=t("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No data available",-1)),e[25]||(e[25]=t("p",{class:"text-sm text-gray-500"},"Try adjusting your filters or search criteria",-1))])):w("",!0),t("div",ne,[(d(!0),i(H,null,M(n.paginatedData.data,s=>(d(),i("div",{key:s.id,class:"p-4 hover:bg-gray-50 transition-colors"},[t("div",de,[t("div",ie,[t("span",ue,o(s.wastage_no||"N/A"),1),t("span",ce,o(s.store_branch.name||"N/A"),1),t("div",ge,[t("span",pe,o(s.sap_masterfile.ItemCode||"N/A"),1),x(" - "+o(s.sap_masterfile.ItemDescription||"No description"),1)])]),t("div",xe,[t("div",me,o(V((s.wastage_qty||0)*(s.cost||0))),1),t("div",ye,o(F(s.wastage_qty||0))+" "+o(s.sap_masterfile.BaseUOM||"N/A")+" @ "+o(V(s.cost||0)),1)])]),t("div",be,[t("div",{class:p(["inline-flex items-center gap-2 px-2 py-1 rounded-full border text-xs font-medium",y(s.wastage_status).bg])},[t("div",{class:p(["w-1.5 h-1.5 rounded-full",y(s.wastage_status).dot])},null,2),t("span",{class:p(y(s.wastage_status).text)},o(y(s.wastage_status).label),3)],2),t("span",fe,o(L(s.created_at)),1)]),s.reason?(d(),i("div",ve,[e[26]||(e[26]=t("span",{class:"font-medium"},"Reason:",-1)),x(" "+o(s.reason),1)])):w("",!0)]))),128))])])]),t("div",_e,[l(c,{data:n.paginatedData},null,8,["data"])])]}),_:1},8,["exportRoute"])}}};export{Fe as default};
