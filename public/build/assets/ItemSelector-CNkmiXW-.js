import{Y as K,x as y,l as P,y as A,V as Q,a4 as T,o as l,d as c,g as s,a as r,u as o,_ as O,c as g,w as v,X,aA as x,h as m,F as q,e as I,b as k,t as u,n as Y,aZ as L,P as D,k as U,E as Z}from"./app-Bp7xdNcv.js";import N from"./StockIndicator-OXXkftVS.js";import{S as z}from"./search-RtaD5aad.js";import"./circle-x-ya5U_PzQ.js";import"./triangle-alert-ClI8I6RE.js";const G={class:"item-selector space-y-4"},H={class:"relative"},J={key:0,class:"flex gap-2 flex-wrap"},W={key:1,class:"border rounded-lg max-h-96 overflow-y-auto bg-background shadow-lg"},ee=["onClick","onMouseenter"],te={class:"flex items-center justify-between"},se={class:"flex-1 min-w-0"},ae={class:"flex items-center gap-2 mb-1"},oe={class:"font-medium text-sm"},le={class:"text-sm text-muted-foreground truncate"},ne={class:"flex items-center gap-4 mt-2"},re={class:"text-sm font-medium"},ie={class:"flex items-center gap-2 ml-4"},ce={key:2,class:"border rounded-lg p-8 text-center bg-muted/30"},ue={class:"text-muted-foreground"},de={key:3},ve={class:"text-sm font-medium mb-2 flex items-center gap-2"},me={class:"flex flex-col gap-2"},fe=["onClick"],_e={class:"flex-1 min-w-0"},pe={class:"flex items-center gap-2"},he={class:"font-medium text-sm"},xe={class:"text-sm text-muted-foreground truncate"},ye={class:"flex items-center gap-2 mt-1"},ge={class:"text-xs text-muted-foreground"},ke={key:4},we={class:"text-center py-8 text-muted-foreground"},be={__name:"ItemSelector",props:{items:{type:Array,default:()=>[]},categories:{type:Array,default:()=>[]},recentlyUsed:{type:Array,default:()=>[]},sendingStoreId:{type:Number,required:!0}},emits:["select-item","quick-add","view-details"],setup(_,{emit:M}){const F=_,C=M,n=y(""),d=y(null),p=y(!1),E=y(null),i=y(-1),w=P(()=>{let a=F.items||[];if(d.value&&(a=a.filter(t=>t.category_id===d.value)),n.value){const t=n.value.toLowerCase();a=a.filter(e=>e.item_code.toLowerCase().includes(t)||e.description.toLowerCase().includes(t))}return n.value&&a.sort((t,e)=>{const f=t.item_code.toLowerCase()===n.value.toLowerCase(),h=e.item_code.toLowerCase()===n.value.toLowerCase();return f&&!h?-1:!f&&h?1:0}),a.slice(0,10)}),B=a=>{const t=w.value;switch(a.key){case"ArrowDown":a.preventDefault(),i.value=Math.min(i.value+1,t.length-1);break;case"ArrowUp":a.preventDefault(),i.value=Math.max(i.value-1,0);break;case"Enter":a.preventDefault(),i.value>=0&&t[i.value]&&$(t[i.value]);break;case"Escape":b();break}},$=a=>{C("select-item",a),b()},S=a=>{C("quick-add",a),b()},R=a=>{C("view-details",a)},b=()=>{var a;n.value="",d.value=null,p.value=!1,i.value=-1,(a=E.value)==null||a.focus()},j=()=>{p.value=!0,i.value=-1};A(n,()=>{p.value=!0,i.value=0}),A(d,()=>{p.value=!0,i.value=0});const V=a=>{a.target.closest(".item-selector")||(p.value=!1)};return Q(()=>{document.addEventListener("click",V)}),T(()=>{document.removeEventListener("click",V)}),(a,t)=>(l(),c("div",G,[s("div",H,[r(o(z),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),r(o(O),{ref_key:"searchInputRef",ref:E,modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=e=>n.value=e),placeholder:"Search products by code or description...",class:"pl-10 pr-10",onFocus:j,onKeydown:B},null,8,["modelValue"]),n.value?(l(),g(o(x),{key:0,size:"sm",variant:"ghost",class:"absolute right-2 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0",onClick:b},{default:v(()=>[r(o(X),{class:"w-4 h-4"})]),_:1})):m("",!0)]),_.categories.length>0?(l(),c("div",J,[(l(!0),c(q,null,I(_.categories,e=>(l(),g(o(x),{key:e.id,size:"sm",variant:d.value===e.id?"default":"outline",onClick:f=>d.value=e.id},{default:v(()=>[k(u(e.name),1)]),_:2},1032,["variant","onClick"]))),128)),d.value?(l(),g(o(x),{key:0,size:"sm",variant:"ghost",onClick:t[1]||(t[1]=e=>d.value=null)},{default:v(()=>t[2]||(t[2]=[k(" Clear ")])),_:1})):m("",!0)])):m("",!0),p.value&&w.value.length>0?(l(),c("div",W,[(l(!0),c(q,null,I(w.value,(e,f)=>(l(),c("div",{key:e.id,class:Y(["p-4 border-b hover:bg-muted/50 cursor-pointer transition-colors",{"bg-muted/50":f===i.value}]),onClick:h=>$(e),onMouseenter:h=>i.value=f},[s("div",te,[s("div",se,[s("div",ae,[s("span",oe,u(e.item_code),1),e.category?(l(),g(o(L),{key:0,variant:"secondary",class:"text-xs"},{default:v(()=>[k(u(e.category),1)]),_:2},1024)):m("",!0)]),s("p",le,u(e.description),1),s("div",ne,[r(N,{available:Number(e.stock||0),requested:e.quantity||0,size:"small"},null,8,["available","requested"]),s("span",re,"₱"+u((e.cost_per_quantity||0).toFixed(2)),1),e.uom?(l(),g(o(L),{key:0,variant:"outline",class:"text-xs"},{default:v(()=>[k(u(e.uom),1)]),_:2},1024)):m("",!0)])]),s("div",ie,[r(o(x),{size:"sm",variant:"ghost",onClick:U(h=>S(e),["stop"]),title:"Quick Add"},{default:v(()=>[r(o(D),{class:"w-4 h-4"})]),_:2},1032,["onClick"]),r(o(x),{size:"sm",variant:"ghost",onClick:U(h=>R(e),["stop"]),title:"View Details"},{default:v(()=>[r(o(Z),{class:"w-4 h-4"})]),_:2},1032,["onClick"])])])],42,ee))),128))])):m("",!0),p.value&&n.value&&w.value.length===0?(l(),c("div",ce,[s("div",ue,[r(o(z),{class:"w-8 h-8 mx-auto mb-2 opacity-50"}),s("p",null,'No items found for "'+u(n.value)+'"',1),t[3]||(t[3]=s("p",{class:"text-sm mt-1"},"Try a different search term or category",-1))])])):m("",!0),!n.value&&!d.value&&_.recentlyUsed.length>0?(l(),c("div",de,[s("h4",ve,[t[4]||(t[4]=s("span",null,"Recently Used",-1)),r(o(L),{variant:"secondary",class:"text-xs"},{default:v(()=>[k(u(_.recentlyUsed.length),1)]),_:1})]),s("div",me,[(l(!0),c(q,null,I(_.recentlyUsed,e=>(l(),c("div",{key:e.id,class:"flex items-center justify-between p-3 border rounded-lg hover:bg-muted/50 cursor-pointer transition-colors",onClick:f=>$(e)},[s("div",_e,[s("div",pe,[s("span",he,u(e.item_code),1),s("span",xe,u(e.description),1)]),s("div",ye,[r(N,{available:Number(e.stock||0),size:"small"},null,8,["available"]),s("span",ge,"₱"+u((e.cost_per_quantity||0).toFixed(2)),1)])]),r(o(x),{size:"sm",variant:"ghost",onClick:U(f=>S(e),["stop"])},{default:v(()=>[r(o(D),{class:"w-4 h-4"})]),_:2},1032,["onClick"])],8,fe))),128))])])):m("",!0),!n.value&&!d.value&&_.recentlyUsed.length===0?(l(),c("div",ke,[s("div",we,[r(o(z),{class:"w-8 h-8 mx-auto mb-2 opacity-50"}),t[5]||(t[5]=s("p",{class:"text-sm"},"Start typing to search for products",-1)),t[6]||(t[6]=s("p",{class:"text-xs mt-1"},"Use categories to filter results",-1))])])):m("",!0)]))}},Ue=K(be,[["__scopeId","data-v-828360bb"]]);export{Ue as default};
