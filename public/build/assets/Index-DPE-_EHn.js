import{G as me,f as ge,x as F,Q as $,y as H,N as P,l as S,T as ve,r as a,o as f,c as g,w as t,a as e,u as _,a$ as ke,d as b,g as p,t as u,h as m,i as ye,b as o,e as R,F as U}from"./app-DZB5krWT.js";import{u as be}from"./useSearch-BA-540Ma.js";import{u as Se}from"./useAuth-D0qVILHh.js";import{u as Ce}from"./useReferenceDelete-Cl6cgyVS.js";import"./lodash-gd7BEsaJ.js";const Ie={key:0,class:"mb-6"},Te={key:0,class:"bg-green-100 border-l-4 border-green-500 text-green-700 p-4 mb-4",role:"alert"},xe={class:"font-bold"},Be={key:1,class:"mt-4 p-4 bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700"},De=["href"],Fe={class:"space-y-5"},we={class:"flex flex-col space-y-1"},Le={class:"flex flex-col space-y-1"},Ne={class:"text-xs"},Ae=["href"],Pe={__name:"Index",props:{items:{type:Object,required:!0},assignedSupplierCodes:{type:Array,default:()=>[]}},setup(T){const w=me();ge();let v=F($().props.filter||"all");const{search:k}=be("SupplierItems.index"),x=s=>{v.value=s,P.get(route("SupplierItems.index"),{filter:s,search:k.value},{preserveState:!0,replace:!0})};H(v,function(s){P.get(route("SupplierItems.index"),{filter:s,search:k.value},{preserveState:!0,replace:!0})});const{hasAccess:C}=Se(),{deleteModel:L}=Ce(),z=S(()=>route("SupplierItems.export",{search:k.value,filter:v.value})),I=F(!1),B=ve({products_file:null}),O=()=>{y.value=!0,B.post(route("SupplierItems.import"),{onSuccess:()=>{y.value=!1,I.value=!1},onError:s=>{y.value=!1,console.error("Import Error:",s),w.add({severity:"error",summary:"Import Error",detail:s.products_file||"An error occurred while trying to update supplier items. Please make sure that you are using the correct format.",life:5e3})},onFinish:()=>{y.value=!1}})},K=()=>I.value=!0,y=F(!1),X=S(()=>$().props.flash),c=S(()=>X.value.import_summary||null),Y=S(()=>c.value&&c.value.skipped_details_present),j=S(()=>route("SupplierItems.downloadSkippedImportLog"));return H(c,s=>{if(s){let l=`Processed: ${s.processed_count}. `;s.skipped_empty_keys_count>0&&(l+=`Skipped (Empty Keys): ${s.skipped_empty_keys_count}. `),s.skipped_sap_validation_count>0&&(l+=`Skipped (Validation): ${s.skipped_sap_validation_count}. `),s.skipped_unauthorized_count>0&&(l+=`Skipped (Unauthorized): ${s.skipped_unauthorized_count}. `),w.add({severity:s.skipped_details_present?"warn":"success",summary:s.skipped_details_present?"Import with Skips":"Import Successful",detail:l,life:8e3})}},{immediate:!0}),(s,l)=>{const D=a("FilterTabButton"),q=a("FilterTab"),N=a("Input"),G=a("SearchBar"),A=a("Button"),Q=a("TableHeader"),r=a("TH"),V=a("TableHead"),i=a("TD"),M=a("ShowButton"),h=a("EditButton"),E=a("DeleteButton"),J=a("TableBody"),W=a("Table"),Z=a("MobileTableHeading"),d=a("LabelXS"),ee=a("MobileTableRow"),te=a("MobileTableContainer"),le=a("Pagination"),oe=a("TableContainer"),ne=a("DialogTitle"),ue=a("DialogDescription"),ae=a("DialogHeader"),se=a("FormError"),re=a("Label"),ie=a("Loading"),de=a("DialogFooter"),pe=a("DialogContent"),fe=a("Dialog"),_e=a("Layout");return f(),g(_e,{heading:"Supplier Items List",hasButton:!1,buttonName:"Create New Item",handleClick:null,hasExcelDownload:!0,exportRoute:z.value},{default:t(()=>[e(_(ke)),c.value?(f(),b("div",Ie,[c.value.success_message?(f(),b("div",Te,[p("p",xe,u(c.value.success_message),1),p("p",null,"Processed: "+u(c.value.processed_count),1),p("p",null,"Skipped (Empty Keys): "+u(c.value.skipped_empty_keys_count),1),p("p",null,"Skipped (Validation): "+u(c.value.skipped_sap_validation_count),1),p("p",null,"Skipped (Unauthorized): "+u(c.value.skipped_unauthorized_count),1)])):m("",!0),Y.value?(f(),b("div",Be,[l[6]||(l[6]=p("p",null,"Some rows were skipped during the import due to validation errors or unauthorized supplier codes.",-1)),p("a",{href:j.value,class:"font-bold underline cursor-pointer hover:text-yellow-900"}," Click here to download a log file with details ",8,De)])):m("",!0)])):m("",!0),e(q,null,{default:t(()=>[e(D,{label:"All",filter:"all",currentFilter:_(v),onClick:l[0]||(l[0]=n=>x("all"))},null,8,["currentFilter"]),e(D,{label:"Active",filter:"is_active",currentFilter:_(v),onClick:l[1]||(l[1]=n=>x("is_active"))},null,8,["currentFilter"]),e(D,{label:"InActive",filter:"inactive",currentFilter:_(v),onClick:l[2]||(l[2]=n=>x("inactive"))},null,8,["currentFilter"])]),_:1}),e(oe,null,{default:t(()=>[e(Q,null,{default:t(()=>[e(G,null,{default:t(()=>[e(N,{class:"pl-10",modelValue:_(k),"onUpdate:modelValue":l[3]||(l[3]=n=>ye(k)?k.value=n:null),placeholder:"Search..."},null,8,["modelValue"])]),_:1}),e(A,{onClick:K},{default:t(()=>l[7]||(l[7]=[o("Update List")])),_:1})]),_:1}),e(W,null,{default:t(()=>[e(V,null,{default:t(()=>[e(r,null,{default:t(()=>l[8]||(l[8]=[o("Category")])),_:1}),e(r,null,{default:t(()=>l[9]||(l[9]=[o("Category 2")])),_:1}),e(r,null,{default:t(()=>l[10]||(l[10]=[o("Area")])),_:1}),e(r,null,{default:t(()=>l[11]||(l[11]=[o("Brand")])),_:1}),e(r,null,{default:t(()=>l[12]||(l[12]=[o("Classification")])),_:1}),e(r,null,{default:t(()=>l[13]||(l[13]=[o("Item Code")])),_:1}),e(r,null,{default:t(()=>l[14]||(l[14]=[o("Item Name")])),_:1}),e(r,null,{default:t(()=>l[15]||(l[15]=[o("Packaging Config")])),_:1}),e(r,null,{default:t(()=>l[16]||(l[16]=[o("BaseUOM")])),_:1}),e(r,null,{default:t(()=>l[17]||(l[17]=[o("Unit")])),_:1}),e(r,null,{default:t(()=>l[18]||(l[18]=[o("Cost")])),_:1}),e(r,null,{default:t(()=>l[19]||(l[19]=[o("SRP")])),_:1}),e(r,null,{default:t(()=>l[20]||(l[20]=[o("Supplier Code")])),_:1}),e(r,null,{default:t(()=>l[21]||(l[21]=[o("Active")])),_:1}),e(r,null,{default:t(()=>l[22]||(l[22]=[o("Action")])),_:1})]),_:1}),e(J,null,{default:t(()=>[(f(!0),b(U,null,R(T.items.data,n=>(f(),b("tr",{key:n.id},[e(i,null,{default:t(()=>[o(u(n.category),1)]),_:2},1024),e(i,null,{default:t(()=>[o(u(n.category_2),1)]),_:2},1024),e(i,null,{default:t(()=>[o(u(n.area),1)]),_:2},1024),e(i,null,{default:t(()=>[o(u(n.brand),1)]),_:2},1024),e(i,null,{default:t(()=>[o(u(n.classification),1)]),_:2},1024),e(i,null,{default:t(()=>[o(u(n.ItemCode),1)]),_:2},1024),e(i,null,{default:t(()=>[o(u(n.item_name),1)]),_:2},1024),e(i,null,{default:t(()=>[o(u(n.packaging_config),1)]),_:2},1024),e(i,null,{default:t(()=>[o(u(n.base_uom_display),1)]),_:2},1024),e(i,null,{default:t(()=>[o(u(n.uom),1)]),_:2},1024),e(i,null,{default:t(()=>[o(u(n.cost),1)]),_:2},1024),e(i,null,{default:t(()=>[o(u(n.srp),1)]),_:2},1024),e(i,null,{default:t(()=>[o(u(n.SupplierCode),1)]),_:2},1024),e(i,null,{default:t(()=>[o(u(Number(n.is_active)?"Yes":"No"),1)]),_:2},1024),e(i,{class:"flex items-center gap-2"},{default:t(()=>[_(C)("view item")?(f(),g(M,{key:0,isLink:!0,href:s.route("SupplierItems.show",n.id)},null,8,["href"])):m("",!0),_(C)("edit items")?(f(),g(h,{key:1,isLink:!0,href:s.route("SupplierItems.edit",n.id)},null,8,["href"])):m("",!0),e(E,{onClick:ce=>_(L)(s.route("SupplierItems.destroy",n.id),"Supplier Item")},null,8,["onClick"])]),_:2},1024)]))),128))]),_:1})]),_:1}),e(te,null,{default:t(()=>[(f(!0),b(U,null,R(T.items.data,n=>(f(),g(ee,{key:n.id},{default:t(()=>[e(Z,{title:`${n.item_name} (${n.ItemCode})`},{default:t(()=>[_(C)("view item")?(f(),g(M,{key:0,isLink:!0,href:s.route("SupplierItems.show",n.id)},null,8,["href"])):m("",!0),_(C)("edit items")?(f(),g(h,{key:1,isLink:!0,href:s.route("SupplierItems.edit",n.id)},null,8,["href"])):m("",!0),e(E,{onClick:ce=>_(L)(s.route("SupplierItems.destroy",n.id),"Supplier Item")},null,8,["onClick"])]),_:2},1032,["title"]),e(d,null,{default:t(()=>[o("Item Code: "+u(n.ItemCode),1)]),_:2},1024),e(d,null,{default:t(()=>[o("Item Name: "+u(n.item_name),1)]),_:2},1024),e(d,null,{default:t(()=>[o("Supplier Code: "+u(n.SupplierCode),1)]),_:2},1024),e(d,null,{default:t(()=>[o("Category: "+u(n.category),1)]),_:2},1024),e(d,null,{default:t(()=>[o("Category 2: "+u(n.category_2),1)]),_:2},1024),e(d,null,{default:t(()=>[o("Area: "+u(n.area),1)]),_:2},1024),e(d,null,{default:t(()=>[o("Brand: "+u(n.brand),1)]),_:2},1024),e(d,null,{default:t(()=>[o("Classification: "+u(n.classification),1)]),_:2},1024),e(d,null,{default:t(()=>[o("Packaging Config: "+u(n.packaging_config),1)]),_:2},1024),e(d,null,{default:t(()=>[o("BaseUOM: "+u(n.base_uom_display),1)]),_:2},1024),e(d,null,{default:t(()=>[o("UOM: "+u(n.uom),1)]),_:2},1024),e(d,null,{default:t(()=>[o("Cost: "+u(n.cost),1)]),_:2},1024),e(d,null,{default:t(()=>[o("SRP: "+u(n.srp),1)]),_:2},1024),e(d,null,{default:t(()=>[o("Active: "+u(Number(n.is_active)?"Yes":"No"),1)]),_:2},1024)]),_:2},1024))),128))]),_:1}),e(le,{data:T.items},null,8,["data"])]),_:1}),e(fe,{open:I.value,"onUpdate:open":l[5]||(l[5]=n=>I.value=n)},{default:t(()=>[e(pe,{class:"sm:max-w-[600px]"},{default:t(()=>[e(ae,null,{default:t(()=>[e(ne,null,{default:t(()=>l[23]||(l[23]=[o("Import Supplier Items")])),_:1}),e(ue,null,{default:t(()=>l[24]||(l[24]=[o(" Import the Excel file of the supplier items. ")])),_:1})]),_:1}),p("div",Fe,[p("div",we,[e(N,{type:"file",onInput:l[4]||(l[4]=n=>_(B).products_file=n.target.files[0])}),e(se,null,{default:t(()=>[o(u(_(B).errors.products_file),1)]),_:1})]),p("div",Le,[e(re,{class:"text-xs"},{default:t(()=>l[25]||(l[25]=[o("Accepted Supplier Items File Format")])),_:1}),p("ul",null,[p("li",Ne,[p("a",{class:"text-blue-500 underline",href:s.route("excel.SupplierItems-template")+"?v="+new Date().getTime()},"Click to download template",8,Ae)])])])]),e(de,null,{default:t(()=>[e(A,{disabled:y.value,onClick:O,type:"submit",class:"gap-2"},{default:t(()=>[l[26]||(l[26]=o(" Proceed ")),p("span",null,[y.value?(f(),g(ie,{key:0})):m("",!0)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1},8,["exportRoute"])}}};export{Pe as default};
