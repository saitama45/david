import{G as q,T as D,l as P,r as a,o as f,c as G,w as d,a as n,b as _,u,t as h,g as i,d as g,e as V,F as I,bM as M}from"./app-Bp7xdNcv.js";import{s as B}from"./index-Bo396g4V.js";const X={class:"flex justify-between items-center mb-4"},z={class:"flex items-center gap-2"},H={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-5"},J={class:"flex items-center justify-between"},K={class:"flex items-center gap-2"},Q=["for"],W={class:"flex items-center justify-between mt-2"},Y={class:"flex items-center gap-2"},Z=["for"],L=["for"],ee={class:"flex justify-end gap-3"},le={__name:"Edit",props:{permissions:{type:Object,required:!0},role:{type:Object,required:!0}},setup(b){const E=q(),r=b,A=r.role.permissions.map(s=>s.id),t=D({name:r.role.name,selectedPermissions:A}),k=P(()=>{const s=[];for(const e in r.permissions)for(const l in r.permissions[e])r.permissions[e][l].forEach(o=>{s.push(o.id)});return s}),U=P({get(){return k.value.length===0?!1:k.value.every(s=>t.selectedPermissions.includes(s))},set(s){s?t.selectedPermissions=[...k.value]:t.selectedPermissions=[]}}),S=s=>P({get(){const e=[];for(const l in r.permissions[s])r.permissions[s][l].forEach(o=>{e.push(o.id)});return e.length===0?!1:e.every(l=>t.selectedPermissions.includes(l))},set(e){const l=[];for(const o in r.permissions[s])r.permissions[s][o].forEach(m=>{l.push(m.id)});e?t.selectedPermissions=[...new Set([...t.selectedPermissions,...l])]:t.selectedPermissions=t.selectedPermissions.filter(o=>!l.includes(o))}}),j=(s,e)=>P({get(){const l=r.permissions[s][e].map(o=>o.id);return l.length===0?!1:l.every(o=>t.selectedPermissions.includes(o))},set(l){const o=r.permissions[s][e].map(m=>m.id);l?t.selectedPermissions=[...new Set([...t.selectedPermissions,...o])]:t.selectedPermissions=t.selectedPermissions.filter(m=>!o.includes(m))}}),F=()=>{t.put(route("roles.update",r.role.id),{onSuccess:()=>{E.add({severity:"success",summary:"Success",detail:"Role Updated Successfully.",life:3e3})},onError:s=>{console.error("Role Update Error Details:",s);let e="An error occurred while trying to update the role.";s&&Object.keys(s).length>0&&(e=Object.values(s).join(", ")),E.add({severity:"error",summary:"Error",detail:e,life:5e3})}})};return(s,e)=>{const l=a("LabelXS"),o=a("Input"),m=a("FormError"),$=a("InputContainer"),w=a("SpanBold"),N=a("BackButton"),O=a("Button"),R=a("Card"),C=a("Layout");return f(),G(C,{heading:"Edit Role"},{default:d(()=>[n(R,{class:"p-5 space-y-5"},{default:d(()=>[n($,null,{default:d(()=>[n(l,null,{default:d(()=>e[3]||(e[3]=[_("Name")])),_:1}),n(o,{modelValue:u(t).name,"onUpdate:modelValue":e[0]||(e[0]=v=>u(t).name=v)},null,8,["modelValue"]),n(m,null,{default:d(()=>[_(h(u(t).errors.name),1)]),_:1})]),_:1}),n($,null,{default:d(()=>[i("div",X,[n(l,null,{default:d(()=>e[4]||(e[4]=[_("Permissions")])),_:1}),i("div",z,[n(u(B),{inputId:"global-check-all",modelValue:U.value,"onUpdate:modelValue":e[1]||(e[1]=v=>U.value=v)},null,8,["modelValue"]),e[5]||(e[5]=i("label",{for:"global-check-all",class:"text-xs text-gray-700 font-bold"},"Check All (Globally)",-1))])]),i("div",H,[(f(!0),g(I,null,V(b.permissions,(v,c)=>(f(),g("div",{key:c,class:"flex flex-col gap-3"},[i("div",J,[n(w,{class:"text-xs text-blue-700"},{default:d(()=>[_(h(c.toUpperCase().replace(/_/g," ")),1)]),_:2},1024),i("div",K,[n(u(B),{inputId:`group-check-all-${c}`,modelValue:S(c).value,"onUpdate:modelValue":y=>S(c).value=y},null,8,["inputId","modelValue","onUpdate:modelValue"]),i("label",{for:`group-check-all-${c}`,class:"text-xs text-gray-700"},"Check All",8,Q)])]),(f(!0),g(I,null,V(v,(y,x)=>(f(),g("div",{key:x,class:"flex flex-col gap-2 pl-2 border-l border-gray-200"},[i("div",W,[n(w,{class:"text-xs text-gray-800"},{default:d(()=>[_(h(x),1)]),_:2},1024),i("div",Y,[n(u(B),{inputId:`subcategory-check-all-${c}-${x}`,modelValue:j(c,x).value,"onUpdate:modelValue":p=>j(c,x).value=p},null,8,["inputId","modelValue","onUpdate:modelValue"]),i("label",{for:`subcategory-check-all-${c}-${x}`,class:"text-xs text-gray-700"},"Check All",8,Z)])]),(f(!0),g(I,null,V(y,p=>(f(),g("div",{class:"flex items-center gap-3",key:p.id},[n(u(M),{inputId:`permission-${p.id}`,modelValue:u(t).selectedPermissions,"onUpdate:modelValue":e[2]||(e[2]=T=>u(t).selectedPermissions=T),value:p.id,name:"permissions[]"},null,8,["inputId","modelValue","value"]),i("label",{for:`permission-${p.id}`,class:"text-xs text-gray-600"},h(p.name),9,L)]))),128))]))),128))]))),128))]),n(m,null,{default:d(()=>[_(h(u(t).errors.selectedPermissions),1)]),_:1})]),_:1}),i("div",ee,[n(N),n(O,{onClick:F},{default:d(()=>e[6]||(e[6]=[_("Update")])),_:1})])]),_:1})]),_:1})}}};export{le as default};
